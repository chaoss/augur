{"version":3,"sources":["app/GHData.js","app/GHDataAPI.js","app/GHDataStats.js","app/components/BaseRepoActivityCard.vue","app/components/BaseRepoEcosystemCard.vue","app/components/ComparedRepoActivityCard.vue","app/components/GHDataApp.vue","app/components/GHDataCards.vue","app/components/GHDataHeader.vue","app/components/SidebarControls.vue","app/components/charts/DependencyOverview.vue","app/components/charts/EmptyChart.vue","app/components/charts/LineChart.vue","app/include/kube/kube.js","app/include/metricsgraphics.js","app/include/svgsaver.js"],"names":["GHData","queryString","require","window","jQuery","Vue","Vuex","GHDataAPI","default","GHDataRepos","GHDataStats","$","GHDataApp","use","ghdata","Store","state","baseRepo","comparedRepos","trailingAverage","startDate","Date","endDate","compare","byDate","mutations","setBaseRepo","payload","repo","Repo","url","toString","keepCompared","title","owner","name","history","pushState","addComparedRepo","push","location","search","setDates","parseInt","setCompare","reset","store","$mount","parsed","parse","arrayFormat","$store","commit","replace","comparedTo","forEach","hostURL","version","_version","_host","host","__cache","repoName","splitURL","split","length","Endpoint","endpoint","self","params","callback","btoa","created_at","now","Promise","resolve","reject","JSON","data","get","then","stringify","Timeseries","func","relativeTo","baselineRepo","commits","forks","issues","pulls","stars","tags","downloads","uniqueCommitters","pullsAcceptanceRate","issuesResponseTime","contributors","contributions","committerLocations","communityAge","linkingWebsites","busFactor","dependents","dependencies","dependencyStats","earliest","latest","Array","isArray","map","datum","convertDates","d","date","filter","key","convertKey","EARLIEST","value","ary","reduce","a","e","mean","flat","averageArray","distances","Math","sqrt","stddev","standardDeviation","variance","windowSizeInDays","rolling","averageWindow","i","lastFound","after","before","setDate","getDate","iter","average","slice","shift","baseline","baseData","compareData","config","undefined","period","base","rollingAverage","Object","keys","smaller","larger","result","toPush","x","console","log","stats","describe","newObj","zscore","from","arguments","Error","fn","jquery","Function","prototype","inherits","parent","F","f","prop","super","Kube","element","options","$element","opts","extend","defaults","namespace","$target","target","getInstance","hasTarget","type","args","call","splice","_fireCallback","_data","callbacks","isFunction","apply","events","eventNamespace","len","handler","Plugin","create","classname","pluginname","toLowerCase","method","val","each","$this","methodVal","error","autoload","arr","s","trim","join","autoloadQueue","startAutoload","MutationObserver","observer","mutation","newNodes","addedNodes","nodeType","startAutoloadOnce","observe","document","subtree","childList","$nodes","not","$el","indexOf","attr","watch","on","Animation","effect","completeCallback","prefixes","queue","start","isSlideEffect","setElementHeight","addToQueue","clean","animate","height","removeElementHeight","css","isHideableEffect","effects","inArray","isToggleEffect","storeHideClasses","hasClass","revertHideClasses","addClass","removeData","removeHideClass","removeClass","makeSimpleEffects","_callback","complete","proxy","makeComplete","make","event","one","off","animation","Detect","isMobile","test","navigator","userAgent","isDesktop","isMobileScreen","width","isTabletScreen","isDesktopScreen","FormData","app","set","formdata","appendForms","appendFields","$fields","str","append","$forms","formsData","serializeArray","serialize","Response","obj","item","parseItem","html","stripslashes","top","href","notify","Utils","disableBodyScroll","$body","windowWidth","innerWidth","documentElementRect","documentElement","getBoundingClientRect","right","abs","left","isOverflowing","body","clientWidth","scrollbarWidth","measureScrollbar","scrollDiv","createElement","className","offsetWidth","removeChild","enableBodyScroll","Message","closeSelector","closeEvent","animationOpen","animationClose","$close","find","close","stop","open","preventDefault","isOpened","onOpened","onClosed","Sticky","offset","offsetTop","getOffsetTop","load","scroll","isFix","fixed","unfixed","scrollTop","Toggleme","toggleEvent","text","toggle","revertText","storeText","setTimeout","replaceText","Offcanvas","direction","clickOutside","utils","detect","buildTargetWidth","buildAnimationDirection","getCloseLink","closeAll","pushBody","$elms","isTag","tagName","closest","pullBody","handleKeyboard","which","properties","Collapse","active","toggleClass","boxClass","hashes","currentHash","currentItem","$items","getItems","loadItems","$boxes","getBoxes","setActiveItem","el","getItem","hash","getItemBy","addActive","$box","$caret","$parent","removeActive","openAll","num","eq","Dropdown","caretUp","buildClose","buildCaret","buildMobileAnimation","disableEvents","getCaret","buildCaretPosition","innerHeight","toggleCaretOpen","toggleCaretClose","setPosition","shouldNotBeClosed","enableEvents","isNavigationFixed","getPlacement","getOffset","position","getPosition","coords","placement","leftFix","outerHeight","Tabs","equals","live","buildLiveTabs","tabsCollection","hashesCollection","$tabs","getTabs","getLocationHash","setItemHeight","toArray","collectItem","$tab","$layers","$liveTabsList","buildLiveItem","tab","$li","$a","index","getLiveItemId","getLiveItemTitle","first","next","fetchElement","prev","pushStateOpen","pushStateClose","isHash","minHeight","getItemMaxHeight","max","h","modalcurrent","modalwindow","show","modal","Modal","header","maxHeight","overlay","buildModal","$modal","$header","buildOverlay","$overlay","prepend","buildHeader","buildContent","findActions","resize","handleEnter","getData","ajax","getTime","cache","success","buildWidth","bottom","percent","match","buildPosition","windowHeight","buildHeight","padding","margin","modalHeight","handleEscape","setHeader","setContent","content","setWidth","getModal","getBody","getHeader","root","factory","define","amd","exports","module","MG","d3","global","convert","accessor","time_format","parse_time","timeParse","number","Number","utc","specifier","utcFormat","timeFormat","mg_jquery_exists","mg_get_rollover_time_format","fmt","processed","x_time_frame","utc_time","mg_data_in_plot_bounds","x_accessor","min_x","max_x","y_accessor","min_y","max_y","is_array","thing","is_function","is_empty_array","is_object","is_array_of_arrays","all_elements","sum","is_array_of_objects","is_array_of_objects_or_empty","pluck","count_array_elements","b","mg_get_bottom","mg_get_plot_bottom","buffer","mg_get_top","mg_get_plot_top","mg_get_left","mg_get_plot_left","mg_get_right","mg_get_plot_right","mg_exit_and_remove","elem","exit","remove","mg_selectAll_and_remove","svg","cl","selectAll","mg_add_g","classed","mg_remove_element","select","mg_make_rug","rug_class","mg_get_svg_child_of","all_data","mg_flatten_array","rug","enter","mg_add_color_accessor_to_rug","rug_mono_class","color_accessor","scalefns","colorf","mg_rotate_labels","labels","rotation_degree","dy","transform","mg_elements_are_overlapping","node","mg_is_horizontally_overlapping","mg_prevent_horizontal_overlap","newY","mg_prevent_vertical_overlap","sort","reverse","overlap_amount","label_i","label_j","j","mg_is_vertically_overlapping","sibling","element_bbox","sibling_bbox","mg_is_horiz_overlap","mg_infer_type","ns","testPoint","selector_or_node","flat_data","concat","mg_next_id","_next_elem_id","mg_target_ref","mg_normalize","HTMLElement","target_ref","getAttribute","setAttribute","warn","string","get_pixel_dimension","dimension","style","get_width","get_height","isNumeric","n","isNaN","parseFloat","isFinite","iterator","context","breaker","k","merge_with_defaults","source","number_of_values","values","has_values_below","has_too_many_zeros","zero_count","mg_is_date","mg_is_object","mg_is_array","mg_is_function","clone","copy","setTime","hasOwnProperty","arr_diff","seen","diff","warn_deprecation","message","untilVersion","trace","truncate_text","textObj","textString","bbox","textContent","getBBox","wrap_text","token","tspanAttrs","words","word","line","lineNumber","lineHeight","y","tspan","pop","getComputedTextLength","register","chartType","descriptor","charts","_hooks","add_hook","hooks","already_registered","hook","call_hook","constructor","globals","deprecations","rollover_callback","replacement","rollout_callback","x_rollover_format","y_rollover_format","show_years","xax_start_at_min","interpolate_tension","link","data_graphic","missing_is_zero","missing_is_hidden","missing_is_hidden_accessor","legend","legend_target","animate_on_load","title_y_position","center_title_full_width","full_width","full_height","small_height_threshold","small_width_threshold","xax_count","xax_tick_length","axes_not_compact","yax_count","yax_tick_length","x_extended_ticks","y_extended_ticks","y_scale_type","min_y_from_data","point_size","xax_units","x_label","x_sort","x_axis","y_axis","x_axis_position","y_axis_position","x_axis_type","y_axis_type","ygroup_accessor","xgroup_accessor","y_padding_percentage","y_outer_padding_percentage","ygroup_padding_percentage","ygroup_outer_padding_percentage","x_padding_percentage","x_outer_padding_percentage","xgroup_padding_percentage","xgroup_outer_padding_percentage","y_categorical_show_guides","x_categorical_show_guide","rotate_x_labels","rotate_y_labels","y_label","yax_units","yax_units_append","x_rug","y_rug","mouseover_align","x_mouseover","y_mouseover","transition_on_update","mouseover","click","show_rollover_text","show_confidence_band","xax_format","area","chart_type","decimals","format","inflator","linked","linked_format","list","baselines","markers","scales","european_clock","show_year_markers","show_secondary_x_label","interpolate","curveCatmullRom","alpha","custom_line_color_map","colors","max_data_size","aggregate_rollover","show_tooltips","selected_chart","deprecation","warned","Tooltip","enabled","timeout","hoverState","inState","init","VERSION","TRANSITION_DURATION","DEFAULTS","selector","template","trigger","delay","container","viewport","getOptions","$viewport","hover","focus","triggers","eventIn","eventOut","leave","_options","fixTitle","getDefaults","hide","getDelegateOptions","currentTarget","Event","tip","clearTimeout","isInStateTrue","hasContent","inDom","contains","ownerDocument","isDefaultPrevented","that","$tip","tipId","getUID","autoToken","autoPlace","detach","display","appendTo","insertAfter","pos","actualWidth","actualHeight","offsetHeight","orgPlacement","viewportDim","calculatedOffset","getCalculatedOffset","applyPlacement","prevHoverState","support","transition","emulateTransitionEnd","marginTop","marginLeft","setOffset","using","props","round","delta","getViewportAdjustedDelta","isVertical","arrowDelta","arrowOffsetPosition","replaceArrow","arrow","getTitle","removeAttr","$e","isBody","elRect","elOffset","outerDims","viewportPadding","viewportDimensions","topEdgeOffset","bottomEdgeOffset","leftEdgeOffset","rightEdgeOffset","o","prefix","random","getElementById","$arrow","enable","disable","toggleEnabled","destroy","option","old","tooltip","Constructor","noConflict","Popover","getContent","children","end","popover","chart_title","chartTitle","insert","description","$chartTitle","mg_add_scale_function","scalefcn_name","scale","inflation","di","mg_position","mg_cat_position","MGScale","scaleArgs","use_inflator","zero_bottom","scaleType","_namespace","namespace_accessor_name","scale_name","toUpperCase","scalefn_name","scaleName","inflateDomain","tf","zeroBottom","numericalDomainFromData","other_flat_data_arrays","illustrative_data","is_time_series","mg_min_max_numerical","time_scale","scaleUtc","scaleTime","scaleLog","scaleLinear","domain","categoricalDomain","scaleOrdinal","categoricalDomainFromData","categoricalVariables","scaleBand","numericalRange","range","categoricalRangeBands","halfway","paddingPercentage","outerPaddingPercentage","paddingInner","paddingOuter","bandwidth","categoricalRange","categoricalColorRange","schemeCategory20","schemeCategory10","clamp","yn","scale_factory","additional_data_arrays","dp","extents","extent","min_val","max_val","mg_force_xax_count_to_be_two","mg_categorical_group_color_scale","mg_add_color_categorical_scale","color","mg_get_categorical_domain","mg_get_color_domain","color_domain","color_type","mg_get_color_range","color_range","processScaleTicks","axis","scale_ticks","ticks","log10","LN10","number_of_ticks","data_is_int","rugPlacement","axisArgs","coordinates","x1","x2","rug_buffer_size","y1","y2","rimPlacement","tick_length","toFixed","labelPlacement","tickLength","dx","textAnchor","mg_compute_yax_format","mg_default_xax_format","selectXaxFormat","c","mg_default_bar_xax_format","secondaryLabels","g","time_series","mg_get_yformat_and_secondary_time_function","addSecondaryLabelElements","timeframe","yformat","secondary","time_frame","secondary_function","years","first_tick","X","yg","yearMarkerLine","yearMarkerText","textFcn","xAxisTextElement","addNumericalLabels","_d","addTickLines","ticksClass","extendedTicksClass","extendedTicks","initializeAxisRim","rim","initializeRug","rug_positions","categoricalLabelPlacement","group","groupScale","cat","categoricalLabels","nsClass","groupAccessor","group_g","groups","String","rotateLabels","categoricalGuides","scalef","groupf","alreadyPlotted","grs","last","x11","x21","y11","y21","x12","x22","y12","y22","zeroLine","mgDrawAxis","categorical","numerical","axisName","axisClass","label","show_bar_zero","mg_bar_add_zero_line","axisFactory","t","draw","axis_factory","yf","mg_change_y_extents_for_bars","my","min","trio","baseline_accessor","predictor_accessor","yax_format","pf","d_","r","Y","categorical_groups","YGROUP","set_min_max_y","buff","mg_y_domain_range","mg_define_y_scales","Y_axis","mg_add_y_label","mg_add_y_axis_rim","y_ticks","y1scale","y2scale","mg_add_y_axis_tick_lines","mg_add_y_axis_tick_labels","mg_process_scale_ticks","mg_add_categorical_labels","mg_add_group_label","mg_add_graphic_labels","mg_draw_group_lines","ygroup_height","mg_y_categorical_show_guides","ygroupf","y_axis_categorical","xf","mg_add_processed_object","mg_select_xax_format","mg_add_x_ticks","mg_add_x_tick_labels","mg_add_x_label","x_axis_categorical","additional_buffer","mg_add_categorical_scale","categorical_variables","mg_add_x_axis_categorical_labels","bar_outer_padding_percentage","truncate_x_labels","idx","mg_point_add_color_scale","mg_point_add_size_scale","min_size","max_size","size_domain","size_range","size_accessor","mg_get_size_domain","mg_get_size_range","size","x_label_nudge_x","mg_get_time_frame","mg_milisec_diff","mg_sec_diff","mg_day_diff","mg_four_days","mg_many_days","mg_many_months","mg_years","mg_get_time_format","main_time_format","mg_process_time_format","main_x_time_format","original_data","flattened","test_point_x","original_x_accessor","is_float","mg_add_x_axis_rim","mg_add_x_axis_tick_lines","x_ticks","last_i","mg_add_primary_x_axis_label","mg_add_secondary_x_axis_label","mg_add_secondary_x_axis_elements","timeDays","timeYears","mg_add_year_marker_line","mg_add_year_marker_text","mg_min_max_x_for_nonbars","mx","extent_x","mg_min_max_x_for_bars","mg_min_max_x_for_dates","yesterday","tomorrow","mg_min_max_x_for_numbers","mg_min_max_x_for_strings","mg_sort_through_data_type_and_set_x_min_max_accordingly","mg_merge_args_with_defaults","mg_is_time_series","first_elem","mg_init_compute_width","svg_width","mg_categorical_calculate_height","mg_init_compute_height","svg_height","mg_remove_svg_if_chart_type_has_changed","empty","mg_add_svg_if_it_doesnt_exist","mg_add_clip_path_for_plot_area","mg_adjust_width_and_height_if_changed","mg_set_viewbox_for_scaling","mg_remove_missing_classes_and_text","mg_remove_outdated_lines","nodes","array_full_series","lines_to_remove","num_of_new","num_of_existing","mg_raise_container_error","categoricalInitialization","mg_categorical_count_number_of_groups","mg_categorical_count_number_of_lanes","mg_categorical_calculate_group_length","mg_categorical_calculate_bar_thickness","accessor_string","total_bars","group_bars","bars_per_group","groupHeight","gh","step","bar_thickness","groupContribution","marginContribution","mg_barchart_extrapolate_group_and_thickness_from_height","mg_return_label","mg_remove_existing_markers","mg_in_range","mg_x_position","mg_x_position_fixed","_mg_x_pos","mg_y_position_fixed","_mg_y_pos","mg_place_annotations","checker","class_name","line_fcn","text_fcn","mg_place_markers","mg_place_marker_lines","mg_place_marker_text","mg_place_baselines","mg_place_baseline_lines","mg_place_baseline_text","gm","x_pos_fixed","lineclass","textclass","gb","y_pos","mg_clear_mouseover_container","mg_setup_mouseover_container","text_anchor","mouseover_x","active_datapoint","active_datapoint_y_nudge","y_position","yPos","mg_mouseover_tspan","bold","font_size","pts","mg_reset_text_container","textContainer","mg_mouseover_row","row_number","rargs","rrr","mg_mouseover_text","text_container","mouseover_row","MG_WindowResizeTracker","targets","Observer","WebKitMutationObserver","window_listener","parentNode","aspect","newWidth","remove_target","removeEventListener","add_target","addEventListener","targetNode","some","removedNodes","disconnect","mg_window_resize_tracker","mg_window_listeners","mg_if_aspect_ratio_resize_svg","dropdown","backdrop","is","getParent","isActive","clearMenus","relatedTarget","keydown","stopPropagation","desc","button_layout","feature_set","public_name","sorters","manual","manual_map","manual_callback","_strip_punctuation","punctuationless","finalString","manual_button","feature","button","features","feat","mapDtoF","dropdownLiAClick","manual_feature","mg_line_color_text","line_id","mg_line_graph_generators","plot","mg_add_line_generator","mg_add_area_generator","mg_add_flat_line_generator","mg_add_confidence_band_generator","existing_band","confidence_area","defined","y0","l","u","curve","flat_line","data_median","mg_add_confidence_band","which_line","confidenceBand","duration","mg_add_area","areas","display_area","appendChild","update_transition_duration","mg_default_color_for_path","this_path","mg_color_line","mg_add_line_element","median","mg_add_line","existing_line","lineTransition","attrTween","path_tween","mg_add_legend_element","this_legend","legend_text","anchor_point","anchor_orientation","legend_group","mg_plot_legend_if_legend_target","mg_add_legend_group","mg_remove_existing_line_rollover_elements","mg_add_rollover_circle","circle","mg_set_unique_line_id_for_each_series","mg_nest_data_for_voronoi","merge","mg_line_class_string","class_string","v","formatter","id","mg_add_voronoi_rollover","rollover_on","rollover_off","rollover_move","voronoi","polygons","mg_configure_voronoi_rollover","nest_data_for_aggregate_rollover","data_nested","nest","entries","entry","mg_add_aggregate_rollover","line_classes","lc","mg_line_class","mg_line_color_class","mg_rollover_id_class","mg_rollover_format_id","mg_configure_aggregate_rollover","mg_configure_singleton_rollover","mg_add_single_line_rollover","mg_is_singleton","rect","rect_first","__data__","mg_is_standard_multiline","mg_is_aggregated_rollover","mg_draw_all_line_elements","mg_remove_dangling_bands","this_data","mg_line_main_plot","use_data_y_min","continueWithDefault","mg_line_rollover_setup","graph","rolloverOn","rolloverOff","rolloverMove","mg_update_rollover_circle","mg_update_aggregate_rollover_circle","mg_update_generic_rollover_circle","mg_trigger_linked_mouseovers","mg_trigger_linked_mouseouts","datums","mg_remove_active_data_points_for_aggregate_rollover","mg_remove_active_data_points_for_generic_rollover","mg_remove_active_text","lineChart","internal_error","raw_data_transformation","process_line","mainPlot","rollover","windowListeners","row","mg_format_x_aggregate_mouseover","mg_format_x_mouseover","mg_format_y_mouseover","mouseout","mousemove","histogram","process_histogram","bar","bar_margin","format_rollover_number","mo","binned","bins","processed_x_accessor","processed_y_accessor","processed_dx_accessor","point_mouseover","mg_color_point_mouseover","mg_filter_out_plot_bounds","new_data","pointChart","process_point","xMaker","yMaker","xgroup_height","XGROUP","xgroupf","xoutf","youtf","colorScale","least_squares","add_ls","sizef","paths","active_point_size_increase","update","x_categorical_show_guides","ls","lowess","label_accessor","scaffold","mg_targeted_legend","div","orientation","outer_span","COLOR","legend_on_graph","lineCount","sub_container","barChart","ycolor_accessor","xcolor_accessor","barplot","fresh_render","bars","predictor_bars","pp","pp0","baseline_marks","perform_load_animation","should_transition","transition_duration","appropriate_size","length_type","width_type","length_coord","width_coord","length_scalefn","width_scalefn","length_scale","width_scale","length_accessor","width_accessor","length_coord_map","width_coord_map","length_map","width_map","reference_length_map","reference_length_coord_fn","reference_accessor","w","reference_data","reference_bars","reference_thickness","comparison_accessor","comparison_thickness","comparison_data","comparison_marks","comparison_width","rollover_x","rollover_anchor","rollover_align","is_vertical","data_accessor","label_units","rgb","darker","mg_format_data_for_mouseover","secondary_label_accessor","predictor_proportion","truncate_y_labels","data_table","standard_col","font_weight","columns","formatting_options","_format_element","fo","_add_column","_args","arg_type","standard_column","bullet","sparkline","table","colgroup","thead","tbody","this_column","this_title","tr","th","td_accessor","td_type","td_value","th_text","td_text","td","col","this_col","value_formatter","this_format","currency","secondary_accessor","mg_missing_add_text","missing_text","mg_missing_x_scale","mg_missing_y_scale","mg_make_fake_data","mg_add_missing_background_rect","mg_missing_add_line","mg_missing_add_area","mg_remove_all_children","mg_missing_remove_legend","missingData","show_missing_background","x_scale_type","single_object","array_of_objects","array_of_arrays","nested_array_of_arrays","nested_array_of_objects","mg_process_multiple_x_accessors","mg_process_multiple_y_accessors","mg_process_multiple_accessors","which_accessor","ya","series","processed_data","start_date","upto","setHours","existing_o","our_data","extracted_data","hist","thresholds","x0","this_pt","next_pt","original_y_accessor","process_categorical_variables","pd","bar_orientation","ls_line","fit","add_lowess","lowess_line","lowess_robust","inc","_l","yhat","_calculate_lowess_fit","x_proto","y_proto","zip","yi","q","quantile","ri","_bisquare_weight","p","x_","y_","xi","_x","_y","_xy","_xx","xhat","numerator","denominator","beta","_pow_weight","pow","_tricube_weight","_neighborhood_width","xis","_manhattan","_weighted_means","wxy","wsum","wxyi","xbar","ybar","_weighted_beta","denom","_weighted_least_squares","beta_i","_wm","residuals","floor","sorted_x","x_max","x_min","xy","smallest","largest","xi_neighbors","x_i","x0_i","delta_i","xyi","_output","fmt_string","time_rollover_format","fd","number_rollover_format","mg_format_y_rollover","formatted_y","mg_format_x_rollover","formatted_x","mouseover_fcn","check_time","formatted_data","time_fmt","mg_format_number_mouseover","d1","precision","path0","path1","cloneNode","n0","getTotalLength","n1","dt","points","p0","getPointAtLength","p1","render_markup_for_server","virtual_window","virtual_d3","original_d3","original_window","original_document","targetFn","render_markup_for_client","render_markup","init_virtual_window","jsdom","force","doc","QuerySelector","defaultView","defineProperty","_createClass","defineProperties","enumerable","configurable","writable","protoProps","staticProps","_interopRequireDefault","__esModule","_classCallCheck","instance","TypeError","_computedStyles","_computedStyles2","_fileSaver","_fileSaver2","svgStyles","svgAttrs","inheritableAttrs","isDefined","isUndefined","isObject","isNode","Node","nodeName","cleanAttrs","attrs","styles","attributes","specified","removeAttribute","cleanStyle","tgt","parentStyles","removeProperty","domWalk","src","down","up","childNodes","cloneSvg","clonedSvg","DownloadAttributeSupport","MouseEvent","saveUri","uri","dl","dispatchEvent","createCanvas","cb","canvas","getContext","image","Image","onload","drawImage","savePng","toBlob","blob","saveAs","toDataURL","isIE11","MSInputMethodContext","documentMode","SvgSaver","getSvg","querySelector","getFilename","filename","ext","encodeURI","_ref","cloneSVG","getHTML","outerHTML","setAttributeNS","XMLSerializer","serializeToString","getBlob","Blob","getUri","encodeURIComponent","unescape","asSvg","getPngUri","asPng"],"mappings":"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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3DA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3BA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzDA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAhEA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3CA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA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","file":"public/app.js","sourcesContent":["const queryString = require('query-string')\n\nexport default function GHData () {\n  window.jQuery       = require('jquery')\n  window.Vue          = require('vue')\n  window.Vuex         = require('vuex')\n  let GHDataAPI       = require('GHDataAPI').default\n  window.GHDataAPI    = new GHDataAPI()\n  window.GHDataRepos  = {}\n  window.GHDataStats  = require('GHDataStats').default\n  window.$            = window.jQuery\n\n  let GHDataApp = require('./components/GHDataApp')\n\n  Vue.use(Vuex)\n\n  window.ghdata = new Vuex.Store({\n    state: {\n      baseRepo: null,\n      comparedRepos: [],\n      trailingAverage: 180,\n      startDate: new Date(\"1 January 2005\"),\n      endDate: new Date(),\n      compare: \"each\",\n      byDate: false,\n    },\n    mutations: {\n      setBaseRepo (state, payload)  {\n        let repo = window.GHDataAPI.Repo(payload.url)\n        if (!window.GHDataRepos[repo.toString()]) {\n          window.GHDataRepos[repo.toString()] = repo\n        }\n        state.baseRepo = repo.toString()\n        if (!payload.keepCompared) {\n          state.comparedRepos = []\n        }\n        let title = repo.owner + '/' + repo.name + '- GHData' \n        let queryString = '?repo=' + repo.owner + '+' + repo.name\n        window.history.pushState(null, title, queryString)\n      },\n      addComparedRepo (state, payload) {\n        let repo = window.GHDataAPI.Repo(payload.url)\n        if (!window.GHDataRepos[repo.toString()]) {\n          window.GHDataRepos[repo.toString()] = repo\n        }\n        state.comparedRepos.push(repo.toString())\n        let title = 'GHData' \n        let queryString = window.location.search + '&comparedTo[]=' + repo.owner + '+' + repo.name\n        window.history.pushState(null, title, queryString)\n      },\n      setDates (state, payload) {\n        if (payload.startDate) {\n          state.startDate = new Date(payload.startDate)\n        }\n        if (payload.endDate) {\n          state.endDate = new Date(payload.endDate)\n        }\n        if (payload.trailingAverage) {\n          state.trailingAverage = parseInt(payload.trailingAverage, 10)\n        }\n      },\n      setCompare (state, payload) {\n        state.compare = payload.compare\n      },\n      reset (state) {\n        state = {\n          baseRepo: null,\n          comparedRepos: [],\n          trailingAverage: 180,\n          startDate: new Date(\"1 January 2005\"),\n          endDate: new Date(),\n          compare: \"each\",\n          byDate: false,\n        }\n        window.history.pushState(null, 'GHData', '/')\n      } // end reset\n    } // end mutations\n  })\n\n  GHDataApp.store = window.ghdata\n  window.GHDataApp = new Vue(GHDataApp).$mount('#app')\n\n  // Load state from query string\n  let parsed = queryString.parse(location.search, { arrayFormat: 'bracket' })\n  if (parsed.repo) {\n    window.GHDataApp.$store.commit('setBaseRepo', { url: parsed.repo.replace(' ', '/') })\n  }\n  if (parsed.comparedTo) {\n    parsed.comparedTo.forEach((repo) => {\n      window.GHDataApp.$store.commit('addComparedRepo', { url: repo.replace(' ', '/') })\n    })\n  }\n\n}","var $ = require('jquery')\n\nexport default class GHDataAPI {\n  constructor(hostURL, version) {\n    this._version  = version || 'unstable'\n    this._host     = hostURL || 'http://' + window.location.host + '/api/'\n    this.__cache   = {}\n  }\n\n  Repo(owner, repoName) {\n\n    if (repoName) {\n      var repo = {owner: owner, name: repoName}\n    } else if (owner) {\n      let splitURL = owner.split('/')\n      if (splitURL.length < 3) {\n        var repo = {owner: splitURL[0], name: splitURL[1]}\n      } else {\n        var repo = {owner: splitURL[3], name: splitURL[4]}\n      }\n    }\n\n    repo.toString = () => { return repo.owner + '/' + repo.name }\n\n    var Endpoint = (endpoint) => {\n      var self = this;\n      var url = this._host + this._version + '/' + repo.owner + '/' + repo.name + '/' + endpoint;\n      return function (params, callback) {\n        if (self.__cache[btoa(url)]) {\n          if (self.__cache[btoa(url)].created_at > Date.now() - 1000 * 60) {\n            return new Promise((resolve, reject) => {\n              resolve(JSON.parse(self.__cache[btoa(url)].data))\n            })\n          }\n        }\n        return $.get(url, params, callback).then((data) => {\n          self.__cache[btoa(url)] = {\n            created_at: Date.now(),\n            data: JSON.stringify(data)\n          }\n          if (typeof callback === 'function') {\n            callback(data)\n          }\n          return new Promise((resolve, reject) => {\n            resolve(data)\n          })\n        })\n      }\n    }\n\n    var Timeseries = (endpoint) => {\n      let func = Endpoint('timeseries/' + endpoint)\n      func.relativeTo = (baselineRepo, params, callback) => {\n        var url = 'timeseries/' + endpoint + '/relative_to/' + baselineRepo.owner + '/' + baselineRepo.name;\n        return Endpoint(url)()\n      }\n      return func\n    }\n\n    repo.commits          = Timeseries('commits')\n    repo.forks            = Timeseries('forks')\n    repo.issues           = Timeseries('issues')\n    repo.pulls            = Timeseries('pulls')\n    repo.stars            = Timeseries('stargazers')\n    repo.tags             = Timeseries('tags')\n    repo.downloads        = Timeseries('downloads')\n    repo.uniqueCommitters = Timeseries('unique_committers')\n\n\n    repo.pullsAcceptanceRate = Endpoint('pulls/acceptance_rate')\n    repo.issuesResponseTime  = Endpoint('issues/response_time')\n    repo.contributors        = Endpoint('contributors')\n    repo.contributions       = Endpoint('contributions')\n    repo.committerLocations  = Endpoint('committer_locations')\n    repo.communityAge        = Endpoint('community_age')\n    repo.linkingWebsites     = Endpoint('linking_websites')\n    repo.busFactor           = Endpoint('bus_factor')\n    repo.dependents          = Endpoint('dependents')\n    repo.dependencies        = Endpoint('dependencies')\n    repo.dependencyStats     = Endpoint('dependency_stats')\n\n    return repo\n\n  }\n}\n","export default class GHDataStats {\n\n  static convertDates (data, earliest, latest) {\n    earliest = earliest || new Date('01-01-2005')\n    latest = latest || new Date()\n    if (Array.isArray(data[0])) {\n      data = data.map((datum) => {\n        return GHDataStats.convertDates(datum)\n      })\n    } else {\n      \n      data = data.map((d) => {\n        d.date = new Date(d.date)\n        return d\n      }).filter((d) => {\n        return earliest < d.date && d.date < latest\n      })\n    }\n    return data\n  }\n\n  static convertKey (data, key) {\n    if (Array.isArray(data[0])) {\n      data = data.map((datum) => {\n        return GHDataStats.convertKey(datum, key)\n      })\n    } else {\n      const EARLIEST = new Date('01-01-2005')\n      data = data.map((d) => {\n        d.value = d[key];\n        return d;\n      })\n    }\n    return data\n  }\n\n  static averageArray(ary) {\n    return ary.reduce((a, e) => {return a + e}, 0) / (ary.length);\n  }\n\n  static standardDeviation(ary, key, mean) {\n    let flat = ary.map((e) => {return e[key]})\n    mean = mean || GHDataStats.averageArray(flat)\n    let distances = flat.map((e) => {\n      return (e - mean) * (e - mean)\n    })\n    return Math.sqrt(GHDataStats.averageArray(distances))\n  }\n\n  static describe(ary, key) {\n    let flat = ary.map((e) => {return e[key]})\n    let mean = GHDataStats.averageArray(flat)\n    let stddev = GHDataStats.standardDeviation(ary, key, mean)\n    let variance = stddev * stddev\n    return {\n      'mean': mean,\n      'stddev': stddev,\n      'variance': variance\n    }\n  }\n\n  static rollingAverage(data, key, windowSizeInDays) {\n    key = key || 'value'\n    windowSizeInDays = windowSizeInDays || 180\n    let rolling = [];\n    let averageWindow = [];\n    let i = 0;\n    let lastFound = -1;\n\n    let after = new Date()\n    let before = new Date()\n\n    for (let date = new Date(data[0].date); date <= data[data.length - 1].date; date.setDate(date.getDate() + 1)) {\n      \n      after.setDate(date.getDate() - windowSizeInDays)\n\n      if (averageWindow.length < windowSizeInDays) {\n        for (; i < data.length && averageWindow.length <= windowSizeInDays; i++) {\n          if (lastFound > -1) {\n            for (let iter = new Date(data[lastFound].date); iter <= data[i].date; iter.setDate(iter.getDate() + 1)) {\n              averageWindow.push( (data[i][key] + data[lastFound][key]) / 2 )\n            }\n          }\n          lastFound = i\n        }\n      }\n\n      let average = {date: new Date(date)}\n      average[key] = GHDataStats.averageArray(averageWindow.slice(0, windowSizeInDays));\n      averageWindow.shift()\n      rolling.push(average);\n    }\n    return rolling\n  }\n\n  static convertToPercentages(data, key, baseline) {\n    if (!data) {\n      return []\n    }\n    baseline = baseline || GHDataStats.averageArray( data.map((e) => {return e[key]}) )\n    data = data.map((datum) => {\n      datum['value'] = (datum[key] / baseline)\n      return datum\n    })\n    return data\n  }\n\n  static makeRelative(baseData, compareData, config) {\n\n    config.byDate = (config.byDate != undefined)\n    config.earliest = config.earliest || new Date('01-01-2005')\n    config.latest = config.latest || new Date()\n    config.period = config.period || 180\n\n    let iter = {\n      base: 0,\n      compare: 0\n    }\n    let data = {}\n\n    data['base'] = GHDataStats.rollingAverage(\n                     GHDataStats.convertDates(\n                       GHDataStats.convertKey(\n                         baseData, \n                         Object.keys(baseData[0])[1]\n                     ), config.earliest, config.latest\n                   ), undefined, config.period) \n\n    data['compare'] = GHDataStats.rollingAverage(\n                        GHDataStats.convertDates(\n                          GHDataStats.convertKey(\n                            compareData, \n                            Object.keys(compareData[0])[1]\n                        ), config.earliest, config.latest\n                      ), undefined, config.period) \n\n    let smaller = (data['base'][0].date < data['compare'][0].date) ? 'base' : 'compare'\n    let larger  = (data['base'][0].date < data['compare'][0].date) ? 'compare' : 'base'\n    let result  = []\n\n    if (config.byDate) {\n      for (; iter[smaller] < data[smaller].length; iter[smaller]++) {\n        if (data['base'].date == data['compare'].date) {\n          break\n        }\n      }\n    }\n\n    while (iter['base'] < data['base'].length && iter['compare'] < data['compare'].length) {\n      let toPush = {\n        value: data['compare'][iter.compare].value / data['base'][iter.base].value,\n      }\n      if (config.byDate) {\n        toPush.date = data['base'][iter.base].date\n      } else {\n        toPush.x = iter.base\n      }\n      result.push(toPush)\n      iter['base']++\n      iter['compare']++\n    }\n\n    console.log('relative', result)\n    return result\n  }\n\n  static zscores(data, key) {\n    key = key || 'value'\n    let stats = GHDataStats.describe(data, key)\n    return data.map((e) => {\n      let newObj = {}\n      if (e.date) {\n        newObj.date = new Date(e.date)\n      }\n      let zscore = ((e[key] - stats['mean']) / stats['stddev'])\n      newObj.value = zscore\n      return newObj\n    })\n  }\n\n  static combine() {\n    return Array.from(arguments)\n  }\n\n}",";(function(){\n'use strict';\n\nvar _LineChart = require('./charts/LineChart');\n\nvar _LineChart2 = _interopRequireDefault(_LineChart);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = {\n  components: {\n    LineChart: _LineChart2.default\n  },\n  computed: {\n    repo: function repo() {\n      return this.$store.state.repo;\n    }\n  }\n};\n})()\nif (module.exports.__esModule) module.exports = module.exports.default\nvar __vue__options__ = (typeof module.exports === \"function\"? module.exports.options: module.exports)\nif (__vue__options__.functional) {console.error(\"[vueify] functional components are not supported and should be defined in plain js files using render functions.\")}\n__vue__options__.render = function render () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',[_c('h1',[_vm._v(\"Activity\")]),_vm._v(\" \"),_c('h2',[_vm._v(_vm._s(_vm.$store.state.baseRepo))]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col col-12\"},[_c('line-chart',{attrs:{\"source\":\"commits\",\"title\":\"Commits / Week\",\"cite-url\":\"https://github.com/chaoss/metrics/blob/master/activity-metrics/community-activity.md\",\"cite-text\":\"Community Activty\"}})],1)]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col col-12\"},[_c('line-chart',{attrs:{\"source\":\"forks\",\"title\":\"Forks / Week\",\"cite-url\":\"https://github.com/chaoss/metrics/blob/master/activity-metrics/community-activity.md\",\"cite-text\":\"Community Activty\"}})],1)]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col col-12\"},[_c('line-chart',{attrs:{\"source\":\"issues\",\"title\":\"Issues / Week\",\"cite-url\":\"https://github.com/chaoss/metrics/blob/master/activity-metrics/community-activity.md\",\"cite-text\":\"Community Activty\"}})],1)]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col col-6\"},[_c('line-chart',{attrs:{\"source\":\"pulls\",\"title\":\"Pulls Requests / Week\",\"cite-url\":\"https://github.com/chaoss/metrics/blob/master/activity-metrics/community-activity.md\",\"cite-text\":\"Contributors\"}})],1),_vm._v(\" \"),_c('div',{staticClass:\"col col-6\"},[_c('line-chart',{attrs:{\"source\":\"uniqueCommitters\",\"title\":\"Unique Committers\",\"cite-url\":\"https://github.com/chaoss/metrics/blob/master/activity-metrics/community-activity.md\",\"cite-text\":\"Contributors\",\"disableRollingAverage\":\"1\"}})],1)]),_vm._v(\" \"),_vm._m(0)])}\n__vue__options__.staticRenderFns = [function render () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('small',[_vm._v(\"Data provided by \"),_c('a',{attrs:{\"href\":\"http://ghtorrent.org/msr14.html\"}},[_vm._v(\"GHTorrent\")]),_vm._v(\" \"),_c('span',{staticClass:\"ghtorrent-version\"}),_vm._v(\" and the \"),_c('a',{attrs:{\"href\":\"https://developer.github.com/\"}},[_vm._v(\"GitHub API\")])])}]\nif (module.hot) {(function () {  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), true)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-7655e5a2\", __vue__options__)\n  } else {\n    hotAPI.reload(\"data-v-7655e5a2\", __vue__options__)\n  }\n})()}",";(function(){\n'use strict';\n\nvar _LineChart = require('./charts/LineChart');\n\nvar _LineChart2 = _interopRequireDefault(_LineChart);\n\nvar _DependencyOverview = require('./charts/DependencyOverview');\n\nvar _DependencyOverview2 = _interopRequireDefault(_DependencyOverview);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = {\n  components: {\n    LineChart: _LineChart2.default,\n    DependencyOverview: _DependencyOverview2.default\n  },\n  computed: {\n    repo: function repo() {\n      return this.$store.state.repo;\n    }\n  }\n};\n})()\nif (module.exports.__esModule) module.exports = module.exports.default\nvar __vue__options__ = (typeof module.exports === \"function\"? module.exports.options: module.exports)\nif (__vue__options__.functional) {console.error(\"[vueify] functional components are not supported and should be defined in plain js files using render functions.\")}\n__vue__options__.render = function render () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',[_c('h1',[_vm._v(\"Ecosystem\")]),_vm._v(\" \"),_c('h2',[_vm._v(_vm._s(_vm.$store.state.baseRepo))]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col col-12\"},[_c('line-chart',{attrs:{\"source\":\"downloads\",\"title\":\"Downloads / Day\",\"cite-url\":\"https://github.com/chaoss/metrics/blob/master/activity-metrics/community-activity.md\",\"cite-text\":\"Community Activty\"}})],1)]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col col-12\"},[_c('line-chart',{attrs:{\"source\":\"stars\",\"title\":\"Stars / Week\",\"cite-url\":\"https://github.com/chaoss/metrics/blob/master/activity-metrics/community-activity.md\",\"cite-text\":\"Community Activty\"}})],1)]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col col-12\"},[_c('dependency-overview')],1)])])}\n__vue__options__.staticRenderFns = []\nif (module.hot) {(function () {  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), true)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-2a4aa320\", __vue__options__)\n  } else {\n    hotAPI.reload(\"data-v-2a4aa320\", __vue__options__)\n  }\n})()}",";(function(){\n'use strict';\n\nvar _LineChart = require('./charts/LineChart');\n\nvar _LineChart2 = _interopRequireDefault(_LineChart);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = {\n  props: ['comparedTo'],\n  components: {\n    LineChart: _LineChart2.default\n  },\n  computed: {\n    repo: function repo() {\n      return this.$store.state.repo;\n    }\n  }\n};\n})()\nif (module.exports.__esModule) module.exports = module.exports.default\nvar __vue__options__ = (typeof module.exports === \"function\"? module.exports.options: module.exports)\nif (__vue__options__.functional) {console.error(\"[vueify] functional components are not supported and should be defined in plain js files using render functions.\")}\n__vue__options__.render = function render () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',[_c('div',{class:{ hidden: !this.repo },attrs:{\"id\":\"base-template\"}}),_vm._v(\" \"),_c('h1',[_vm._v(\"Activity Comparison\")]),_vm._v(\" \"),_c('h2',[_vm._v(_vm._s(_vm.comparedTo)+\" compared to \"+_vm._s(_vm.$store.state.baseRepo))]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col col-12\"},[_c('line-chart',{attrs:{\"source\":\"timeseries/forks\",\"title\":\"Forks / Week\",\"cite-url\":\"https://github.com/chaoss/metrics/blob/master/activity-metrics/community-activity.md\",\"cite-text\":\"Community Activty\",\"compared-to\":_vm.comparedTo}})],1)]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col col-12\"},[_c('line-chart',{attrs:{\"source\":\"forks\",\"title\":\"Forks / Week\",\"cite-url\":\"https://github.com/chaoss/metrics/blob/master/activity-metrics/community-activity.md\",\"cite-text\":\"Community Activty\",\"compared-to\":_vm.comparedTo}})],1)]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col col-12\"},[_c('line-chart',{attrs:{\"source\":\"issues\",\"title\":\"Issues / Week\",\"cite-url\":\"https://github.com/chaoss/metrics/blob/master/activity-metrics/community-activity.md\",\"cite-text\":\"Community Activty\",\"compared-to\":_vm.comparedTo}})],1)]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col col-12\"},[_c('line-chart',{attrs:{\"source\":\"uniqueCommitters\",\"title\":\"Unique Committers\",\"cite-url\":\"https://github.com/chaoss/metrics/blob/master/activity-metrics/community-activity.md\",\"cite-text\":\"Contributors\",\"compared-to\":_vm.comparedTo}})],1)]),_vm._v(\" \"),_vm._m(0)])}\n__vue__options__.staticRenderFns = [function render () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('small',[_vm._v(\"Data provided by \"),_c('a',{attrs:{\"href\":\"http://ghtorrent.org/msr14.html\"}},[_vm._v(\"GHTorrent\")]),_vm._v(\" \"),_c('span',{staticClass:\"ghtorrent-version\"}),_vm._v(\" and the \"),_c('a',{attrs:{\"href\":\"https://developer.github.com/\"}},[_vm._v(\"GitHub API\")])])}]\nif (module.hot) {(function () {  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), true)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-7c1c00fd\", __vue__options__)\n  } else {\n    hotAPI.reload(\"data-v-7c1c00fd\", __vue__options__)\n  }\n})()}",";(function(){\n'use strict';\n\nvar _GHDataHeader = require('./GHDataHeader.vue');\n\nvar _GHDataHeader2 = _interopRequireDefault(_GHDataHeader);\n\nvar _SidebarControls = require('./SidebarControls.vue');\n\nvar _SidebarControls2 = _interopRequireDefault(_SidebarControls);\n\nvar _GHDataCards = require('./GHDataCards.vue');\n\nvar _GHDataCards2 = _interopRequireDefault(_GHDataCards);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = {\n  components: {\n    'ghdata-header': _GHDataHeader2.default,\n    SidebarControls: _SidebarControls2.default,\n    'ghdata-cards': _GHDataCards2.default\n  }\n};\n})()\nif (module.exports.__esModule) module.exports = module.exports.default\nvar __vue__options__ = (typeof module.exports === \"function\"? module.exports.options: module.exports)\nif (__vue__options__.functional) {console.error(\"[vueify] functional components are not supported and should be defined in plain js files using render functions.\")}\n__vue__options__.render = function render () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('ghdata-header'),_vm._v(\" \"),_c('div',{staticClass:\"content\"},[_c('sidebar-controls'),_vm._v(\" \"),_c('ghdata-cards')],1)],1)}\n__vue__options__.staticRenderFns = []\nif (module.hot) {(function () {  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), true)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-f1292d0e\", __vue__options__)\n  } else {\n    hotAPI.reload(\"data-v-f1292d0e\", __vue__options__)\n  }\n})()}",";(function(){\n'use strict';\n\nvar _BaseRepoActivityCard = require('./BaseRepoActivityCard');\n\nvar _BaseRepoActivityCard2 = _interopRequireDefault(_BaseRepoActivityCard);\n\nvar _BaseRepoEcosystemCard = require('./BaseRepoEcosystemCard');\n\nvar _BaseRepoEcosystemCard2 = _interopRequireDefault(_BaseRepoEcosystemCard);\n\nvar _ComparedRepoActivityCard = require('./ComparedRepoActivityCard');\n\nvar _ComparedRepoActivityCard2 = _interopRequireDefault(_ComparedRepoActivityCard);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = {\n  components: {\n    BaseRepoActivityCard: _BaseRepoActivityCard2.default,\n    BaseRepoEcosystemCard: _BaseRepoEcosystemCard2.default,\n    ComparedRepoActivityCard: _ComparedRepoActivityCard2.default\n  },\n  computed: {\n    baseRepo: function baseRepo() {\n      return this.$store.state.baseRepo;\n    },\n    comparedRepos: function comparedRepos() {\n      return this.$store.state.comparedRepos;\n    }\n  },\n  methods: {\n    onRepo: function onRepo(e) {\n      this.$store.commit('setBaseRepo', {\n        url: e.target.value\n      });\n    },\n    onCompare: function onCompare(e) {\n      this.$store.commit('addComparedRepo', {\n        url: e.target.value\n      });\n    }\n  }\n};\n})()\nif (module.exports.__esModule) module.exports = module.exports.default\nvar __vue__options__ = (typeof module.exports === \"function\"? module.exports.options: module.exports)\nif (__vue__options__.functional) {console.error(\"[vueify] functional components are not supported and should be defined in plain js files using render functions.\")}\n__vue__options__.render = function render () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"cards\",staticClass:\"content\"},[_c('section',{class:{ hidden: _vm.baseRepo, unmaterialized: true }},[_c('h3',[_vm._v(\"Enter a GitHub URL to get started\")]),_vm._v(\" \"),_c('input',{staticClass:\"search reposearch\",attrs:{\"type\":\"text\",\"placeholder\":\"GitHub URL\"},on:{\"change\":_vm.onRepo}})]),_vm._v(\" \"),_c('div',{class:{ hidden: !_vm.baseRepo }},[_c('base-repo-activity-card'),_vm._v(\" \"),_c('base-repo-ecosystem-card')],1),_vm._v(\" \"),_vm._l((_vm.comparedRepos),function(repo){return _c('div',{class:{ hidden: !_vm.comparedRepos.length },attrs:{\"id\":\"comparisonCards\"}},[_c('compared-repo-activity-card',{attrs:{\"comparedTo\":repo}})],1)}),_vm._v(\" \"),_c('section',{class:{ hidden: !_vm.baseRepo, unmaterialized: true }},[_c('h3',[_vm._v(\"Compare repository\")]),_vm._v(\" \"),_c('input',{staticClass:\"search reposearch\",attrs:{\"type\":\"text\",\"placeholder\":\"GitHub URL\"},on:{\"change\":_vm.onCompare}})])],2)}\n__vue__options__.staticRenderFns = []\nif (module.hot) {(function () {  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), true)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-323615bb\", __vue__options__)\n  } else {\n    hotAPI.reload(\"data-v-323615bb\", __vue__options__)\n  }\n})()}",";(function(){\n'use strict';\n\nmodule.exports = {\n  methods: {\n    onRepo: function onRepo(e) {\n      this.$store.commit('setBaseRepo', {\n        url: e.target.value\n      });\n    }\n  }\n};\n})()\nif (module.exports.__esModule) module.exports = module.exports.default\nvar __vue__options__ = (typeof module.exports === \"function\"? module.exports.options: module.exports)\nif (__vue__options__.functional) {console.error(\"[vueify] functional components are not supported and should be defined in plain js files using render functions.\")}\n__vue__options__.render = function render () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('header',{staticClass:\"hide-print\"},[_c('div',{staticClass:\"content\"},[_c('div',{staticClass:\"row\"},[_vm._m(0),_vm._v(\" \"),_c('div',{staticClass:\"col col-5 push-right\"},[_c('div',{staticClass:\"form-item\"},[_c('input',{staticClass:\"search reposearch\",attrs:{\"type\":\"text\",\"name\":\"headersearch\",\"placeholder\":\"GitHub URL\"},on:{\"change\":_vm.onRepo}})])])])])])}\n__vue__options__.staticRenderFns = [function render () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"col col-4\"},[_c('img',{attrs:{\"src\":\"static/logo.png\",\"id\":\"logo\",\"alt\":\"CHAOSS: Community Health Analytics for Open Source Software\"}})])}]\nif (module.hot) {(function () {  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), true)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-30d34965\", __vue__options__)\n  } else {\n    hotAPI.reload(\"data-v-30d34965\", __vue__options__)\n  }\n})()}",";(function(){\n'use strict';\n\nmodule.exports = {\n  methods: {\n    onStartDateChange: function onStartDateChange(e) {\n      var _this = this;\n\n      if (this.startDateTimeout) {\n        clearTimeout(this.startDateTimeout);\n      }\n      this.startDateTimeout = setTimeout(function () {\n        _this.$store.commit('setDates', {\n          startDate: e.target.value\n        });\n      }, 500);\n    },\n    onEndDateChange: function onEndDateChange(e) {\n      var _this2 = this;\n\n      if (this.endDateTimeout) {\n        clearTimeout(this.endDateTimeout);\n        delete this.endDateTimeout;\n      }\n      this.endDateTimeout = setTimeout(function () {\n        _this2.$store.commit('setDates', {\n          endDate: e.target.value\n        });\n      }, 500);\n    },\n    onTrailingAverageChange: function onTrailingAverageChange(e) {\n      this.$store.commit('setDates', {\n        trailingAverage: e.target.value\n      });\n    },\n    onCompareChange: function onCompareChange(e) {\n      this.$store.commit('setCompare', {\n        compare: e.target.value\n      });\n    }\n  }\n};\n})()\nif (module.exports.__esModule) module.exports = module.exports.default\nvar __vue__options__ = (typeof module.exports === \"function\"? module.exports.options: module.exports)\nif (__vue__options__.functional) {console.error(\"[vueify] functional components are not supported and should be defined in plain js files using render functions.\")}\n__vue__options__.render = function render () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"row\",attrs:{\"id\":\"controls\"}},[_c('div',{staticClass:\"col col-12\"},[_c('div',{staticClass:\"form\"},[_c('h4',[_vm._v(\"Base Repository\")]),_vm._v(\" \"),_c('div',{staticClass:\"form-item\"},[_c('label',[_vm._v(\"Start Date \"),_c('input',{attrs:{\"type\":\"date\"},on:{\"change\":_vm.onStartDateChange}})])]),_vm._v(\" \"),_c('div',{staticClass:\"form-item\"},[_c('label',[_vm._v(\"End Date \"),_c('input',{attrs:{\"type\":\"date\"},on:{\"change\":_vm.onEndDateChange}})])]),_vm._v(\" \"),_c('div',{staticClass:\"form-item\"},[_c('label',[_vm._v(\"Trailing Average\")]),_vm._v(\" \"),_c('div',{staticClass:\"append\"},[_c('input',{attrs:{\"type\":\"number\",\"min\":\"2\",\"id\":\"averagetimespan\",\"value\":\"180\"},on:{\"change\":_vm.onTrailingAverageChange}}),_c('span',[_vm._v(\"days\")])])]),_vm._v(\" \"),_c('h4',[_vm._v(\"Comparisons\")]),_vm._v(\" \"),_c('div',{staticClass:\"form-item form-checkboxes\"},[_c('label',{staticClass:\"checkbox\"},[_c('input',{attrs:{\"name\":\"comparebaseline\",\"value\":\"each\",\"checked\":\"\",\"type\":\"radio\"},on:{\"change\":_vm.onCompareChange}}),_vm._v(\"Z-score trailing average\")]),_vm._v(\" \"),_c('label',{staticClass:\"checkbox\"},[_c('input',{attrs:{\"name\":\"comparebaseline\",\"value\":\"percentage\",\"type\":\"radio\"},on:{\"change\":_vm.onCompareChange}}),_vm._v(\"100% is the compared project\")])])])])])}\n__vue__options__.staticRenderFns = []\nif (module.hot) {(function () {  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), true)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-0df51156\", __vue__options__)\n  } else {\n    hotAPI.reload(\"data-v-0df51156\", __vue__options__)\n  }\n})()}",";(function(){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _GHDataStats = require('../../GHDataStats');\n\nvar _GHDataStats2 = _interopRequireDefault(_GHDataStats);\n\nvar _d = require('d3');\n\nvar d3 = _interopRequireWildcard(_d);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = {\n  props: [],\n  computed: {\n    repo: function repo() {\n      return this.$store.state.baseRepo;\n    },\n    dependencies: function dependencies() {\n      var _this = this;\n\n      if (this.repo) {\n        window.GHDataRepos[this.repo].dependents().then(function (dependents) {\n          _this.$refs['dependents'].innerHTML = '';\n          for (var i = 0; i < dependents.length && i < 10; i++) {\n            _this.$refs['dependents'].innerHTML += dependents[i].name + '<br>';\n          }\n        });\n        window.GHDataRepos[this.repo].dependencies().then(function (dependencies) {\n          _this.$refs['dependencies'].innerHTML = '';\n          for (var i = 0; i < dependencies.dependencies.length && i < 10; i++) {\n            _this.$refs['dependents'].innerHTML += dependencies.dependencies[i].name + '<br>';\n          }\n        });\n        window.GHDataRepos[this.repo].dependencyStats().then(function (depstats) {\n          _this.$refs['totaldependents'].innerHTML = depstats['dependent_repositories'];\n          _this.$refs['totaldependencies'].innerHTML = depstats['dependencies'];\n        });\n      }\n    }\n  }\n};\n})()\nif (module.exports.__esModule) module.exports = module.exports.default\nvar __vue__options__ = (typeof module.exports === \"function\"? module.exports.options: module.exports)\nif (__vue__options__.functional) {console.error(\"[vueify] functional components are not supported and should be defined in plain js files using render functions.\")}\n__vue__options__.render = function render () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col col-6\"},[_c('h3',[_vm._v(\"Total Dependents\")]),_vm._v(\" \"),_c('div',{ref:\"totaldependents\",staticClass:\"deps\"},[_vm._v(\"\\n        Loading...\\n      \")])]),_vm._v(\" \"),_c('div',{staticClass:\"col col-6\"},[_c('h3',[_vm._v(\"Total Dependencies\")]),_vm._v(\" \"),_c('div',{ref:\"totaldependencies\",staticClass:\"deps\"},[_vm._v(\"\\n        Loading...\\n      \")])])]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col col-6\"},[_c('h3',[_vm._v(\"Top Dependents\")]),_vm._v(\" \"),_c('div',{ref:\"dependents\",staticClass:\"deps\"},[_vm._v(\"\\n        Loading...\\n      \")])]),_vm._v(\" \"),_c('div',{staticClass:\"col col-6\"},[_c('h3',[_vm._v(\"Top Dependencies\")]),_vm._v(\" \"),_c('div',{ref:\"dependencies\",staticClass:\"deps\",domProps:{\"innerHTML\":_vm._s(_vm.dependencies)}},[_vm._v(\"\\n        Loading...\\n      \")])])])])}\n__vue__options__.staticRenderFns = []\nif (module.hot) {(function () {  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), true)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-210450fe\", __vue__options__)\n  } else {\n    hotAPI.reload(\"data-v-210450fe\", __vue__options__)\n  }\n})()}",";(function(){\n'use strict';\n\nvar _metricsGraphics = require('metrics-graphics');\n\nvar _metricsGraphics2 = _interopRequireDefault(_metricsGraphics);\n\nvar _GHDataStats = require('../GHDataStats');\n\nvar _GHDataStats2 = _interopRequireDefault(_GHDataStats);\n\nvar _d = require('d3');\n\nvar d3 = _interopRequireWildcard(_d);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_metricsGraphics2.default.data_graphic({\n  title: \"Missing Data\",\n  error: 'Data unavaliable for ' + title,\n  chart_type: 'missing-data',\n  missing_text: title + ' could not be loaded',\n  target: undefined.$refs.chart,\n  full_width: true,\n  height: 200\n});\n})()\nif (module.exports.__esModule) module.exports = module.exports.default\nvar __vue__options__ = (typeof module.exports === \"function\"? module.exports.options: module.exports)\nif (__vue__options__.functional) {console.error(\"[vueify] functional components are not supported and should be defined in plain js files using render functions.\")}\n__vue__options__.render = function render () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"chart\",staticClass:\"linechart\"})}\n__vue__options__.staticRenderFns = []\nif (module.hot) {(function () {  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), true)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-ebdae2a4\", __vue__options__)\n  } else {\n    hotAPI.reload(\"data-v-ebdae2a4\", __vue__options__)\n  }\n})()}",";(function(){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _d = require('d3');\n\nvar d3 = _interopRequireWildcard(_d);\n\nvar _GHDataStats = require('GHDataStats');\n\nvar _GHDataStats2 = _interopRequireDefault(_GHDataStats);\n\nvar _vuex = require('vuex');\n\nvar _metricsgraphics = require('../../include/metricsgraphics');\n\nvar _metricsgraphics2 = _interopRequireDefault(_metricsgraphics);\n\nvar _svgsaver = require('../../include/svgsaver');\n\nvar _svgsaver2 = _interopRequireDefault(_svgsaver);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nconsole.log(d3);\n\nexports.default = {\n  props: ['source', 'citeUrl', 'citeText', 'title', 'percentage', 'comparedTo', 'disableRollingAverage', 'alwaysByDate'],\n  computed: {\n    repo: function repo() {\n      return this.$store.state.baseRepo;\n    },\n    period: function period() {\n      return this.$store.state.trailingAverage;\n    },\n    earliest: function earliest() {\n      return this.$store.state.startDate;\n    },\n    latest: function latest() {\n      return this.$store.state.endDate;\n    },\n    compare: function compare() {\n      return this.$store.state.compare;\n    },\n    chart: function chart() {\n      var _this = this;\n\n      var config = {};\n\n      config.earliest = this.earliest || new Date('01-01-2005');\n      config.latest = this.latest || new Date();\n      config.title = this.title || \"Activity\";\n      config.full_width = true;\n      config.height = 200;\n      config.x_accessor = 'date';\n      config.format = this.percentage ? 'percentage' : undefined;\n      config.compare = this.compare;\n      config.byDate = true;\n\n\n      if (this.repo) {\n        if (this.$refs.chart) {\n          this.$refs.chart.className = 'linechart loader';\n        }\n        window.GHDataRepos[this.repo][this.source]().then(function (baseData) {\n          _this.$refs.chartStatus.innerHTML = '';\n          if (baseData && baseData.length) {\n            config.data = _GHDataStats2.default.convertDates(baseData, _this.earliest, _this.latest);\n          } else {\n            config.data = [];\n          }\n          if (_this.comparedTo) {\n            return GHDataRepos[_this.comparedTo][_this.source]();\n          }\n          return new Promise(function (resolve, reject) {\n            resolve();\n          });\n        }).then(function (compareData) {\n          var keys = Object.keys(config.data[0]).splice(1);\n          if (config.data && compareData && compareData.length) {\n            if (config.compare == 'each') {\n              compareData = _GHDataStats2.default.convertDates(compareData, _this.earliest, _this.latest);\n              var key = Object.keys(compareData[0])[1];\n              var compare = _GHDataStats2.default.rollingAverage(_GHDataStats2.default.zscores(compareData, key), 'value', _this.period);\n              var base = _GHDataStats2.default.rollingAverage(_GHDataStats2.default.zscores(config.data, key), 'value', _this.period);\n              config.data = [base, compare];\n              config.legend = [window.GHDataRepos[_this.repo].toString(), window.GHDataRepos[_this.comparedTo].toString()];\n              config.colors = config.colors || ['#FF3647', '#999'];\n            } else {\n              config.format = 'percentage';\n              config.baselines = [{ value: 1, label: config.baseline }];\n              config.data = _GHDataStats2.default.makeRelative(config.data, compareData, {\n                earliest: config.earliest,\n                latest: config.latest,\n                byDate: config.byDate,\n                period: _this.period\n              });\n              config.x_accessor = config.byDate ? 'date' : 'x';\n            }\n          } else {\n            if (!_this.disableRollingAverage) {\n              config.legend = config.legend || [config.title.toLowerCase(), _this.period + ' day average'];\n              var rolling = _GHDataStats2.default.rollingAverage(config.data, keys[0], _this.period);\n              config.data = _GHDataStats2.default.convertKey(_GHDataStats2.default.combine(config.data, rolling), keys[0]);\n              config.colors = config.colors || ['#CCC', '#FF3647'];\n              config.y_accessor = 'value';\n            }\n          }\n\n          if (keys.length > 1) {\n            config.legend_target = _this.$refs.legend;\n            $(_this.$refs.chart).hover(function () {\n              _this.$refs.legend.style.display = 'none';\n            }, function () {\n              _this.$refs.legend.style.display = 'block';\n            });\n          }\n\n          _this.$refs.chart.className = 'linechart intro';\n          config.target = document.createElement('div');\n          _this.$refs.chartholder.innerHTML = '';\n          _this.$refs.chartholder.appendChild(config.target);\n          console.log('finalized config that will be sent', config);\n          _metricsgraphics2.default.data_graphic(config);\n        });\n        return '<div class=\"loader\">' + this.title + '...</div>';\n      }\n    }\n  },\n  methods: {\n    downloadSVG: function downloadSVG(e) {\n      var svgsaver = new _svgsaver2.default();\n      var svg = $(this.$refs.chartholder).find(\"svg\")[0];\n      svgsaver.asSvg(svg);\n    },\n    downloadPNG: function downloadPNG(e) {\n      var svgsaver = new _svgsaver2.default();\n      var svg = $(this.$refs.chartholder).find(\"svg\")[0];\n      svgsaver.asPng(svg);\n    }\n  } };\n})()\nif (module.exports.__esModule) module.exports = module.exports.default\nvar __vue__options__ = (typeof module.exports === \"function\"? module.exports.options: module.exports)\nif (__vue__options__.functional) {console.error(\"[vueify] functional components are not supported and should be defined in plain js files using render functions.\")}\n__vue__options__.render = function render () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('cite',{staticClass:\"metric\"},[_vm._v(\"Metric: \"),_c('a',{attrs:{\"href\":_vm.citeUrl,\"target\":\"_blank\"}},[_vm._v(_vm._s(_vm.citeText))]),_c('button',{staticClass:\"button small\",on:{\"click\":_vm.downloadSVG}},[_vm._v(\"⬇ SVG\")]),_c('button',{staticClass:\"button small\",on:{\"click\":_vm.downloadPNG}},[_vm._v(\"⬇ PNG\")])]),_vm._v(\" \"),_c('div',{ref:\"chart\",staticClass:\"linechart\"},[_c('div',{ref:\"chartholder\"}),_vm._v(\" \"),_c('div',{ref:\"legend\",staticClass:\"legend\"}),_vm._v(\" \"),_c('span',{ref:\"chartStatus\",domProps:{\"innerHTML\":_vm._s(_vm.chart)}})])])}\n__vue__options__.staticRenderFns = []\nif (module.hot) {(function () {  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), true)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-4035d73d\", __vue__options__)\n  } else {\n    hotAPI.reload(\"data-v-4035d73d\", __vue__options__)\n  }\n})()}","/*\n\tKube. CSS & JS Framework\n\tVersion 6.5.2\n\tUpdated: February 2, 2017\n\n\thttp://imperavi.com/kube/\n\n\tCopyright (c) 2009-2017, Imperavi LLC.\n\tLicense: MIT\n*/\nif (typeof jQuery === 'undefined') {throw new Error('Kube\\'s requires jQuery')};\n;(function($) { var version = $.fn.jquery.split('.'); if (version[0] == 1 && version[1] < 8) {throw new Error('Kube\\'s requires at least jQuery v1.8'); }})(jQuery);\n\n;(function()\n{\n    // Inherits\n    Function.prototype.inherits = function(parent)\n    {\n        var F = function () {};\n        F.prototype = parent.prototype;\n        var f = new F();\n\n        for (var prop in this.prototype) f[prop] = this.prototype[prop];\n        this.prototype = f;\n        this.prototype.super = parent.prototype;\n    };\n\n    // Core Class\n    var Kube = function(element, options)\n    {\n        options = (typeof options === 'object') ? options : {};\n\n        this.$element = $(element);\n        this.opts     = $.extend(true, this.defaults, $.fn[this.namespace].options, this.$element.data(), options);\n        this.$target  = (typeof this.opts.target === 'string') ? $(this.opts.target) : null;\n    };\n\n    // Core Functionality\n    Kube.prototype = {\n        getInstance: function()\n        {\n            return this.$element.data('fn.' + this.namespace);\n        },\n        hasTarget: function()\n        {\n           return !(this.$target === null);\n        },\n        callback: function(type)\n        {\n\t\tvar args = [].slice.call(arguments).splice(1);\n\n            // on element callback\n            if (this.$element)\n            {\n                args = this._fireCallback($._data(this.$element[0], 'events'), type, this.namespace, args);\n            }\n\n            // on target callback\n            if (this.$target)\n            {\n                args = this._fireCallback($._data(this.$target[0], 'events'), type, this.namespace, args);\n\t\t}\n\n\t\t// opts callback\n\t\tif (this.opts && this.opts.callbacks && $.isFunction(this.opts.callbacks[type]))\n\t\t{\n                return this.opts.callbacks[type].apply(this, args);\n\t\t}\n\n\t\treturn args;\n        },\n        _fireCallback: function(events, type, eventNamespace, args)\n        {\n            if (events && typeof events[type] !== 'undefined')\n            {\n\t\t\tvar len = events[type].length;\n\t\t\tfor (var i = 0; i < len; i++)\n\t\t\t{\n\t\t\t\tvar namespace = events[type][i].namespace;\n\t\t\t\tif (namespace === eventNamespace)\n\t\t\t\t{\n\t\t\t\t\tvar value = events[type][i].handler.apply(this, args);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n            return (typeof value === 'undefined') ? args : value;\n        }\n    };\n\n    // Scope\n    window.Kube = Kube;\n\n})();\n/**\n * @library Kube Plugin\n * @author Imperavi LLC\n * @license MIT\n */\n(function(Kube)\n{\n    Kube.Plugin = {\n        create: function(classname, pluginname)\n        {\n            pluginname = (typeof pluginname === 'undefined') ? classname.toLowerCase() : pluginname;\n\n            $.fn[pluginname] = function(method, options)\n            {\n                var args = Array.prototype.slice.call(arguments, 1);\n                var name = 'fn.' + pluginname;\n                var val = [];\n\n                this.each(function()\n                {\n                    var $this = $(this), data = $this.data(name);\n                    options = (typeof method === 'object') ? method : options;\n\n                    if (!data)\n                    {\n                        // Initialization\n                        $this.data(name, {});\n                        $this.data(name, (data = new Kube[classname](this, options)));\n                    }\n\n                    // Call methods\n                    if (typeof method === 'string')\n                    {\n                        if ($.isFunction(data[method]))\n                        {\n                            var methodVal = data[method].apply(data, args);\n                            if (methodVal !== undefined)\n                            {\n                                val.push(methodVal);\n                            }\n                        }\n                        else\n                        {\n                            $.error('No such method \"' + method + '\" for ' + classname);\n                        }\n                    }\n\n                });\n\n                return (val.length === 0 || val.length === 1) ? ((val.length === 0) ? this : val[0]) : val;\n            };\n\n            $.fn[pluginname].options = {};\n\n            return this;\n        },\n        autoload: function(pluginname)\n        {\n            var arr = pluginname.split(',');\n            var len = arr.length;\n\n            for (var i = 0; i < len; i++)\n            {\n                var name = arr[i].toLowerCase().split(',').map(function(s) { return s.trim() }).join(',');\n                this.autoloadQueue.push(name);\n            }\n\n            return this;\n        },\n        autoloadQueue: [],\n        startAutoload: function()\n        {\n            if (!window.MutationObserver || this.autoloadQueue.length === 0)\n            {\n                return;\n            }\n\n            var self = this;\n\t\tvar observer = new MutationObserver(function(mutations)\n\t\t{\n\t\t\tmutations.forEach(function(mutation)\n\t\t\t{\n\t\t\t\tvar newNodes = mutation.addedNodes;\n\t\t\t    if (newNodes.length === 0 || (newNodes.length === 1 && newNodes.nodeType === 3))\n\t\t\t    {\n\t\t\t\t    return;\n\t\t\t\t}\n\n                    self.startAutoloadOnce();\n\t\t\t});\n\t\t});\n\n\t\t// pass in the target node, as well as the observer options\n\t\tobserver.observe(document, {\n\t\t\t subtree: true,\n\t\t\t childList: true\n\t\t});\n        },\n        startAutoloadOnce: function()\n        {\n            var self = this;\n            var $nodes = $('[data-component]').not('[data-loaded]');\n\t\t$nodes.each(function()\n\t\t{\n\t\t\tvar $el = $(this);\n\t\t\tvar pluginname = $el.data('component');\n\n                if (self.autoloadQueue.indexOf(pluginname) !== -1)\n                {\n\t\t\t$el.attr('data-loaded', true);\n                    $el[pluginname]();\n                }\n            });\n\n        },\n        watch: function()\n        {\n            Kube.Plugin.startAutoloadOnce();\n            Kube.Plugin.startAutoload();\n        }\n    };\n\n    $(window).on('load', function()\n    {\n        Kube.Plugin.watch();\n    });\n\n}(Kube));\n/**\n * @library Kube Animation\n * @author Imperavi LLC\n * @license MIT\n */\n(function(Kube)\n{\n    Kube.Animation = function(element, effect, callback)\n    {\n        this.namespace = 'animation';\n        this.defaults = {};\n\n        // Parent Constructor\n        Kube.apply(this, arguments);\n\n        // Initialization\n        this.effect = effect;\n        this.completeCallback = (typeof callback === 'undefined') ? false : callback;\n        this.prefixes = ['', '-moz-', '-o-animation-', '-webkit-'];\n        this.queue = [];\n\n        this.start();\n    };\n\n    Kube.Animation.prototype = {\n        start: function()\n        {\n\t\tif (this.isSlideEffect()) this.setElementHeight();\n\n\t\t\tthis.addToQueue();\n\t\t\tthis.clean();\n\t\t\tthis.animate();\n        },\n        addToQueue: function()\n        {\n            this.queue.push(this.effect);\n        },\n        setElementHeight: function()\n        {\n            this.$element.height(this.$element.height());\n        },\n        removeElementHeight: function()\n        {\n            this.$element.css('height', '');\n        },\n        isSlideEffect: function()\n        {\n            return (this.effect === 'slideDown' || this.effect === 'slideUp');\n        },\n        isHideableEffect: function()\n        {\n            var effects = ['fadeOut', 'slideUp', 'flipOut', 'zoomOut', 'slideOutUp', 'slideOutRight', 'slideOutLeft'];\n\n\t\t\treturn ($.inArray(this.effect, effects) !== -1);\n        },\n        isToggleEffect: function()\n        {\n            return (this.effect === 'show' || this.effect === 'hide');\n        },\n        storeHideClasses: function()\n        {\n            if (this.$element.hasClass('hide-sm'))      this.$element.data('hide-sm-class', true);\n            else if (this.$element.hasClass('hide-md')) this.$element.data('hide-md-class', true);\n        },\n        revertHideClasses: function()\n        {\n            if (this.$element.data('hide-sm-class'))      this.$element.addClass('hide-sm').removeData('hide-sm-class');\n            else if (this.$element.data('hide-md-class')) this.$element.addClass('hide-md').removeData('hide-md-class');\n            else                                          this.$element.addClass('hide');\n        },\n        removeHideClass: function()\n        {\n            if (this.$element.data('hide-sm-class'))      this.$element.removeClass('hide-sm');\n            else if (this.$element.data('hide-md-class')) this.$element.removeClass('hide-md');\n            else                                          this.$element.removeClass('hide');\n        },\n        animate: function()\n        {\n            this.storeHideClasses();\n            if (this.isToggleEffect())\n\t\t\t{\n\t\t\t\treturn this.makeSimpleEffects();\n            }\n\n            this.$element.addClass('kubeanimated');\n\t\t\tthis.$element.addClass(this.queue[0]);\n            this.removeHideClass();\n\n\t\t\tvar _callback = (this.queue.length > 1) ? null : this.completeCallback;\n\t\t\tthis.complete('AnimationEnd', $.proxy(this.makeComplete, this), _callback);\n        },\n        makeSimpleEffects: function()\n        {\n\t\tif      (this.effect === 'show') this.removeHideClass();\n            else if (this.effect === 'hide') this.revertHideClasses();\n\n            if (typeof this.completeCallback === 'function') this.completeCallback(this);\n        },\n\t\tmakeComplete: function()\n\t\t{\n            if (this.$element.hasClass(this.queue[0]))\n            {\n\t\t\t\tthis.clean();\n\t\t\t\tthis.queue.shift();\n\n\t\t\t\tif (this.queue.length) this.animate();\n\t\t\t}\n\t\t},\n        complete: function(type, make, callback)\n\t\t{\n\t\tvar event = type.toLowerCase() + ' webkit' + type + ' o' + type + ' MS' + type;\n\n\t\t\tthis.$element.one(event, $.proxy(function()\n\t\t\t{\n\t\t\t\tif (typeof make === 'function')     make();\n\t\t\t\tif (this.isHideableEffect())        this.revertHideClasses();\n\t\t\t\tif (this.isSlideEffect())           this.removeElementHeight();\n\t\t\t\tif (typeof callback === 'function') callback(this);\n\n\t\t\t\tthis.$element.off(event);\n\n\t\t\t}, this));\n\t\t},\n\t\tclean: function()\n\t\t{\n\t\t\tthis.$element.removeClass('kubeanimated').removeClass(this.queue[0]);\n\t\t}\n    };\n\n    // Inheritance\n    Kube.Animation.inherits(Kube);\n\n}(Kube));\n\n// Plugin\n(function($)\n{\n    $.fn.animation = function(effect, callback)\n    {\n        var name = 'fn.animation';\n\n        return this.each(function()\n        {\n            var $this = $(this), data = $this.data(name);\n\n            $this.data(name, {});\n            $this.data(name, (data = new Kube.Animation(this, effect, callback)));\n        });\n    };\n\n    $.fn.animation.options = {};\n\n})(jQuery);\n/**\n * @library Kube Detect\n * @author Imperavi LLC\n * @license MIT\n */\n(function(Kube)\n{\n    Kube.Detect = function() {};\n\n    Kube.Detect.prototype = {\n\tisMobile: function()\n\t{\n\t\treturn /(iPhone|iPod|BlackBerry|Android)/.test(navigator.userAgent);\n\t},\n\tisDesktop: function()\n\t{\n\t\treturn !/(iPhone|iPod|iPad|BlackBerry|Android)/.test(navigator.userAgent);\n\t},\n\tisMobileScreen: function()\n\t{\n\t\treturn ($(window).width() <= 768);\n\t},\n\tisTabletScreen: function()\n\t{\n\t\treturn ($(window).width() >= 768 && $(window).width() <= 1024);\n\t},\n\tisDesktopScreen: function()\n\t{\n\t\treturn ($(window).width() > 1024);\n\t}\n    };\n\n\n}(Kube));\n/**\n * @library Kube FormData\n * @author Imperavi LLC\n * @license MIT\n */\n(function(Kube)\n{\n    Kube.FormData = function(app)\n    {\n        this.opts = app.opts;\n    };\n\n    Kube.FormData.prototype = {\n        set: function(data)\n        {\n            this.data = data;\n        },\n        get: function(formdata)\n\t{\n\t\tthis.formdata = formdata;\n\n            if (this.opts.appendForms) this.appendForms();\n            if (this.opts.appendFields) this.appendFields();\n\n            return this.data;\n\t},\n\tappendFields: function()\n\t{\n\t\tvar $fields = $(this.opts.appendFields);\n\t\tif ($fields.length === 0)\n\t\t{\n\t\t\treturn;\n            }\n\n\t\tvar self = this;\n            var str = '';\n\n            if (this.formdata)\n            {\n                $fields.each(function()\n\t\t\t{\n\t\t\t\tself.data.append($(this).attr('name'), $(this).val());\n\t\t\t});\n            }\n            else\n            {\n\t\t\t$fields.each(function()\n\t\t\t{\n\t\t\t\tstr += '&' + $(this).attr('name') + '=' + $(this).val();\n\t\t\t});\n\n\t\t\tthis.data = (this.data === '') ? str.replace(/^&/, '') : this.data + str;\n            }\n\t},\n\tappendForms: function()\n\t{\n\t\tvar $forms = $(this.opts.appendForms);\n\t\tif ($forms.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n            if (this.formdata)\n            {\n                var self = this;\n                var formsData = $(this.opts.appendForms).serializeArray();\n                $.each(formsData, function(i,s)\n                {\n\t\t\tself.data.append(s.name, s.value);\n                });\n            }\n            else\n            {\n                var str = $forms.serialize();\n\n                this.data = (this.data === '') ? str : this.data + '&' + str;\n            }\n\t}\n    };\n\n\n}(Kube));\n/**\n * @library Kube Response\n * @author Imperavi LLC\n * @license MIT\n */\n(function(Kube)\n{\n    Kube.Response = function(app) {};\n\n    Kube.Response.prototype = {\n        parse: function(str)\n\t{\n\t\tif (str === '') return false;\n\n\t\tvar obj = {};\n\n\t\ttry {\n\t\t\tobj = JSON.parse(str);\n\t\t} catch (e) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (obj[0] !== undefined)\n\t\t{\n\t\t\tfor (var item in obj)\n\t\t\t{\n\t\t\t\tthis.parseItem(obj[item]);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.parseItem(obj);\n\t\t}\n\n\t\treturn obj;\n\t},\n\tparseItem: function(item)\n\t{\n\t\tif (item.type === 'value')\n\t\t{\n\t\t\t$.each(item.data, $.proxy(function(key, val)\n\t\t\t{\n\t\t\t\tval = (val === null || val === false) ? 0 : val;\n\t\t\t\tval = (val === true) ? 1 : val;\n\n\t\t\t\t$(key).val(val);\n\n\t\t\t}, this));\n\t\t}\n\t\telse if (item.type === 'html')\n\t\t{\n\t\t\t$.each(item.data, $.proxy(function(key, val)\n\t\t\t{\n\t\t\t\tval = (val === null || val === false) ? '' : val;\n\n\t\t\t\t$(key).html(this.stripslashes(val));\n\n\t\t\t}, this));\n\t\t}\n\t\telse if (item.type === 'addClass')\n\t\t{\n\t\t\t$.each(item.data, function(key, val)\n\t\t\t{\n\t\t\t\t$(key).addClass(val);\n\t\t\t});\n            }\n\t\telse if (item.type === 'removeClass')\n\t\t{\n\t\t\t$.each(item.data, function(key, val)\n\t\t\t{\n\t\t\t\t$(key).removeClass(val);\n\t\t\t});\n            }\n\t\telse if (item.type === 'command')\n\t\t{\n\t\t\t$.each(item.data, function(key, val)\n\t\t\t{\n\t\t\t\t$(val)[key]();\n\t\t\t});\n\t\t}\n\t\telse if (item.type === 'animation')\n\t\t{\n\t\t\t$.each(item.data, function(key, data)\n\t\t\t{\n\t\t\t\tdata.opts = (typeof data.opts === 'undefined') ? {} : data.opts;\n\n\t\t\t\t$(key).animation(data.name, data.opts);\n\t\t\t});\n\t\t}\n\t\telse if (item.type === 'location')\n\t\t{\n\t\t\ttop.location.href = item.data;\n\t\t}\n\t\telse if (item.type === 'notify')\n\t\t{\n\t\t\t$.notify(item.data);\n\t\t}\n\n\t\treturn item;\n\t},\n        stripslashes: function(str)\n\t{\n\t\treturn (str+'').replace(/\\0/g, '0').replace(/\\\\([\\\\'\"])/g, '$1');\n        }\n    };\n\n\n}(Kube));\n/**\n * @library Kube Utils\n * @author Imperavi LLC\n * @license MIT\n */\n(function(Kube)\n{\n    Kube.Utils = function() {};\n\n    Kube.Utils.prototype = {\n        disableBodyScroll: function()\n\t{\n\t\tvar $body = $('html');\n\t\tvar windowWidth = window.innerWidth;\n\n\t\tif (!windowWidth)\n\t\t{\n\t\t\tvar documentElementRect = document.documentElement.getBoundingClientRect();\n\t\t\twindowWidth = documentElementRect.right - Math.abs(documentElementRect.left);\n\t\t}\n\n\t\tvar isOverflowing = document.body.clientWidth < windowWidth;\n\t\tvar scrollbarWidth = this.measureScrollbar();\n\n\t\t$body.css('overflow', 'hidden');\n\t\tif (isOverflowing) $body.css('padding-right', scrollbarWidth);\n\t},\n\tmeasureScrollbar: function()\n\t{\n\t\tvar $body = $('body');\n\t\tvar scrollDiv = document.createElement('div');\n\t\tscrollDiv.className = 'scrollbar-measure';\n\n\t\t$body.append(scrollDiv);\n\t\tvar scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\n\t\t$body[0].removeChild(scrollDiv);\n\t\treturn scrollbarWidth;\n\t},\n\tenableBodyScroll: function()\n\t{\n\t\t$('html').css({ 'overflow': '', 'padding-right': '' });\n\t}\n    };\n\n\n}(Kube));\n/**\n * @library Kube Message\n * @author Imperavi LLC\n * @license MIT\n */\n(function(Kube)\n{\n    Kube.Message = function(element, options)\n    {\n        this.namespace = 'message';\n        this.defaults = {\n            closeSelector: '.close',\n            closeEvent: 'click',\n            animationOpen: 'fadeIn',\n            animationClose: 'fadeOut',\n            callbacks: ['open', 'opened', 'close', 'closed']\n        };\n\n        // Parent Constructor\n        Kube.apply(this, arguments);\n\n        // Initialization\n        this.start();\n    };\n\n    // Functionality\n    Kube.Message.prototype = {\n        start: function()\n        {\n            this.$close = this.$element.find(this.opts.closeSelector);\n            this.$close.on(this.opts.closeEvent + '.' + this.namespace, $.proxy(this.close, this));\n            this.$element.addClass('open');\n        },\n        stop: function()\n        {\n            this.$close.off('.' + this.namespace);\n            this.$element.removeClass('open');\n        },\n        open: function(e)\n        {\n            if (e) e.preventDefault();\n\n            if (!this.isOpened())\n            {\n                this.callback('open');\n                this.$element.animation(this.opts.animationOpen, $.proxy(this.onOpened, this));\n            }\n        },\n        isOpened: function()\n        {\n            return this.$element.hasClass('open');\n        },\n        onOpened: function()\n        {\n            this.callback('opened');\n            this.$element.addClass('open');\n        },\n        close: function(e)\n        {\n            if (e) e.preventDefault();\n\n            if (this.isOpened())\n            {\n                this.callback('close');\n                this.$element.animation(this.opts.animationClose, $.proxy(this.onClosed, this));\n            }\n        },\n        onClosed: function()\n        {\n            this.callback('closed');\n            this.$element.removeClass('open');\n        }\n    };\n\n    // Inheritance\n    Kube.Message.inherits(Kube);\n\n    // Plugin\n    Kube.Plugin.create('Message');\n    Kube.Plugin.autoload('Message');\n\n}(Kube));\n/**\n * @library Kube Sticky\n * @author Imperavi LLC\n * @license MIT\n */\n(function(Kube)\n{\n    Kube.Sticky = function(element, options)\n    {\n        this.namespace = 'sticky';\n        this.defaults = {\n            classname: 'fixed',\n            offset: 0, // pixels\n            callbacks: ['fixed', 'unfixed']\n        };\n\n        // Parent Constructor\n        Kube.apply(this, arguments);\n\n        // Initialization\n        this.start();\n    };\n\n    // Functionality\n    Kube.Sticky.prototype = {\n        start: function()\n        {\n\t    this.offsetTop = this.getOffsetTop();\n\n\t    this.load();\n\t    $(window).scroll($.proxy(this.load, this));\n\t},\n\tgetOffsetTop: function()\n\t{\n\t\treturn this.$element.offset().top;\n\t},\n\tload: function()\n\t{\n\t\treturn (this.isFix()) ? this.fixed() : this.unfixed();\n\t},\n\tisFix: function()\n\t{\n            return ($(window).scrollTop() > (this.offsetTop + this.opts.offset));\n\t},\n\tfixed: function()\n\t{\n\t\tthis.$element.addClass(this.opts.classname).css('top', this.opts.offset + 'px');\n\t\tthis.callback('fixed');\n\t},\n\tunfixed: function()\n\t{\n\t\tthis.$element.removeClass(this.opts.classname).css('top', '');\n\t\tthis.callback('unfixed');\n        }\n    };\n\n    // Inheritance\n    Kube.Sticky.inherits(Kube);\n\n    // Plugin\n    Kube.Plugin.create('Sticky');\n    Kube.Plugin.autoload('Sticky');\n\n}(Kube));\n/**\n * @library Kube Toggleme\n * @author Imperavi LLC\n * @license MIT\n */\n(function(Kube)\n{\n    Kube.Toggleme = function(element, options)\n    {\n        this.namespace = 'toggleme';\n        this.defaults = {\n            toggleEvent: 'click',\n            target: null,\n            text: '',\n            animationOpen: 'slideDown',\n            animationClose: 'slideUp',\n            callbacks: ['open', 'opened', 'close', 'closed']\n        };\n\n        // Parent Constructor\n        Kube.apply(this, arguments);\n\n        // Initialization\n        this.start();\n    };\n\n    // Functionality\n    Kube.Toggleme.prototype = {\n        start: function()\n        {\n            if (!this.hasTarget()) return;\n\n            this.$element.on(this.opts.toggleEvent + '.' + this.namespace, $.proxy(this.toggle, this));\n        },\n        stop: function()\n        {\n            this.$element.off('.' + this.namespace);\n            this.revertText();\n        },\n        toggle: function(e)\n        {\n            if (this.isOpened()) this.close(e);\n            else                 this.open(e);\n        },\n        open: function(e)\n        {\n            if (e) e.preventDefault();\n\n            if (!this.isOpened())\n            {\n                this.storeText();\n                this.callback('open');\n                this.$target.animation('slideDown', $.proxy(this.onOpened, this));\n\n                // changes the text of $element with a less delay to smooth\n                setTimeout($.proxy(this.replaceText, this), 100);\n\t\t}\n        },\n        close: function(e)\n        {\n            if (e) e.preventDefault();\n\n            if (this.isOpened())\n            {\n                this.callback('close');\n                this.$target.animation('slideUp', $.proxy(this.onClosed, this));\n\t\t}\n        },\n\tisOpened: function()\n        {\n            return (this.$target.hasClass('open'));\n        },\n        onOpened: function()\n        {\n            this.$target.addClass('open');\n\t\tthis.callback('opened');\n        },\n        onClosed: function()\n        {\n            this.$target.removeClass('open');\n            this.revertText();\n\t\tthis.callback('closed');\n        },\n        storeText: function()\n        {\n            this.$element.data('replacement-text', this.$element.html());\n        },\n        revertText: function()\n        {\n            var text = this.$element.data('replacement-text');\n            if (text) this.$element.html(text);\n\n            this.$element.removeData('replacement-text');\n        },\n        replaceText: function()\n        {\n            if (this.opts.text !== '')\n            {\n                this.$element.html(this.opts.text);\n            }\n        }\n    };\n\n    // Inheritance\n    Kube.Toggleme.inherits(Kube);\n\n    // Plugin\n    Kube.Plugin.create('Toggleme');\n    Kube.Plugin.autoload('Toggleme');\n\n}(Kube));\n/**\n * @library Kube Offcanvas\n * @author Imperavi LLC\n * @license MIT\n */\n(function(Kube)\n{\n    Kube.Offcanvas = function(element, options)\n    {\n        this.namespace = 'offcanvas';\n        this.defaults = {\n\t\ttarget: null, // selector\n\t\tpush: true, // boolean\n\t\twidth: '250px', // string\n\t\tdirection: 'left', // string: left or right\n\t\ttoggleEvent: 'click',\n\t\tclickOutside: true, // boolean\n\t\tanimationOpen: 'slideInLeft',\n\t\tanimationClose: 'slideOutLeft',\n\t\tcallbacks: ['open', 'opened', 'close', 'closed']\n        };\n\n        // Parent Constructor\n        Kube.apply(this, arguments);\n\n        // Services\n        this.utils = new Kube.Utils();\n        this.detect = new Kube.Detect();\n\n        // Initialization\n        this.start();\n    };\n\n    // Functionality\n    Kube.Offcanvas.prototype = {\n        start: function()\n        {\n            if (!this.hasTarget()) return;\n\n            this.buildTargetWidth();\n            this.buildAnimationDirection();\n\n            this.$close = this.getCloseLink();\n            this.$element.on(this.opts.toggleEvent + '.' + this.namespace, $.proxy(this.toggle, this));\n            this.$target.addClass('offcanvas');\n\t},\n\tstop: function()\n\t{\n\t\tthis.closeAll();\n\n            this.$element.off('.' + this.namespace);\n            this.$close.off('.' + this.namespace);\n            $(document).off('.' + this.namespace);\n\t},\n\ttoggle: function(e)\n\t{\n\t\tif (this.isOpened()) this.close(e);\n\t\telse                 this.open(e);\n        },\n\tbuildTargetWidth: function()\n\t{\n            this.opts.width = ($(window).width() < parseInt(this.opts.width)) ? '100%' : this.opts.width;\n\t},\n\tbuildAnimationDirection: function()\n\t{\n            if (this.opts.direction === 'right')\n            {\n                this.opts.animationOpen = 'slideInRight';\n\t\t\tthis.opts.animationClose = 'slideOutRight';\n            }\n\t},\n\tgetCloseLink: function()\n\t{\n            return this.$target.find('.close');\n\t},\n\topen: function(e)\n\t{\n\t\tif (e) e.preventDefault();\n\n            if (!this.isOpened())\n            {\n                this.closeAll();\n\t\t\tthis.callback('open');\n\n                this.$target.addClass('offcanvas-' + this.opts.direction);\n                this.$target.css('width', this.opts.width);\n\n                this.pushBody();\n\n\t\t\tthis.$target.animation(this.opts.animationOpen, $.proxy(this.onOpened, this));\n\t\t}\n\t},\n\tcloseAll: function()\n\t{\n\t\tvar $elms = $(document).find('.offcanvas');\n\t\tif ($elms.length !== 0)\n\t\t{\n                $elms.each(function()\n                {\n                    var $el = $(this);\n\n                    if ($el.hasClass('open'))\n                    {\n                        $el.css('width', '').animation('hide');\n                        $el.removeClass('open offcanvas-left offcanvas-right');\n                    }\n\n                });\n\n                $(document).off('.' + this.namespace);\n                $('body').css('left', '');\n\t\t}\n\t},\n\tclose: function(e)\n\t{\n\t\tif (e)\n\t\t{\n\t\tvar $el = $(e.target);\n\t\tvar isTag = ($el[0].tagName === 'A' || $el[0].tagName === 'BUTTON');\n\t\tif (isTag && $el.closest('.offcanvas').length !== 0 && !$el.hasClass('close'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\te.preventDefault();\n            }\n\n            if (this.isOpened())\n\t\t{\n\t\t\tthis.utils.enableBodyScroll();\n\t\t\tthis.callback('close');\n                this.pullBody();\n\t\t\tthis.$target.animation(this.opts.animationClose, $.proxy(this.onClosed, this));\n\t\t}\n\t},\n\tisOpened: function()\n        {\n            return (this.$target.hasClass('open'));\n        },\n\tonOpened: function()\n\t{\n\t\tif (this.opts.clickOutside) $(document).on('click.' + this.namespace, $.proxy(this.close, this));\n\t\tif (this.detect.isMobileScreen()) $('html').addClass('no-scroll');\n\n            $(document).on('keyup.' + this.namespace, $.proxy(this.handleKeyboard, this));\n            this.$close.on('click.' + this.namespace, $.proxy(this.close, this));\n\n\t\tthis.utils.disableBodyScroll();\n            this.$target.addClass('open');\n            this.callback('opened');\n\t},\n\tonClosed: function()\n\t{\n\t\tif (this.detect.isMobileScreen()) $('html').removeClass('no-scroll');\n\n            this.$target.css('width', '').removeClass('offcanvas-' + this.opts.direction);\n\n            this.$close.off('.' + this.namespace);\n\t\t$(document).off('.' + this.namespace);\n\n            this.$target.removeClass('open');\n\t\tthis.callback('closed');\n\t},\n\thandleKeyboard: function(e)\n\t{\n\t\tif (e.which === 27) this.close();\n\t},\n\tpullBody: function()\n\t{\n            if (this.opts.push)\n            {\n                $('body').animate({ left: 0 }, 350, function() { $(this).removeClass('offcanvas-push-body'); });\n            }\n\t},\n\tpushBody: function()\n\t{\n            if (this.opts.push)\n            {\n                var properties = (this.opts.direction === 'left') ? { 'left': this.opts.width } : { 'left': '-' + this.opts.width };\n                $('body').addClass('offcanvas-push-body').animate(properties, 200);\n            }\n\t}\n    };\n\n    // Inheritance\n    Kube.Offcanvas.inherits(Kube);\n\n    // Plugin\n    Kube.Plugin.create('Offcanvas');\n    Kube.Plugin.autoload('Offcanvas');\n\n}(Kube));\n/**\n * @library Kube Collapse\n * @author Imperavi LLC\n * @license MIT\n */\n(function(Kube)\n{\n    Kube.Collapse = function(element, options)\n    {\n        this.namespace = 'collapse';\n        this.defaults = {\n            target: null,\n            toggle: true,\n            active: false, // string (hash = tab id selector)\n            toggleClass: 'collapse-toggle',\n            boxClass: 'collapse-box',\n            callbacks: ['open', 'opened', 'close', 'closed'],\n\n            // private\n            hashes: [],\n\t\tcurrentHash: false,\n\t\tcurrentItem: false\n        };\n\n        // Parent Constructor\n        Kube.apply(this, arguments);\n\n        // Initialization\n        this.start();\n    };\n\n    // Functionality\n    Kube.Collapse.prototype = {\n        start: function()\n        {\n            // items\n            this.$items = this.getItems();\n            this.$items.each($.proxy(this.loadItems, this));\n\n            // boxes\n            this.$boxes = this.getBoxes();\n\n            // active\n            this.setActiveItem();\n        },\n        getItems: function()\n        {\n            return this.$element.find('.' + this.opts.toggleClass);\n        },\n        getBoxes: function()\n        {\n            return this.$element.find('.' + this.opts.boxClass);\n        },\n\tloadItems: function(i, el)\n\t{\n\t\tvar item = this.getItem(el);\n\n\t\t// set item identificator\n\t\titem.$el.attr('rel', item.hash);\n\n            // active\n\t\tif (!$(item.hash).hasClass('hide'))\n\t\t{\n\t\t\tthis.opts.currentItem = item;\n\t\t\tthis.opts.active = item.hash;\n\n                item.$el.addClass('active');\n            }\n\n\t\t// event\n\t\titem.$el.on('click.collapse', $.proxy(this.toggle, this));\n\n\t},\n\tsetActiveItem: function()\n\t{\n\t\tif (this.opts.active !== false)\n\t\t{\n\t\t\tthis.opts.currentItem = this.getItemBy(this.opts.active);\n\t\t\tthis.opts.active = this.opts.currentItem.hash;\n\t\t}\n\n            if (this.opts.currentItem !== false)\n            {\n\t\t    this.addActive(this.opts.currentItem);\n\t\t    this.opts.currentItem.$box.removeClass('hide');\n\t\t}\n\t},\n\taddActive: function(item)\n\t{\n\t\titem.$box.removeClass('hide').addClass('open');\n\t\titem.$el.addClass('active');\n\n\t\tif (item.$caret !== false) item.$caret.removeClass('down').addClass('up');\n\t\tif (item.$parent !== false) item.$parent.addClass('active');\n\n\t\tthis.opts.currentItem = item;\n\t},\n\tremoveActive: function(item)\n\t{\n\t\titem.$box.removeClass('open');\n\t\titem.$el.removeClass('active');\n\n\t\tif (item.$caret !== false) item.$caret.addClass('down').removeClass('up');\n\t\tif (item.$parent !== false) item.$parent.removeClass('active');\n\n\t\tthis.opts.currentItem = false;\n\t},\n        toggle: function(e)\n        {\n            if (e) e.preventDefault();\n\n            var target = $(e.target).closest('.' + this.opts.toggleClass).get(0) || e.target;\n            var item = this.getItem(target);\n\n            if (this.isOpened(item.hash)) this.close(item.hash);\n            else                          this.open(e)\n        },\n        openAll: function()\n        {\n            this.$items.addClass('active');\n            this.$boxes.addClass('open').removeClass('hide');\n        },\n        open: function(e, push)\n        {\n\t\tif (typeof e === 'undefined') return;\n\t\tif (typeof e === 'object') e.preventDefault();\n\n            var target = $(e.target).closest('.' + this.opts.toggleClass).get(0) || e.target;\n\t\tvar item = (typeof e === 'object') ? this.getItem(target) : this.getItemBy(e);\n\n\t\tif (item.$box.hasClass('open'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.opts.toggle) this.closeAll();\n\n\t\tthis.callback('open', item);\n\t\tthis.addActive(item);\n\n            item.$box.animation('slideDown', $.proxy(this.onOpened, this));\n        },\n        onOpened: function()\n        {\n\t\tthis.callback('opened', this.opts.currentItem);\n        },\n        closeAll: function()\n        {\n            this.$items.removeClass('active').closest('li').removeClass('active');\n            this.$boxes.removeClass('open').addClass('hide');\n        },\n        close: function(num)\n        {\n\t\tvar item = this.getItemBy(num);\n\n\t\tthis.callback('close', item);\n\n\t\tthis.opts.currentItem = item;\n\n\t\titem.$box.animation('slideUp', $.proxy(this.onClosed, this));\n        },\n        onClosed: function()\n        {\n            var item = this.opts.currentItem;\n\n\t\tthis.removeActive(item);\n\t\tthis.callback('closed', item);\n        },\n        isOpened: function(hash)\n        {\n            return $(hash).hasClass('open');\n        },\n\tgetItem: function(element)\n\t{\n\t\tvar item = {};\n\n\t\titem.$el = $(element);\n\t\titem.hash = item.$el.attr('href');\n\t\titem.$box = $(item.hash);\n\n\t\tvar $parent = item.$el.parent();\n\t\titem.$parent = ($parent[0].tagName === 'LI') ? $parent : false;\n\n\t\tvar $caret = item.$el.find('.caret');\n\t\titem.$caret = ($caret.length !== 0) ? $caret : false;\n\n\t\treturn item;\n\t},\n\tgetItemBy: function(num)\n\t{\n\t\tvar element = (typeof num === 'number') ? this.$items.eq(num-1) : this.$element.find('[rel=\"' + num + '\"]');\n\n\t\treturn this.getItem(element);\n        }\n    };\n\n    // Inheritance\n    Kube.Collapse.inherits(Kube);\n\n    // Plugin\n    Kube.Plugin.create('Collapse');\n    Kube.Plugin.autoload('Collapse');\n\n}(Kube));\n/**\n * @library Kube Dropdown\n * @author Imperavi LLC\n * @license MIT\n */\n(function(Kube)\n{\n    Kube.Dropdown = function(element, options)\n    {\n        this.namespace = 'dropdown';\n        this.defaults = {\n\t\ttarget: null,\n\t\ttoggleEvent: 'click',\n\t\theight: false, // integer\n\t\twidth: false, // integer\n\t\tanimationOpen: 'slideDown',\n\t\tanimationClose: 'slideUp',\n\t\tcaretUp: false,\n            callbacks: ['open', 'opened', 'close', 'closed']\n        };\n\n        // Parent Constructor\n        Kube.apply(this, arguments);\n\n        // Services\n        this.utils = new Kube.Utils();\n        this.detect = new Kube.Detect();\n\n        // Initialization\n        this.start();\n    };\n\n    // Functionality\n    Kube.Dropdown.prototype = {\n        start: function()\n        {\n            this.buildClose();\n            this.buildCaret();\n\n            if (this.detect.isMobile()) this.buildMobileAnimation();\n\n            this.$target.addClass('hide');\n            this.$element.on(this.opts.toggleEvent + '.' + this.namespace, $.proxy(this.toggle, this));\n\n\t},\n\tstop: function()\n\t{\n\t\tthis.$element.off('.' + this.namespace);\n            this.$target.removeClass('open').addClass('hide');\n\t\tthis.disableEvents();\n\t},\n\tbuildMobileAnimation: function()\n\t{\n            this.opts.animationOpen = 'fadeIn';\n            this.opts.animationClose = 'fadeOut';\n\t},\n\tbuildClose: function()\n\t{\n            this.$close = this.$target.find('.close');\n\t},\n\tbuildCaret: function()\n\t{\n            this.$caret = this.getCaret();\n\t\tthis.buildCaretPosition();\n\t},\n\tbuildCaretPosition: function()\n\t{\n\t\tvar height = this.$element.offset().top + this.$element.innerHeight() + this.$target.innerHeight();\n\n\t\tif ($(document).height() > height)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n            this.opts.caretUp = true;\n\t\tthis.$caret.addClass('up');\n\t},\n\tgetCaret: function()\n\t{\n\t\treturn this.$element.find('.caret');\n\t},\n\ttoggleCaretOpen: function()\n\t{\n\t\tif (this.opts.caretUp) this.$caret.removeClass('up').addClass('down');\n\t\telse                   this.$caret.removeClass('down').addClass('up');\n\t},\n\ttoggleCaretClose: function()\n\t{\n\t\tif (this.opts.caretUp) this.$caret.removeClass('down').addClass('up');\n\t\telse                   this.$caret.removeClass('up').addClass('down');\n\t},\n\ttoggle: function(e)\n\t{\n\t\tif (this.isOpened()) this.close(e);\n\t\telse                 this.open(e);\n\t},\n\topen: function(e)\n\t{\n\t\tif (e) e.preventDefault();\n\n            this.callback('open');\n\t\t$('.dropdown').removeClass('open').addClass('hide');\n\n\t\tif (this.opts.height) this.$target.css('min-height', this.opts.height + 'px');\n\t\tif (this.opts.width)  this.$target.width(this.opts.width);\n\n\t\tthis.setPosition();\n\t\tthis.toggleCaretOpen();\n\n\t\tthis.$target.animation(this.opts.animationOpen, $.proxy(this.onOpened, this));\n\t},\n\tclose: function(e)\n\t{\n            if (!this.isOpened())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (e)\n\t\t{\n\t\t\tif (this.shouldNotBeClosed(e.target))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\te.preventDefault();\n\t\t}\n\n\t\tthis.utils.enableBodyScroll();\n\t\tthis.callback('close');\n\t\tthis.toggleCaretClose();\n\n\t\tthis.$target.animation(this.opts.animationClose, $.proxy(this.onClosed, this));\n\t},\n\tonClosed: function()\n\t{\n            this.$target.removeClass('open');\n\t\tthis.disableEvents();\n\t\tthis.callback('closed');\n\t},\n\tonOpened: function()\n\t{\n\t\tthis.$target.addClass('open');\n\t\tthis.enableEvents();\n\t\tthis.callback('opened');\n\t},\n\tisOpened: function()\n\t{\n\t\treturn (this.$target.hasClass('open'));\n\t},\n\tenableEvents: function()\n\t{\n\t\tif (this.detect.isDesktop())\n\t\t{\n\t\t\tthis.$target.on('mouseover.' + this.namespace, $.proxy(this.utils.disableBodyScroll, this.utils))\n\t\t\t            .on('mouseout.' + this.namespace,  $.proxy(this.utils.enableBodyScroll, this.utils));\n\t\t}\n\n\t\t$(document).on('scroll.' + this.namespace, $.proxy(this.setPosition, this));\n\t\t$(window).on('resize.' + this.namespace, $.proxy(this.setPosition, this));\n\t\t$(document).on('click.' + this.namespace + ' touchstart.' + this.namespace, $.proxy(this.close, this));\n\t\t$(document).on('keydown.' + this.namespace, $.proxy(this.handleKeyboard, this));\n\t\tthis.$target.find('[data-action=\"dropdown-close\"]').on('click.' + this.namespace, $.proxy(this.close, this));\n\t},\n\tdisableEvents: function()\n\t{\n\t\tthis.$target.off('.' + this.namespace);\n\t\t$(document).off('.' + this.namespace);\n\t\t$(window).off('.' + this.namespace);\n\t},\n\thandleKeyboard: function(e)\n\t{\n\t\tif (e.which === 27) this.close(e);\n\t},\n\tshouldNotBeClosed: function(el)\n\t{\n            if ($(el).attr('data-action') === 'dropdown-close' || el === this.$close[0])\n            {\n                return false;\n\t\t}\n\t\telse if ($(el).closest('.dropdown').length === 0)\n\t\t{\n\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t},\n        isNavigationFixed: function()\n\t{\n\t\treturn (this.$element.closest('.fixed').length !== 0);\n\t},\n\tgetPlacement: function(height)\n\t{\n\t\treturn ($(document).height() < height) ? 'top' : 'bottom';\n\t},\n\tgetOffset: function(position)\n\t{\n\t\treturn (this.isNavigationFixed()) ? this.$element.position() : this.$element.offset();\n\t},\n\tgetPosition: function()\n\t{\n\t\treturn (this.isNavigationFixed()) ? 'fixed' : 'absolute';\n\t},\n\tsetPosition: function()\n\t{\n\t\tif (this.detect.isMobile())\n\t\t{\n                this.$target.addClass('dropdown-mobile');\n                return;\n\t\t}\n\n\t\tvar position = this.getPosition();\n\t\t\tvar coords = this.getOffset(position);\n\t\t\tvar height = this.$target.innerHeight();\n\t\t\tvar width = this.$target.innerWidth();\n\t\t\tvar placement = this.getPlacement(coords.top + height + this.$element.innerHeight());\n\t\t\tvar leftFix = ($(window).width() < (coords.left + width)) ? (width - this.$element.innerWidth()) : 0;\n\t\t\tvar top, left = coords.left - leftFix;\n\n\t\t\tif (placement === 'bottom')\n\t\t\t{\n\t\t\tif (!this.isOpened()) this.$caret.removeClass('up').addClass('down');\n\n\t\t\t\tthis.opts.caretUp = false;\n\t\t\t\ttop = coords.top + this.$element.outerHeight() + 1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.opts.animationOpen = 'show';\n\t\t\t\tthis.opts.animationClose = 'hide';\n\n                if (!this.isOpened()) this.$caret.addClass('up').removeClass('down');\n\n\t\t\t\tthis.opts.caretUp = true;\n\t\t\t\ttop = coords.top - height - 1;\n\t\t\t}\n\n\t\t\tthis.$target.css({ position: position, top: top + 'px', left: left + 'px' });\n\t}\n    };\n\n    // Inheritance\n    Kube.Dropdown.inherits(Kube);\n\n    // Plugin\n    Kube.Plugin.create('Dropdown');\n    Kube.Plugin.autoload('Dropdown');\n\n}(Kube));\n/**\n * @library Kube Tabs\n * @author Imperavi LLC\n * @license MIT\n */\n(function(Kube)\n{\n    Kube.Tabs = function(element, options)\n    {\n        this.namespace = 'tabs';\n        this.defaults = {\n\t\tequals: false,\n\t\tactive: false, // string (hash = tab id selector)\n\t\tlive: false, // class selector\n\t\thash: true, //boolean\n\t\tcallbacks: ['init', 'next', 'prev', 'open', 'opened', 'close', 'closed']\n        };\n\n        // Parent Constructor\n        Kube.apply(this, arguments);\n\n        // Initialization\n        this.start();\n    };\n\n    // Functionality\n    Kube.Tabs.prototype = {\n        start: function()\n        {\n            if (this.opts.live !== false) this.buildLiveTabs();\n\n            this.tabsCollection = [];\n            this.hashesCollection = [];\n            this.currentHash = [];\n            this.currentItem = false;\n\n            // items\n            this.$items = this.getItems();\n            this.$items.each($.proxy(this.loadItems, this));\n\n            // tabs\n\t\tthis.$tabs = this.getTabs();\n\n            // location hash\n\t\tthis.currentHash = this.getLocationHash();\n\n\t\t// close all\n\t\tthis.closeAll();\n\n            // active & height\n\t\tthis.setActiveItem();\n\t\tthis.setItemHeight();\n\n            // callback\n\t\tthis.callback('init');\n\n\t},\n\tgetTabs: function()\n\t{\n\t\treturn $(this.tabsCollection).map(function()\n\t\t{\n\t\treturn this.toArray();\n            });\n\t},\n\tgetItems: function()\n\t{\n\t\treturn this.$element.find('a');\n\t},\n\tloadItems: function(i, el)\n\t{\n\t\tvar item = this.getItem(el);\n\n\t\t// set item identificator\n\t\titem.$el.attr('rel', item.hash);\n\n\t\t// collect item\n            this.collectItem(item);\n\n            // active\n\t\tif (item.$parent.hasClass('active'))\n\t\t{\n\t\t\tthis.currentItem = item;\n\t\t\tthis.opts.active = item.hash;\n\t\t}\n\n\t\t// event\n\t\titem.$el.on('click.tabs', $.proxy(this.open, this));\n\n\t},\n\tcollectItem: function(item)\n\t{\n\t\tthis.tabsCollection.push(item.$tab);\n\t\tthis.hashesCollection.push(item.hash);\n\t},\n\tbuildLiveTabs: function()\n\t{\n\t\tvar $layers = $(this.opts.live);\n\n\t\tif ($layers.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.$liveTabsList = $('<ul />');\n\t\t$layers.each($.proxy(this.buildLiveItem, this));\n\n\t\tthis.$element.html('').append(this.$liveTabsList);\n\n\t},\n\tbuildLiveItem: function(i, tab)\n\t{\n\t\tvar $tab = $(tab);\n\t\tvar $li = $('<li />');\n\t\tvar $a = $('<a />');\n\t\tvar index = i + 1;\n\n\t\t$tab.attr('id', this.getLiveItemId($tab, index));\n\n\t\tvar hash = '#' + $tab.attr('id');\n\t\tvar title = this.getLiveItemTitle($tab);\n\n\t\t$a.attr('href', hash).attr('rel', hash).text(title);\n\t\t$li.append($a);\n\n\t\tthis.$liveTabsList.append($li);\n\t},\n\tgetLiveItemId: function($tab, index)\n\t{\n\t\treturn (typeof $tab.attr('id') === 'undefined') ? this.opts.live.replace('.', '') + index : $tab.attr('id');\n\t},\n\tgetLiveItemTitle: function($tab)\n\t{\n\t\treturn (typeof $tab.attr('data-title') === 'undefined') ? $tab.attr('id') : $tab.attr('data-title');\n\t},\n\tsetActiveItem: function()\n\t{\n\t\tif (this.currentHash)\n\t\t{\n\t\t\tthis.currentItem = this.getItemBy(this.currentHash);\n\t\t\tthis.opts.active = this.currentHash;\n\t\t}\n\t\telse if (this.opts.active === false)\n\t\t{\n\t\t\tthis.currentItem = this.getItem(this.$items.first());\n\t\t\tthis.opts.active = this.currentItem.hash;\n\t\t}\n\n\t\tthis.addActive(this.currentItem);\n\t},\n\taddActive: function(item)\n\t{\n\t\titem.$parent.addClass('active');\n\t\titem.$tab.removeClass('hide').addClass('open');\n\n\t\tthis.currentItem = item;\n\t},\n\tremoveActive: function(item)\n\t{\n\t\titem.$parent.removeClass('active');\n\t\titem.$tab.addClass('hide').removeClass('open');\n\n\t\tthis.currentItem = false;\n\t},\n\tnext: function(e)\n\t{\n\t\tif (e) e.preventDefault();\n\n\t\tvar item = this.getItem(this.fetchElement('next'));\n\n\t\tthis.open(item.hash);\n\t\tthis.callback('next', item);\n\n\t},\n\tprev: function(e)\n\t{\n\t\tif (e) e.preventDefault();\n\n\t\tvar item = this.getItem(this.fetchElement('prev'));\n\n\t\tthis.open(item.hash);\n\t\tthis.callback('prev', item);\n\t},\n\tfetchElement: function(type)\n\t{\n            var element;\n\t\tif (this.currentItem !== false)\n\t\t{\n\t\t\t// prev or next\n\t\t\telement = this.currentItem.$parent[type]().find('a');\n\n\t\t\tif (element.length === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// first\n\t\t\telement = this.$items[0];\n\t\t}\n\n\t\treturn element;\n\t},\n\topen: function(e, push)\n\t{\n\t\tif (typeof e === 'undefined') return;\n\t\tif (typeof e === 'object') e.preventDefault();\n\n\t\tvar item = (typeof e === 'object') ? this.getItem(e.target) : this.getItemBy(e);\n\t\tthis.closeAll();\n\n\t\tthis.callback('open', item);\n\t\tthis.addActive(item);\n\n\t\t// push state (doesn't need to push at the start)\n            this.pushStateOpen(push, item);\n\t\tthis.callback('opened', item);\n\t},\n\tpushStateOpen: function(push, item)\n\t{\n\t\tif (push !== false && this.opts.hash !== false)\n\t\t{\n\t\t\thistory.pushState(false, false, item.hash);\n\t\t}\n\t},\n\tclose: function(num)\n\t{\n\t\tvar item = this.getItemBy(num);\n\n\t\tif (!item.$parent.hasClass('active'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.callback('close', item);\n\t\tthis.removeActive(item);\n\t\tthis.pushStateClose();\n\t\tthis.callback('closed', item);\n\n\t},\n\tpushStateClose: function()\n\t{\n            if (this.opts.hash !== false)\n            {\n\t\t\thistory.pushState(false, false, ' ');\n\t\t}\n\t},\n\tcloseAll: function()\n\t{\n\t\tthis.$tabs.removeClass('open').addClass('hide');\n\t\tthis.$items.parent().removeClass('active');\n\t},\n\tgetItem: function(element)\n\t{\n\t\tvar item = {};\n\n\t\titem.$el = $(element);\n\t\titem.hash = item.$el.attr('href');\n\t\titem.$parent = item.$el.parent();\n\t\titem.$tab = $(item.hash);\n\n\t\treturn item;\n\t},\n\tgetItemBy: function(num)\n\t{\n\t\tvar element = (typeof num === 'number') ? this.$items.eq(num-1) : this.$element.find('[rel=\"' + num + '\"]');\n\n\t\treturn this.getItem(element);\n\t},\n\tgetLocationHash: function()\n\t{\n\t\tif (this.opts.hash === false)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn (this.isHash()) ? top.location.hash : false;\n\t},\n\tisHash: function()\n\t{\n\t\treturn !(top.location.hash === '' || $.inArray(top.location.hash, this.hashesCollection) === -1);\n\t},\n\tsetItemHeight: function()\n\t{\n\t\tif (this.opts.equals)\n\t\t{\n\t\tvar minHeight = this.getItemMaxHeight() + 'px';\n\t\t\tthis.$tabs.css('min-height', minHeight);\n\t\t}\n\t},\n\tgetItemMaxHeight: function()\n\t{\n\t\tvar max = 0;\n\t\tthis.$tabs.each(function()\n\t\t{\n\t\t\tvar h = $(this).height();\n\t\t\tmax = h > max ? h : max;\n\t\t});\n\n\t\treturn max;\n\t}\n    };\n\n    // Inheritance\n    Kube.Tabs.inherits(Kube);\n\n    // Plugin\n    Kube.Plugin.create('Tabs');\n    Kube.Plugin.autoload('Tabs');\n\n}(Kube));\n/**\n * @library Kube Modal\n * @author Imperavi LLC\n * @license MIT\n */\n(function($)\n{\n    $.modalcurrent = null;\n\t$.modalwindow = function(options)\n\t{\n\tvar opts = $.extend({}, options, { show: true });\n\tvar $element = $('<span />');\n\n\t$element.modal(opts);\n\t};\n\n})(jQuery);\n\n(function(Kube)\n{\n    Kube.Modal = function(element, options)\n    {\n        this.namespace = 'modal';\n        this.defaults = {\n            target: null,\n            show: false,\n\t\turl: false,\n\t\theader: false,\n\t\twidth: '600px', // string\n\t\theight: false, // or string\n\t\tmaxHeight: false,\n\t\tposition: 'center', // top or center\n\t\toverlay: true,\n\t\tappendForms: false,\n\t\tappendFields: false,\n\t\tanimationOpen: 'show',\n\t\tanimationClose: 'hide',\n\t\tcallbacks: ['open', 'opened', 'close', 'closed']\n        };\n\n        // Parent Constructor\n        Kube.apply(this, arguments);\n\n        // Services\n        this.utils = new Kube.Utils();\n        this.detect = new Kube.Detect();\n\n        // Initialization\n        this.start();\n    };\n\n    // Functionality\n    Kube.Modal.prototype = {\n        start: function()\n        {\n            if (!this.hasTarget())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n            if (this.opts.show) this.load();\n\t\telse this.$element.on('click.' + this.namespace, $.proxy(this.load, this));\n\t},\n\tbuildModal: function()\n\t{\n\t\tthis.$modal = this.$target.find('.modal');\n\t\tthis.$header = this.$target.find('.modal-header');\n\t\tthis.$close = this.$target.find('.close');\n\t\tthis.$body = this.$target.find('.modal-body');\n\t},\n\tbuildOverlay: function()\n\t{\n\t\tif (this.opts.overlay === false)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif ($('#modal-overlay').length !== 0)\n\t\t{\n\t\t\tthis.$overlay = $('#modal-overlay');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.$overlay = $('<div id=\"modal-overlay\">').addClass('hide');\n\t\t\t$('body').prepend(this.$overlay);\n\t\t}\n\n\t\tthis.$overlay.addClass('overlay');\n\t},\n\tbuildHeader: function()\n\t{\n\t\tif (this.opts.header) this.$header.html(this.opts.header);\n\t},\n\tload: function(e)\n\t{\n\t\tthis.buildModal();\n\t\tthis.buildOverlay();\n\t\tthis.buildHeader();\n\n            if (this.opts.url) this.buildContent();\n            else               this.open(e);\n\t},\n\topen: function(e)\n\t{\n\t\tif (e) e.preventDefault();\n\n            if (this.isOpened())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.detect.isMobile()) this.opts.width = '96%';\n\t\tif (this.opts.overlay)      this.$overlay.removeClass('hide');\n\n\t\tthis.$target.removeClass('hide');\n\t\tthis.$modal.removeClass('hide');\n\n            this.enableEvents();\n\t\tthis.findActions();\n\n\t\tthis.resize();\n\t\t$(window).on('resize.' + this.namespace, $.proxy(this.resize, this));\n\n\t\tif (this.detect.isDesktop()) this.utils.disableBodyScroll();\n\n\t\t// enter\n\t\tthis.$modal.find('input[type=text],input[type=url],input[type=email]').on('keydown.' + this.namespace, $.proxy(this.handleEnter, this));\n\n\t\tthis.callback('open');\n\t\tthis.$modal.animation(this.opts.animationOpen, $.proxy(this.onOpened, this));\n        },\n        close: function(e)\n        {\n            if (!this.$modal || !this.isOpened())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (e)\n\t\t{\n\t\t\tif (this.shouldNotBeClosed(e.target))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\te.preventDefault();\n\t\t}\n\n\t\tthis.callback('close');\n\t\tthis.disableEvents();\n\n\t\tthis.$modal.animation(this.opts.animationClose, $.proxy(this.onClosed, this));\n\n            if (this.opts.overlay) this.$overlay.animation(this.opts.animationClose);\n        },\n\tonOpened: function()\n\t{\n\t\tthis.$modal.addClass('open');\n            this.callback('opened');\n\n            $.modalcurrent = this;\n\t},\n\tonClosed: function()\n\t{\n\t\tthis.callback('closed');\n\n            this.$target.addClass('hide');\n            this.$modal.removeClass('open');\n\n\t\tif (this.detect.isDesktop()) this.utils.enableBodyScroll();\n\n\t\tthis.$body.css('height', '');\n            $.modalcurrent = null;\n\t},\n\tisOpened: function()\n\t{\n\t\treturn (this.$modal.hasClass('open'));\n\t},\n\tgetData: function()\n\t{\n            var formdata = new Kube.FormData(this);\n            formdata.set('');\n\n            return formdata.get();\n\t},\n\tbuildContent: function()\n\t{\n\t\t$.ajax({\n\t\t\turl: this.opts.url + '?' + new Date().getTime(),\n\t\t\tcache: false,\n\t\t\ttype: 'post',\n\t\t\tdata: this.getData(),\n\t\t\tsuccess: $.proxy(function(data)\n\t\t\t{\n\t\t\t\tthis.$body.html(data);\n\t\t\t\tthis.open();\n\n\t\t\t}, this)\n\t\t});\n\t},\n\tbuildWidth: function()\n\t{\n\t\tvar width = this.opts.width;\n\t\tvar top = '2%';\n\t\tvar bottom = '2%';\n\t\tvar percent = width.match(/%$/);\n\n\t\tif ((parseInt(this.opts.width) > $(window).width()) && !percent)\n\t\t{\n                width = '96%';\n\t\t}\n\t\telse if (!percent)\n\t\t{\n                top = '16px';\n                bottom = '16px';\n\t\t}\n\n\t\tthis.$modal.css({ 'width': width, 'margin-top': top, 'margin-bottom': bottom });\n\n\t},\n\tbuildPosition: function()\n\t{\n\t\tif (this.opts.position !== 'center')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tvar windowHeight = $(window).height();\n\t\tvar height = this.$modal.outerHeight();\n\t\tvar top = (windowHeight/2 - height/2) + 'px';\n\n\t\tif (this.detect.isMobile())     top = '2%';\n\t\telse if (height > windowHeight) top = '16px';\n\n\t\tthis.$modal.css('margin-top', top);\n\t},\n\tbuildHeight: function()\n\t{\n\t\tvar windowHeight = $(window).height();\n\n\t\tif (this.opts.maxHeight)\n\t\t{\n\t\t\tvar padding = parseInt(this.$body.css('padding-top')) + parseInt(this.$body.css('padding-bottom'));\n\t\t\tvar margin = parseInt(this.$modal.css('margin-top')) + parseInt(this.$modal.css('margin-bottom'));\n\t\t\tvar height = windowHeight - this.$header.innerHeight() - padding - margin;\n\n\t\t\tthis.$body.height(height);\n\t\t}\n\t\telse if (this.opts.height !== false)\n\t\t{\n\t\t\tthis.$body.css('height', this.opts.height);\n\t\t}\n\n\t\tvar modalHeight = this.$modal.outerHeight();\n\t\tif (modalHeight > windowHeight)\n\t\t{\n\t\t\tthis.opts.animationOpen = 'show';\n\t\t\tthis.opts.animationClose = 'hide';\n\t\t}\n\t},\n\tresize: function()\n\t{\n\t\tthis.buildWidth();\n\t\tthis.buildPosition();\n\t\tthis.buildHeight();\n\t},\n\tenableEvents: function()\n\t{\n\t\tthis.$close.on('click.' + this.namespace, $.proxy(this.close, this));\n\t\t$(document).on('keyup.' + this.namespace, $.proxy(this.handleEscape, this));\n\t\tthis.$target.on('click.' + this.namespace, $.proxy(this.close, this));\n\t},\n\tdisableEvents: function()\n\t{\n\t\tthis.$close.off('.' + this.namespace);\n\t\t$(document).off('.' + this.namespace);\n\t\tthis.$target.off('.' + this.namespace);\n\t\t$(window).off('.' + this.namespace);\n\t},\n\tfindActions: function()\n\t{\n\t\tthis.$body.find('[data-action=\"modal-close\"]').on('mousedown.' + this.namespace, $.proxy(this.close, this));\n\t},\n\tsetHeader: function(header)\n\t{\n\t\tthis.$header.html(header);\n\t},\n\tsetContent: function(content)\n\t{\n\t\tthis.$body.html(content);\n\t},\n\tsetWidth: function(width)\n\t{\n\t\tthis.opts.width = width;\n\t\tthis.resize();\n\t},\n\tgetModal: function()\n\t{\n            return this.$modal;\n\t},\n\tgetBody: function()\n\t{\n            return this.$body;\n\t},\n\tgetHeader: function()\n\t{\n            return this.$header;\n\t},\n\thandleEnter: function(e)\n\t{\n\t\tif (e.which === 13)\n\t\t{\n\t\te.preventDefault();\n\t\tthis.close(false);\n            }\n\t},\n\thandleEscape: function(e)\n\t{\n\t\treturn (e.which === 27) ? this.close(false) : true;\n\t},\n\tshouldNotBeClosed: function(el)\n\t{\n            if ($(el).attr('data-action') === 'modal-close' || el === this.$close[0])\n            {\n                return false;\n\t\t}\n\t\telse if ($(el).closest('.modal').length === 0)\n\t\t{\n\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n    };\n\n    // Inheritance\n    Kube.Modal.inherits(Kube);\n\n    // Plugin\n    Kube.Plugin.create('Modal');\n    Kube.Plugin.autoload('Modal');\n\n}(Kube));","(function(root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define(['d3'], factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory(require('d3'));\n  } else {\n    root.MG = factory(root.d3);\n  }\n}(this, function(d3) {\n(typeof window === 'undefined' ? global : window).MG = {version: '2.11'};\n\n//a set of helper functions, some that we've written, others that we've borrowed\n\nMG.convert = {};\n\nMG.convert.date = function(data, accessor, time_format) {\n  time_format = (typeof time_format === \"undefined\") ? '%Y-%m-%d' : time_format;\n  var parse_time = d3.timeParse(time_format);\n  data = data.map(function(d) {\n    d[accessor] = parse_time(d[accessor].trim());\n    return d;\n  });\n\n  return data;\n}\n\nMG.convert.number = function(data, accessor) {\n  data = data.map(function(d) {\n    d[accessor] = Number(d[accessor]);\n    return d;\n  });\n\n  return data;\n}\n\nMG.time_format = function(utc, specifier) {\n  return utc ? d3.utcFormat(specifier) : d3.timeFormat(specifier);\n}\n\nfunction mg_jquery_exists() {\n  if (typeof jQuery !== 'undefined' || typeof $ !== 'undefined') {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nfunction mg_get_rollover_time_format(args) {\n  var fmt;\n  switch (args.processed.x_time_frame) {\n    case 'millis':\n      fmt = MG.time_format(args.utc_time, '%b %e, %Y  %H:%M:%S.%L');\n      break;\n    case 'seconds':\n      fmt = MG.time_format(args.utc_time, '%b %e, %Y  %H:%M:%S');\n      break;\n    case 'less-than-a-day':\n      fmt = MG.time_format(args.utc_time, '%b %e, %Y  %I:%M%p');\n      break;\n    case 'four-days':\n      fmt = MG.time_format(args.utc_time, '%b %e, %Y  %I:%M%p');\n      break;\n    default:\n      fmt = MG.time_format(args.utc_time, '%b %e, %Y');\n  }\n  return fmt;\n}\n\nfunction mg_data_in_plot_bounds(datum, args) {\n  return datum[args.x_accessor] >= args.processed.min_x &&\n    datum[args.x_accessor] <= args.processed.max_x &&\n    datum[args.y_accessor] >= args.processed.min_y &&\n    datum[args.y_accessor] <= args.processed.max_y;\n}\n\nfunction is_array(thing) {\n  return Object.prototype.toString.call(thing) === '[object Array]';\n}\n\nfunction is_function(thing) {\n  return Object.prototype.toString.call(thing) === '[object Function]';\n}\n\nfunction is_empty_array(thing) {\n  return is_array(thing) && thing.length === 0;\n}\n\nfunction is_object(thing) {\n  return Object.prototype.toString.call(thing) === '[object Object]';\n}\n\nfunction is_array_of_arrays(data) {\n  var all_elements = data.map(function(d) {\n    return is_array(d) === true && d.length > 0;\n  });\n\n  return d3.sum(all_elements) === data.length;\n}\n\nfunction is_array_of_objects(data) {\n  // is every element of data an object?\n  var all_elements = data.map(function(d) {\n    return is_object(d) === true;\n  });\n\n  return d3.sum(all_elements) === data.length;\n}\n\nfunction is_array_of_objects_or_empty(data) {\n  return is_empty_array(data) || is_array_of_objects(data);\n}\n\nfunction pluck(arr, accessor) {\n  return arr.map(function(d) {\n    return d[accessor] });\n}\n\nfunction count_array_elements(arr) {\n  return arr.reduce(function(a, b) { a[b] = a[b] + 1 || 1;\n    return a; }, {});\n}\n\nfunction mg_get_bottom(args) {\n  return args.height - args.bottom;\n}\n\nfunction mg_get_plot_bottom(args) {\n  // returns the pixel location of the bottom side of the plot area.\n  return mg_get_bottom(args) - args.buffer;\n}\n\nfunction mg_get_top(args) {\n  return args.top;\n}\n\nfunction mg_get_plot_top(args) {\n  // returns the pixel location of the top side of the plot area.\n  return mg_get_top(args) + args.buffer;\n}\n\nfunction mg_get_left(args) {\n  return args.left;\n}\n\nfunction mg_get_plot_left(args) {\n  // returns the pixel location of the left side of the plot area.\n  return mg_get_left(args) + args.buffer;\n}\n\nfunction mg_get_right(args) {\n  return args.width - args.right;\n}\n\nfunction mg_get_plot_right(args) {\n  // returns the pixel location of the right side of the plot area.\n  return mg_get_right(args) - args.buffer;\n}\n\n//////// adding elements, removing elements /////////////\n\nfunction mg_exit_and_remove(elem) {\n  elem.exit().remove();\n}\n\nfunction mg_selectAll_and_remove(svg, cl) {\n  svg.selectAll(cl).remove();\n}\n\nfunction mg_add_g(svg, cl) {\n  return svg.append('g').classed(cl, true);\n}\n\nfunction mg_remove_element(svg, elem) {\n  svg.select(elem).remove();\n}\n\n//////// axis helper functions ////////////\n\nfunction mg_make_rug(args, rug_class) {\n  var svg = mg_get_svg_child_of(args.target);\n  var all_data = mg_flatten_array(args.data);\n  var rug = svg.selectAll('line.' + rug_class).data(all_data);\n\n  rug.enter()\n    .append('line')\n      .attr('class', rug_class)\n      .attr('opacity', 0.3);\n\n  //remove rug elements that are no longer in use\n  mg_exit_and_remove(rug);\n\n  //set coordinates of new rug elements\n  mg_exit_and_remove(rug);\n  return rug;\n}\n\nfunction mg_add_color_accessor_to_rug(rug, args, rug_mono_class) {\n  if (args.color_accessor) {\n    rug.attr('stroke', args.scalefns.colorf);\n    rug.classed(rug_mono_class, false);\n  } else {\n    rug.attr('stroke', null);\n    rug.classed(rug_mono_class, true);\n  }\n}\n\nfunction mg_rotate_labels(labels, rotation_degree) {\n  if (rotation_degree) {\n    labels.attr({\n      dy: 0,\n      transform: function() {\n        var elem = d3.select(this);\n        return 'rotate(' + rotation_degree + ' ' + elem.attr('x') + ',' + elem.attr('y') + ')';\n      }\n    });\n  }\n}\n\n//////////////////////////////////////////////////\n\nfunction mg_elements_are_overlapping(labels) {\n  labels = labels.node();\n  if (!labels) {\n    return false;\n  }\n\n  for (var i = 0; i < labels.length; i++) {\n    if (mg_is_horizontally_overlapping(labels[i], labels)) return true;\n  }\n\n  return false;\n}\n\nfunction mg_prevent_horizontal_overlap(labels, args) {\n  if (!labels || labels.length == 1) {\n    return;\n  }\n\n  //see if each of our labels overlaps any of the other labels\n  for (var i = 0; i < labels.length; i++) {\n    //if so, nudge it up a bit, if the label it intersects hasn't already been nudged\n    if (mg_is_horizontally_overlapping(labels[i], labels)) {\n      var node = d3.select(labels[i]);\n      var newY = +node.attr('y');\n      if (newY + 8 >= args.top) {\n        newY = args.top - 16;\n      }\n      node.attr('y', newY);\n    }\n  }\n}\n\nfunction mg_prevent_vertical_overlap(labels, args) {\n  if (!labels || labels.length == 1) {\n    return;\n  }\n\n  labels.sort(function(b, a) {\n    return d3.select(a).attr('y') - d3.select(b).attr('y');\n  });\n\n  labels.reverse();\n\n  var overlap_amount, label_i, label_j;\n\n  //see if each of our labels overlaps any of the other labels\n  for (var i = 0; i < labels.length; i++) {\n    //if so, nudge it up a bit, if the label it intersects hasn't already been nudged\n    label_i = d3.select(labels[i]).text();\n\n    for (var j = 0; j < labels.length; j++) {\n      label_j = d3.select(labels[j]).text();\n      overlap_amount = mg_is_vertically_overlapping(labels[i], labels[j]);\n\n      if (overlap_amount !== false && label_i !== label_j) {\n        var node = d3.select(labels[i]);\n        var newY = +node.attr('y');\n        newY = newY + overlap_amount;\n        node.attr('y', newY);\n      }\n    }\n  }\n}\n\nfunction mg_is_vertically_overlapping(element, sibling) {\n  var element_bbox = element.getBoundingClientRect();\n  var sibling_bbox = sibling.getBoundingClientRect();\n\n  if (element_bbox.top <= sibling_bbox.bottom && element_bbox.top >= sibling_bbox.top) {\n    return sibling_bbox.bottom - element_bbox.top;\n  }\n\n  return false;\n}\n\nfunction mg_is_horiz_overlap(element, sibling) {\n  var element_bbox = element.getBoundingClientRect();\n  var sibling_bbox = sibling.getBoundingClientRect();\n\n  if (element_bbox.right >= sibling_bbox.left || element_bbox.top >= sibling_bbox.top) {\n    return sibling_bbox.bottom - element_bbox.top;\n  }\n  return false;\n}\n\nfunction mg_is_horizontally_overlapping(element, labels) {\n  var element_bbox = element.getBoundingClientRect();\n\n  for (var i = 0; i < labels.length; i++) {\n    if (labels[i] == element) {\n      continue;\n    }\n\n    //check to see if this label overlaps with any of the other labels\n    var sibling_bbox = labels[i].getBoundingClientRect();\n    if (element_bbox.top === sibling_bbox.top &&\n      !(sibling_bbox.left > element_bbox.right || sibling_bbox.right < element_bbox.left)\n    ) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction mg_infer_type(args, ns) {\n    // must return categorical or numerical.\n    var testPoint = mg_flatten_array(args.data);\n\n    testPoint = testPoint[0][args[ns + '_accessor']];\n    return typeof testPoint === 'string' ? 'categorical' : 'numerical';\n  }\n\nfunction mg_get_svg_child_of(selector_or_node) {\n  return d3.select(selector_or_node).select('svg');\n}\n\nfunction mg_flatten_array(arr) {\n  var flat_data = [];\n  return flat_data.concat.apply(flat_data, arr);\n}\n\nfunction mg_next_id() {\n  if (typeof MG._next_elem_id === 'undefined') {\n    MG._next_elem_id = 0;\n  }\n\n  return 'mg-' + (MG._next_elem_id++);\n}\n\nfunction mg_target_ref(target) {\n  if (typeof target === 'string') {\n    return mg_normalize(target);\n\n  } else if (target instanceof window.HTMLElement) {\n    var target_ref = target.getAttribute('data-mg-uid');\n    if (!target_ref) {\n      target_ref = mg_next_id();\n      target.setAttribute('data-mg-uid', target_ref);\n    }\n\n    return target_ref;\n\n  } else {\n    console.warn('The specified target should be a string or an HTMLElement.', target);\n    return mg_normalize(target);\n  }\n}\n\nfunction mg_normalize(string) {\n  return string\n    .replace(/[^a-zA-Z0-9 _-]+/g, '')\n    .replace(/ +?/g, '');\n}\n\nfunction get_pixel_dimension(target, dimension) {\n  return Number(d3.select(target).style(dimension).replace(/px/g, ''));\n}\n\nfunction get_width(target) {\n  return get_pixel_dimension(target, 'width');\n}\n\nfunction get_height(target) {\n  return get_pixel_dimension(target, 'height');\n}\n\nfunction isNumeric(n) {\n  return !isNaN(parseFloat(n)) && isFinite(n);\n}\n\nvar each = function(obj, iterator, context) {\n  // yanked out of underscore\n  var breaker = {};\n  if (obj === null) return obj;\n  if (Array.prototype.forEach && obj.forEach === Array.prototype.forEach) {\n    obj.forEach(iterator, context);\n  } else if (obj.length === +obj.length) {\n    for (var i = 0, length = obj.length; i < length; i++) {\n      if (iterator.call(context, obj[i], i, obj) === breaker) return;\n    }\n  } else {\n    for (var k in obj) {\n      if (iterator.call(context, obj[k], k, obj) === breaker) return;\n    }\n  }\n\n  return obj;\n};\n\nfunction merge_with_defaults(obj) {\n  // taken from underscore\n  each(Array.prototype.slice.call(arguments, 1), function(source) {\n    if (source) {\n      for (var prop in source) {\n        if (obj[prop] === void 0) obj[prop] = source[prop];\n      }\n    }\n  });\n\n  return obj;\n}\n\nMG.merge_with_defaults = merge_with_defaults;\n\nfunction number_of_values(data, accessor, value) {\n  var values = data.filter(function(d) {\n    return d[accessor] === value;\n  });\n\n  return values.length;\n}\n\nfunction has_values_below(data, accessor, value) {\n  var values = data.filter(function(d) {\n    return d[accessor] <= value;\n  });\n\n  return values.length > 0;\n}\n\nfunction has_too_many_zeros(data, accessor, zero_count) {\n  return number_of_values(data, accessor, 0) >= zero_count;\n}\n\nfunction mg_is_date(obj) {\n  return Object.prototype.toString.call(obj) === '[object Date]';\n}\n\nfunction mg_is_object(obj) {\n  return Object.prototype.toString.call(obj) === '[object Object]';\n}\n\nfunction mg_is_array(obj) {\n  if (Array.isArray) {\n    return Array.isArray(obj);\n  }\n\n  return Object.prototype.toString.call(obj) === '[object Array]';\n}\n\nfunction mg_is_function(obj) {\n  return Object.prototype.toString.call(obj) === '[object Function]';\n}\n\n// deep copy\n// http://stackoverflow.com/questions/728360/most-elegant-way-to-clone-a-javascript-object\nMG.clone = function(obj) {\n  var copy;\n\n  // Handle the 3 simple types, and null or undefined\n  if (null === obj || \"object\" !== typeof obj) return obj;\n\n  // Handle Date\n  if (mg_is_date(obj)) {\n    copy = new Date();\n    copy.setTime(obj.getTime());\n    return copy;\n  }\n\n  // Handle Array\n  if (mg_is_array(obj)) {\n    copy = [];\n    for (var i = 0, len = obj.length; i < len; i++) {\n      copy[i] = MG.clone(obj[i]);\n    }\n    return copy;\n  }\n\n  // Handle Object\n  if (mg_is_object(obj)) {\n    copy = {};\n    for (var attr in obj) {\n      if (obj.hasOwnProperty(attr)) copy[attr] = MG.clone(obj[attr]);\n    }\n    return copy;\n  }\n\n  throw new Error(\"Unable to copy obj! Its type isn't supported.\");\n};\n\n// give us the difference of two int arrays\n// http://radu.cotescu.com/javascript-diff-function/\nfunction arr_diff(a, b) {\n  var seen = [],\n    diff = [],\n    i;\n  for (i = 0; i < b.length; i++)\n    seen[b[i]] = true;\n  for (i = 0; i < a.length; i++)\n    if (!seen[a[i]])\n      diff.push(a[i]);\n  return diff;\n}\n\nMG.arr_diff = arr_diff;\n\n/**\n  Print warning message to the console when a feature has been scheduled for removal\n\n  @author Dan de Havilland (github.com/dandehavilland)\n  @date 2014-12\n*/\nfunction warn_deprecation(message, untilVersion) {\n  console.warn('Deprecation: ' + message + (untilVersion ? '. This feature will be removed in ' + untilVersion + '.' : ' the near future.'));\n  console.trace();\n}\n\nMG.warn_deprecation = warn_deprecation;\n\n/**\n  Truncate a string to fit within an SVG text node\n  CSS text-overlow doesn't apply to SVG <= 1.2\n\n  @author Dan de Havilland (github.com/dandehavilland)\n  @date 2014-12-02\n*/\nfunction truncate_text(textObj, textString, width) {\n  var bbox,\n    position = 0;\n\n  textObj.textContent = textString;\n  bbox = textObj.getBBox();\n\n  while (bbox.width > width) {\n    textObj.textContent = textString.slice(0, --position) + '...';\n    bbox = textObj.getBBox();\n\n    if (textObj.textContent === '...') {\n      break;\n    }\n  }\n}\n\nMG.truncate_text = truncate_text;\n\n/**\n  Wrap the contents of a text node to a specific width\n\n  Adapted from bl.ocks.org/mbostock/7555321\n\n  @author Mike Bostock\n  @author Dan de Havilland\n  @date 2015-01-14\n*/\nfunction wrap_text(text, width, token, tspanAttrs) {\n  text.each(function() {\n    var text = d3.select(this),\n      words = text.text().split(token || /\\s+/).reverse(),\n      word,\n      line = [],\n      lineNumber = 0,\n      lineHeight = 1.1, // ems\n      y = text.attr(\"y\"),\n      dy = 0,\n      tspan = text.text(null)\n      .append(\"tspan\")\n      .attr(\"x\", 0)\n      .attr(\"y\", dy + \"em\")\n      .attr(tspanAttrs || {});\n\n    while (!!(word = words.pop())) {\n      line.push(word);\n      tspan.text(line.join(\" \"));\n      if (width === null || tspan.node().getComputedTextLength() > width) {\n        line.pop();\n        tspan.text(line.join(\" \"));\n        line = [word];\n        tspan = text\n          .append(\"tspan\")\n          .attr(\"x\", 0)\n          .attr(\"y\", ++lineNumber * lineHeight + dy + \"em\")\n          .attr(tspanAttrs || {})\n          .text(word);\n      }\n    }\n  });\n}\n\nMG.wrap_text = wrap_text;\n\nfunction register(chartType, descriptor, defaults) {\n  MG.charts[chartType] = {\n    descriptor: descriptor,\n    defaults: defaults || {}\n  };\n}\n\nMG.register = register;\n\n/**\n  Record of all registered hooks.\n  For internal use only.\n*/\nMG._hooks = {};\n\n/**\n  Add a hook callthrough to the stack.\n\n  Hooks are executed in the order that they were registered.\n*/\nMG.add_hook = function(name, func, context) {\n  var hooks;\n\n  if (!MG._hooks[name]) {\n    MG._hooks[name] = [];\n  }\n\n  hooks = MG._hooks[name];\n\n  var already_registered =\n    hooks.filter(function(hook) {\n      return hook.func === func;\n    })\n    .length > 0;\n\n  if (already_registered) {\n    throw 'That function is already registered.';\n  }\n\n  hooks.push({\n    func: func,\n    context: context\n  });\n};\n\n/**\n  Execute registered hooks.\n\n  Optional arguments\n*/\nMG.call_hook = function(name) {\n  var hooks = MG._hooks[name],\n    result = [].slice.apply(arguments, [1]),\n    processed;\n\n  if (hooks) {\n    hooks.forEach(function(hook) {\n      if (hook.func) {\n        var params = processed || result;\n\n        if (params && params.constructor !== Array) {\n          params = [params];\n        }\n\n        params = [].concat.apply([], params);\n        processed = hook.func.apply(hook.context, params);\n      }\n    });\n  }\n\n  return processed || result;\n};\n\nMG.globals = {};\nMG.deprecations = {\n  rollover_callback: { replacement: 'mouseover', version: '2.0' },\n  rollout_callback: { replacement: 'mouseout', version: '2.0' },\n  x_rollover_format: { replacement: 'x_mouseover', version: '2.10' },\n  y_rollover_format: { replacement: 'y_mouseover', version: '2.10' },\n  show_years: { replacement: 'show_secondary_x_label', version: '2.1' },\n  xax_start_at_min: { replacement: 'axes_not_compact', version: '2.7' },\n  interpolate_tension: { replacement: 'interpolate', version: '2.10' }\n};\nMG.globals.link = false;\nMG.globals.version = \"1.1\";\n\nMG.charts = {};\n\nMG.data_graphic = function(args) {\n  'use strict';\n  var defaults = {\n    missing_is_zero: false,                     // if true, missing values will be treated as zeros\n    missing_is_hidden: false,                   // if true, missing values will appear as broken segments\n    missing_is_hidden_accessor: null,           // the accessor that determines the boolean value for missing data points\n    legend: '' ,                                // an array identifying the labels for a chart's lines\n    legend_target: '',                          // if set, the specified element is populated with a legend\n    error: '',                                  // if set, a graph will show an error icon and log the error to the console\n    animate_on_load: false,                     // animate lines on load\n    top: 65,                                    // the size of the top margin\n    title_y_position: 10,                       // how many pixels from the top edge (0) should we show the title at\n    center_title_full_width: false,             // center the title over the full graph (i.e. ignore left and right margins)\n    bottom: 45,                                 // the size of the bottom margin\n    right: 10,                                  // size of the right margin\n    left: 50,                                   // size of the left margin\n    buffer: 8,                                  // the buffer between the actual chart area and the margins\n    width: 350,                                 // the width of the entire graphic\n    height: 220,                                // the height of the entire graphic\n    full_width: false,                          // sets the graphic width to be the width of the parent element and resizes dynamically\n    full_height: false,                         // sets the graphic width to be the width of the parent element and resizes dynamically\n    small_height_threshold: 120,                // the height threshold for when smaller text appears\n    small_width_threshold: 160,                 // the width  threshold for when smaller text appears\n    xax_count: 6,                               // number of x axis ticks\n    xax_tick_length: 5,                         // x axis tick length\n    axes_not_compact: true,\n    yax_count: 3,                               // number of y axis ticks\n    yax_tick_length: 5,                         // y axis tick length\n    x_extended_ticks: false,                    // extends x axis ticks across chart - useful for tall charts\n    y_extended_ticks: false,                    // extends y axis ticks across chart - useful for long charts\n    y_scale_type: 'linear',\n    max_x: null,\n    max_y: null,\n    min_x: null,\n    min_y: null,                                // if set, y axis starts at an arbitrary value\n    min_y_from_data: false,                     // if set, y axis will start at minimum value rather than at 0\n    point_size: 2.5,                            // the size of the dot that appears on a line on mouse-over\n    x_accessor: 'date',\n    xax_units: '',\n    x_label: '',\n    x_sort: true,\n    x_axis: true,\n    y_axis: true,\n    x_axis_position: 'bottom',\n    y_axis_position: 'left',\n    x_axis_type: null,                          // TO BE INTRODUCED IN 2.10\n    y_axis_type: null,                          // TO BE INTRODUCED IN 2.10\n    ygroup_accessor: null,\n    xgroup_accessor:null,\n    y_padding_percentage: 0.05,                 // for categorical scales\n    y_outer_padding_percentage: .1,             // for categorical scales\n    ygroup_padding_percentage:.25,              // for categorical scales\n    ygroup_outer_padding_percentage: 0,         // for categorical scales\n    x_padding_percentage: 0.05,                 // for categorical scales\n    x_outer_padding_percentage: .1,             // for categorical scales\n    xgroup_padding_percentage:.25,              // for categorical scales\n    xgroup_outer_padding_percentage: 0,         // for categorical scales\n    y_categorical_show_guides: false,\n    x_categorical_show_guide: false,\n    rotate_x_labels: 0,\n    rotate_y_labels: 0,\n    y_accessor: 'value',\n    y_label: '',\n    yax_units: '',\n    yax_units_append: false,\n    x_rug: false,\n    y_rug: false,\n    mouseover_align: 'right',                   // implemented in point.js\n    x_mouseover: null,\n    y_mouseover: null,\n    transition_on_update: true,\n    mouseover: null,\n    click: null,\n    show_rollover_text: true,\n    show_confidence_band: null,                 // given [l, u] shows a confidence at each point from l to u\n    xax_format: null,                           // xax_format is a function that formats the labels for the x axis.\n    area: true,\n    chart_type: 'line',\n    data: [],\n    decimals: 2,                                // the number of decimals in any rollover\n    format: 'count',                            // format = {count, percentage}\n    inflator: 10/9,                             // for setting y axis max\n    linked: false,                              // links together all other graphs with linked:true, so rollovers in one trigger rollovers in the others\n    linked_format: '%Y-%m-%d',                  // What granularity to link on for graphs. Default is at day\n    list: false,\n    baselines: null,                            // sets the baseline lines\n    markers: null,                              // sets the marker lines\n    scalefns: {},\n    scales: {},\n    utc_time: false,\n    european_clock: false,\n    show_year_markers: false,\n    show_secondary_x_label: true,\n    target: '#viz',\n    interpolate: d3.curveCatmullRom.alpha(0),   // interpolation method to use when rendering lines; increase tension if your data is irregular and you notice artifacts\n    custom_line_color_map: [],                  // allows arbitrary mapping of lines to colors, e.g. [2,3] will map line 1 to color 2 and line 2 to color 3\n    colors: null,                               // UNIMPLEMENTED - allows direct color mapping to line colors. Will eventually require\n    max_data_size: null,                        // explicitly specify the the max number of line series, for use with custom_line_color_map\n    aggregate_rollover: false,                  // links the lines in a multi-line chart\n    show_tooltips: true                         // if enabled, a chart's description will appear in a tooltip (requires jquery)\n  };\n\n  MG.call_hook('global.defaults', defaults);\n\n  if (!args) { args = {}; }\n\n  var selected_chart = MG.charts[args.chart_type || defaults.chart_type];\n  merge_with_defaults(args, selected_chart.defaults, defaults);\n\n  if (args.list) {\n    args.x_accessor = 0;\n    args.y_accessor = 1;\n  }\n\n  // check for deprecated parameters\n  for (var key in MG.deprecations) {\n    if (args.hasOwnProperty(key)) {\n      var deprecation = MG.deprecations[key],\n        message = 'Use of `args.' + key + '` has been deprecated',\n        replacement = deprecation.replacement,\n        version;\n\n      // transparently alias the deprecated\n      if (replacement) {\n        if (args[replacement]) {\n          message += '. The replacement - `args.' + replacement + '` - has already been defined. This definition will be discarded.';\n        } else {\n          args[replacement] = args[key];\n        }\n      }\n\n      if (deprecation.warned) {\n        continue;\n      }\n\n      deprecation.warned = true;\n\n      if (replacement) {\n        message += ' in favor of `args.' + replacement + '`';\n      }\n\n      warn_deprecation(message, deprecation.version);\n    }\n  }\n\n  MG.call_hook('global.before_init', args);\n\n  new selected_chart.descriptor(args);\n\n  return args.data;\n};\n\nif (mg_jquery_exists()) {\n    /* ========================================================================\n     * Bootstrap: tooltip.js v3.3.5\n     * http://getbootstrap.com/javascript/#tooltip\n     * Inspired by the original jQuery.tipsy by Jason Frame\n     * ========================================================================\n     * Copyright 2011-2015 Twitter, Inc.\n     * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n     * ======================================================================== */\n\n\n    +function ($) {\n      'use strict';\n\n      // TOOLTIP PUBLIC CLASS DEFINITION\n      // ===============================\n\n      var Tooltip = function (element, options) {\n        this.type       = null\n        this.options    = null\n        this.enabled    = null\n        this.timeout    = null\n        this.hoverState = null\n        this.$element   = null\n        this.inState    = null\n\n        this.init('tooltip', element, options)\n      }\n\n      Tooltip.VERSION  = '3.3.5'\n\n      Tooltip.TRANSITION_DURATION = 150\n\n      Tooltip.DEFAULTS = {\n        animation: true,\n        placement: 'top',\n        selector: false,\n        template: '<div class=\"tooltip\" role=\"tooltip\"><div class=\"tooltip-arrow\"></div><div class=\"tooltip-inner\"></div></div>',\n        trigger: 'hover focus',\n        title: '',\n        delay: 0,\n        html: false,\n        container: false,\n        viewport: {\n          selector: 'body',\n          padding: 0\n        }\n      }\n\n      Tooltip.prototype.init = function (type, element, options) {\n        this.enabled   = true\n        this.type      = type\n        this.$element  = $(element)\n        this.options   = this.getOptions(options)\n        this.$viewport = this.options.viewport && $($.isFunction(this.options.viewport) ? this.options.viewport.call(this, this.$element) : (this.options.viewport.selector || this.options.viewport))\n        this.inState   = { click: false, hover: false, focus: false }\n\n        if (this.$element[0] instanceof document.constructor && !this.options.selector) {\n          throw new Error('`selector` option must be specified when initializing ' + this.type + ' on the window.document object!')\n        }\n\n        var triggers = this.options.trigger.split(' ')\n\n        for (var i = triggers.length; i--;) {\n          var trigger = triggers[i]\n\n          if (trigger == 'click') {\n            this.$element.on('click.' + this.type, this.options.selector, $.proxy(this.toggle, this))\n          } else if (trigger != 'manual') {\n            var eventIn  = trigger == 'hover' ? 'mouseenter' : 'focusin'\n            var eventOut = trigger == 'hover' ? 'mouseleave' : 'focusout'\n\n            this.$element.on(eventIn  + '.' + this.type, this.options.selector, $.proxy(this.enter, this))\n            this.$element.on(eventOut + '.' + this.type, this.options.selector, $.proxy(this.leave, this))\n          }\n        }\n\n        this.options.selector ?\n          (this._options = $.extend({}, this.options, { trigger: 'manual', selector: '' })) :\n          this.fixTitle()\n      }\n\n      Tooltip.prototype.getDefaults = function () {\n        return Tooltip.DEFAULTS\n      }\n\n      Tooltip.prototype.getOptions = function (options) {\n        options = $.extend({}, this.getDefaults(), this.$element.data(), options)\n\n        if (options.delay && typeof options.delay == 'number') {\n          options.delay = {\n            show: options.delay,\n            hide: options.delay\n          }\n        }\n\n        return options\n      }\n\n      Tooltip.prototype.getDelegateOptions = function () {\n        var options  = {}\n        var defaults = this.getDefaults()\n\n        this._options && $.each(this._options, function (key, value) {\n          if (defaults[key] != value) options[key] = value\n        })\n\n        return options\n      }\n\n      Tooltip.prototype.enter = function (obj) {\n        var self = obj instanceof this.constructor ?\n          obj : $(obj.currentTarget).data('bs.' + this.type)\n\n        if (!self) {\n          self = new this.constructor(obj.currentTarget, this.getDelegateOptions())\n          $(obj.currentTarget).data('bs.' + this.type, self)\n        }\n\n        if (obj instanceof $.Event) {\n          self.inState[obj.type == 'focusin' ? 'focus' : 'hover'] = true\n        }\n\n        if (self.tip().hasClass('in') || self.hoverState == 'in') {\n          self.hoverState = 'in'\n          return\n        }\n\n        clearTimeout(self.timeout)\n\n        self.hoverState = 'in'\n\n        if (!self.options.delay || !self.options.delay.show) return self.show()\n\n        self.timeout = setTimeout(function () {\n          if (self.hoverState == 'in') self.show()\n        }, self.options.delay.show)\n      }\n\n      Tooltip.prototype.isInStateTrue = function () {\n        for (var key in this.inState) {\n          if (this.inState[key]) return true\n        }\n\n        return false\n      }\n\n      Tooltip.prototype.leave = function (obj) {\n        var self = obj instanceof this.constructor ?\n          obj : $(obj.currentTarget).data('bs.' + this.type)\n\n        if (!self) {\n          self = new this.constructor(obj.currentTarget, this.getDelegateOptions())\n          $(obj.currentTarget).data('bs.' + this.type, self)\n        }\n\n        if (obj instanceof $.Event) {\n          self.inState[obj.type == 'focusout' ? 'focus' : 'hover'] = false\n        }\n\n        if (self.isInStateTrue()) return\n\n        clearTimeout(self.timeout)\n\n        self.hoverState = 'out'\n\n        if (!self.options.delay || !self.options.delay.hide) return self.hide()\n\n        self.timeout = setTimeout(function () {\n          if (self.hoverState == 'out') self.hide()\n        }, self.options.delay.hide)\n      }\n\n      Tooltip.prototype.show = function () {\n        var e = $.Event('show.bs.' + this.type)\n\n        if (this.hasContent() && this.enabled) {\n          this.$element.trigger(e)\n\n          var inDom = $.contains(this.$element[0].ownerDocument.documentElement, this.$element[0])\n          if (e.isDefaultPrevented() || !inDom) return\n          var that = this\n\n          var $tip = this.tip()\n\n          var tipId = this.getUID(this.type)\n\n          this.setContent()\n          $tip.attr('id', tipId)\n          this.$element.attr('aria-describedby', tipId)\n\n          if (this.options.animation) $tip.addClass('fade')\n\n          var placement = typeof this.options.placement == 'function' ?\n            this.options.placement.call(this, $tip[0], this.$element[0]) :\n            this.options.placement\n\n          var autoToken = /\\s?auto?\\s?/i\n          var autoPlace = autoToken.test(placement)\n          if (autoPlace) placement = placement.replace(autoToken, '') || 'top'\n\n          $tip\n            .detach()\n            .css({ top: 0, left: 0, display: 'block' })\n            .addClass(placement)\n            .data('bs.' + this.type, this)\n\n          this.options.container ? $tip.appendTo(this.options.container) : $tip.insertAfter(this.$element)\n          this.$element.trigger('inserted.bs.' + this.type)\n\n          var pos          = this.getPosition()\n          var actualWidth  = $tip[0].offsetWidth\n          var actualHeight = $tip[0].offsetHeight\n\n          if (autoPlace) {\n            var orgPlacement = placement\n            var viewportDim = this.getPosition(this.$viewport)\n\n            placement = placement == 'bottom' && pos.bottom + actualHeight > viewportDim.bottom ? 'top'    :\n                        placement == 'top'    && pos.top    - actualHeight < viewportDim.top    ? 'bottom' :\n                        placement == 'right'  && pos.right  + actualWidth  > viewportDim.width  ? 'left'   :\n                        placement == 'left'   && pos.left   - actualWidth  < viewportDim.left   ? 'right'  :\n                        placement\n\n            $tip\n              .removeClass(orgPlacement)\n              .addClass(placement)\n          }\n\n          var calculatedOffset = this.getCalculatedOffset(placement, pos, actualWidth, actualHeight)\n\n          this.applyPlacement(calculatedOffset, placement)\n\n          var complete = function () {\n            var prevHoverState = that.hoverState\n            that.$element.trigger('shown.bs.' + that.type)\n            that.hoverState = null\n\n            if (prevHoverState == 'out') that.leave(that)\n          }\n\n          $.support.transition && this.$tip.hasClass('fade') ?\n            $tip\n              .one('bsTransitionEnd', complete)\n              .emulateTransitionEnd(Tooltip.TRANSITION_DURATION) :\n            complete()\n        }\n      }\n\n      Tooltip.prototype.applyPlacement = function (offset, placement) {\n        var $tip   = this.tip()\n        var width  = $tip[0].offsetWidth\n        var height = $tip[0].offsetHeight\n\n        // manually read margins because getBoundingClientRect includes difference\n        var marginTop = parseInt($tip.css('margin-top'), 10)\n        var marginLeft = parseInt($tip.css('margin-left'), 10)\n\n        // we must check for NaN for ie 8/9\n        if (isNaN(marginTop))  marginTop  = 0\n        if (isNaN(marginLeft)) marginLeft = 0\n\n        offset.top  += marginTop\n        offset.left += marginLeft\n\n        // $.fn.offset doesn't round pixel values\n        // so we use setOffset directly with our own function B-0\n        $.offset.setOffset($tip[0], $.extend({\n          using: function (props) {\n            $tip.css({\n              top: Math.round(props.top),\n              left: Math.round(props.left)\n            })\n          }\n        }, offset), 0)\n\n        $tip.addClass('in')\n\n        // check to see if placing tip in new offset caused the tip to resize itself\n        var actualWidth  = $tip[0].offsetWidth\n        var actualHeight = $tip[0].offsetHeight\n\n        if (placement == 'top' && actualHeight != height) {\n          offset.top = offset.top + height - actualHeight\n        }\n\n        var delta = this.getViewportAdjustedDelta(placement, offset, actualWidth, actualHeight)\n\n        if (delta.left) offset.left += delta.left\n        else offset.top += delta.top\n\n        var isVertical          = /top|bottom/.test(placement)\n        var arrowDelta          = isVertical ? delta.left * 2 - width + actualWidth : delta.top * 2 - height + actualHeight\n        var arrowOffsetPosition = isVertical ? 'offsetWidth' : 'offsetHeight'\n\n        $tip.offset(offset)\n        this.replaceArrow(arrowDelta, $tip[0][arrowOffsetPosition], isVertical)\n      }\n\n      Tooltip.prototype.replaceArrow = function (delta, dimension, isVertical) {\n        this.arrow()\n          .css(isVertical ? 'left' : 'top', 50 * (1 - delta / dimension) + '%')\n          .css(isVertical ? 'top' : 'left', '')\n      }\n\n      Tooltip.prototype.setContent = function () {\n        var $tip  = this.tip()\n        var title = this.getTitle()\n\n        $tip.find('.tooltip-inner')[this.options.html ? 'html' : 'text'](title)\n        $tip.removeClass('fade in top bottom left right')\n      }\n\n      Tooltip.prototype.hide = function (callback) {\n        var that = this\n        var $tip = $(this.$tip)\n        var e    = $.Event('hide.bs.' + this.type)\n\n        function complete() {\n          if (that.hoverState != 'in') $tip.detach()\n          that.$element\n            .removeAttr('aria-describedby')\n            .trigger('hidden.bs.' + that.type)\n          callback && callback()\n        }\n\n        this.$element.trigger(e)\n\n        if (e.isDefaultPrevented()) return\n\n        $tip.removeClass('in')\n\n        $.support.transition && $tip.hasClass('fade') ?\n          $tip\n            .one('bsTransitionEnd', complete)\n            .emulateTransitionEnd(Tooltip.TRANSITION_DURATION) :\n          complete()\n\n        this.hoverState = null\n\n        return this\n      }\n\n      Tooltip.prototype.fixTitle = function () {\n        var $e = this.$element\n        if ($e.attr('title') || typeof $e.attr('data-original-title') != 'string') {\n          $e.attr('data-original-title', $e.attr('title') || '').attr('title', '')\n        }\n      }\n\n      Tooltip.prototype.hasContent = function () {\n        return this.getTitle()\n      }\n\n      Tooltip.prototype.getPosition = function ($element) {\n        $element   = $element || this.$element\n\n        var el     = $element[0]\n        var isBody = el.tagName == 'BODY'\n\n        var elRect    = el.getBoundingClientRect()\n        if (elRect.width == null) {\n          // width and height are missing in IE8, so compute them manually; see https://github.com/twbs/bootstrap/issues/14093\n          elRect = $.extend({}, elRect, { width: elRect.right - elRect.left, height: elRect.bottom - elRect.top })\n        }\n        var elOffset  = isBody ? { top: 0, left: 0 } : $element.offset()\n        var scroll    = { scroll: isBody ? document.documentElement.scrollTop || document.body.scrollTop : $element.scrollTop() }\n        var outerDims = isBody ? { width: $(window).width(), height: $(window).height() } : null\n\n        return $.extend({}, elRect, scroll, outerDims, elOffset)\n      }\n\n      Tooltip.prototype.getCalculatedOffset = function (placement, pos, actualWidth, actualHeight) {\n        return placement == 'bottom' ? { top: pos.top + pos.height,   left: pos.left + pos.width / 2 - actualWidth / 2 } :\n               placement == 'top'    ? { top: pos.top - actualHeight, left: pos.left + pos.width / 2 - actualWidth / 2 } :\n               placement == 'left'   ? { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left - actualWidth } :\n            /* placement == 'right' */ { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left + pos.width }\n\n      }\n\n      Tooltip.prototype.getViewportAdjustedDelta = function (placement, pos, actualWidth, actualHeight) {\n        var delta = { top: 0, left: 0 }\n        if (!this.$viewport) return delta\n\n        var viewportPadding = this.options.viewport && this.options.viewport.padding || 0\n        var viewportDimensions = this.getPosition(this.$viewport)\n\n        if (/right|left/.test(placement)) {\n          var topEdgeOffset    = pos.top - viewportPadding - viewportDimensions.scroll\n          var bottomEdgeOffset = pos.top + viewportPadding - viewportDimensions.scroll + actualHeight\n          if (topEdgeOffset < viewportDimensions.top) { // top overflow\n            delta.top = viewportDimensions.top - topEdgeOffset\n          } else if (bottomEdgeOffset > viewportDimensions.top + viewportDimensions.height) { // bottom overflow\n            delta.top = viewportDimensions.top + viewportDimensions.height - bottomEdgeOffset\n          }\n        } else {\n          var leftEdgeOffset  = pos.left - viewportPadding\n          var rightEdgeOffset = pos.left + viewportPadding + actualWidth\n          if (leftEdgeOffset < viewportDimensions.left) { // left overflow\n            delta.left = viewportDimensions.left - leftEdgeOffset\n          } else if (rightEdgeOffset > viewportDimensions.right) { // right overflow\n            delta.left = viewportDimensions.left + viewportDimensions.width - rightEdgeOffset\n          }\n        }\n\n        return delta\n      }\n\n      Tooltip.prototype.getTitle = function () {\n        var title\n        var $e = this.$element\n        var o  = this.options\n\n        title = $e.attr('data-original-title')\n          || (typeof o.title == 'function' ? o.title.call($e[0]) :  o.title)\n\n        return title\n      }\n\n      Tooltip.prototype.getUID = function (prefix) {\n        do prefix += ~~(Math.random() * 1000000)\n        while (document.getElementById(prefix))\n        return prefix\n      }\n\n      Tooltip.prototype.tip = function () {\n        if (!this.$tip) {\n          this.$tip = $(this.options.template)\n          if (this.$tip.length != 1) {\n            throw new Error(this.type + ' `template` option must consist of exactly 1 top-level element!')\n          }\n        }\n        return this.$tip\n      }\n\n      Tooltip.prototype.arrow = function () {\n        return (this.$arrow = this.$arrow || this.tip().find('.tooltip-arrow'))\n      }\n\n      Tooltip.prototype.enable = function () {\n        this.enabled = true\n      }\n\n      Tooltip.prototype.disable = function () {\n        this.enabled = false\n      }\n\n      Tooltip.prototype.toggleEnabled = function () {\n        this.enabled = !this.enabled\n      }\n\n      Tooltip.prototype.toggle = function (e) {\n        var self = this\n        if (e) {\n          self = $(e.currentTarget).data('bs.' + this.type)\n          if (!self) {\n            self = new this.constructor(e.currentTarget, this.getDelegateOptions())\n            $(e.currentTarget).data('bs.' + this.type, self)\n          }\n        }\n\n        if (e) {\n          self.inState.click = !self.inState.click\n          if (self.isInStateTrue()) self.enter(self)\n          else self.leave(self)\n        } else {\n          self.tip().hasClass('in') ? self.leave(self) : self.enter(self)\n        }\n      }\n\n      Tooltip.prototype.destroy = function () {\n        var that = this\n        clearTimeout(this.timeout)\n        this.hide(function () {\n          that.$element.off('.' + that.type).removeData('bs.' + that.type)\n          if (that.$tip) {\n            that.$tip.detach()\n          }\n          that.$tip = null\n          that.$arrow = null\n          that.$viewport = null\n        })\n      }\n\n\n      // TOOLTIP PLUGIN DEFINITION\n      // =========================\n\n      function Plugin(option) {\n        return this.each(function () {\n          var $this   = $(this)\n          var data    = $this.data('bs.tooltip')\n          var options = typeof option == 'object' && option\n\n          if (!data && /destroy|hide/.test(option)) return\n          if (!data) $this.data('bs.tooltip', (data = new Tooltip(this, options)))\n          if (typeof option == 'string') data[option]()\n        })\n      }\n\n      var old = $.fn.tooltip\n\n      $.fn.tooltip             = Plugin\n      $.fn.tooltip.Constructor = Tooltip\n\n\n      // TOOLTIP NO CONFLICT\n      // ===================\n\n      $.fn.tooltip.noConflict = function () {\n        $.fn.tooltip = old\n        return this\n      }\n\n    }(jQuery);\n\n\n    /* ========================================================================\n     * Bootstrap: popover.js v3.3.5\n     * http://getbootstrap.com/javascript/#popovers\n     * ========================================================================\n     * Copyright 2011-2015 Twitter, Inc.\n     * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n     * ======================================================================== */\n\n\n    +function ($) {\n      'use strict';\n\n      // POPOVER PUBLIC CLASS DEFINITION\n      // ===============================\n\n      var Popover = function (element, options) {\n        this.init('popover', element, options)\n      }\n\n      if (!$.fn.tooltip) throw new Error('Popover requires tooltip.js')\n\n      Popover.VERSION  = '3.3.5'\n\n      Popover.DEFAULTS = $.extend({}, $.fn.tooltip.Constructor.DEFAULTS, {\n        placement: 'right',\n        trigger: 'click',\n        content: '',\n        template: '<div class=\"popover\" role=\"tooltip\"><div class=\"arrow\"></div><h3 class=\"popover-title\"></h3><div class=\"popover-content\"></div></div>'\n      })\n\n\n      // NOTE: POPOVER EXTENDS tooltip.js\n      // ================================\n\n      Popover.prototype = $.extend({}, $.fn.tooltip.Constructor.prototype)\n\n      Popover.prototype.constructor = Popover\n\n      Popover.prototype.getDefaults = function () {\n        return Popover.DEFAULTS\n      }\n\n      Popover.prototype.setContent = function () {\n        var $tip    = this.tip()\n        var title   = this.getTitle()\n        var content = this.getContent()\n\n        $tip.find('.popover-title')[this.options.html ? 'html' : 'text'](title)\n        $tip.find('.popover-content').children().detach().end()[ // we use append for html objects to maintain js events\n          this.options.html ? (typeof content == 'string' ? 'html' : 'append') : 'text'\n        ](content)\n\n        $tip.removeClass('fade top bottom left right in')\n\n        // IE8 doesn't accept hiding via the `:empty` pseudo selector, we have to do\n        // this manually by checking the contents.\n        if (!$tip.find('.popover-title').html()) $tip.find('.popover-title').hide()\n      }\n\n      Popover.prototype.hasContent = function () {\n        return this.getTitle() || this.getContent()\n      }\n\n      Popover.prototype.getContent = function () {\n        var $e = this.$element\n        var o  = this.options\n\n        return $e.attr('data-content')\n          || (typeof o.content == 'function' ?\n                o.content.call($e[0]) :\n                o.content)\n      }\n\n      Popover.prototype.arrow = function () {\n        return (this.$arrow = this.$arrow || this.tip().find('.arrow'))\n      }\n\n\n      // POPOVER PLUGIN DEFINITION\n      // =========================\n\n      function Plugin(option) {\n        return this.each(function () {\n          var $this   = $(this)\n          var data    = $this.data('bs.popover')\n          var options = typeof option == 'object' && option\n\n          if (!data && /destroy|hide/.test(option)) return\n          if (!data) $this.data('bs.popover', (data = new Popover(this, options)))\n          if (typeof option == 'string') data[option]()\n        })\n      }\n\n      var old = $.fn.popover\n\n      $.fn.popover             = Plugin\n      $.fn.popover.Constructor = Popover\n\n\n      // POPOVER NO CONFLICT\n      // ===================\n\n      $.fn.popover.noConflict = function () {\n        $.fn.popover = old\n        return this\n      }\n\n    }(jQuery);\n}\n\nfunction chart_title(args) {\n  'use strict';\n\n  var svg = mg_get_svg_child_of(args.target);\n\n  //remove the current title if it exists\n  svg.select('.mg-header').remove();\n\n  if (args.target && args.title) {\n    var chartTitle = svg.insert('text')\n      .attr('class', 'mg-header')\n      .attr('x', args.center_title_full_width ? args.width /2 : (args.width + args.left - args.right) / 2)\n      .attr('y', args.title_y_position)\n      .attr('text-anchor', 'middle')\n      .attr('dy', '0.55em');\n\n    //show the title\n    chartTitle.append('tspan')\n      .attr('class', 'mg-chart-title')\n      .text(args.title);\n\n    //show and activate the description icon if we have a description\n    if (args.show_tooltips && args.description && mg_jquery_exists()) {\n      chartTitle.append('tspan')\n        .attr('class', 'mg-chart-description')\n        .attr('dx', '0.3em')\n        .text('\\uf059');\n\n      //now that the title is an svg text element, we'll have to trigger\n      //mouseenter, mouseleave events manually for the popover to work properly\n      var $chartTitle = $(chartTitle.node());\n      $chartTitle.popover({\n        html: true,\n        animation: false,\n        placement: 'top',\n        content: args.description,\n        container: args.target,\n        trigger: 'manual',\n        template: '<div class=\"popover mg-popover\"><div class=\"arrow\"></div><div class=\"popover-inner\"><h3 class=\"popover-title\"></h3><div class=\"popover-content\"><p></p></div></div></div>'\n      }).on('mouseenter', function() {\n        d3.selectAll(args.target)\n          .selectAll('.mg-popover')\n          .remove();\n\n        $(this).popover('show');\n        $(d3.select(args.target).select('.popover').node())\n          .on('mouseleave', function () {\n            $chartTitle.popover('hide');\n          });\n      }).on('mouseleave', function () {\n        setTimeout(function () {\n          if (!$('.popover:hover').length) {\n            $chartTitle.popover('hide');\n          }\n        }, 120);\n      });\n    } else if (args.show_tooltips && args.description && typeof $ === 'undefined') {\n      args.error = 'In order to enable tooltips, please make sure you include jQuery.';\n    }\n  }\n\n  if (args.error) {\n    error(args);\n  }\n}\n\nMG.chart_title = chart_title;\n\nfunction mg_add_scale_function(args, scalefcn_name, scale, accessor, inflation) {\n  args.scalefns[scalefcn_name] = function(di) {\n    if (inflation === undefined) return args.scales[scale](di[accessor]);\n    else return args.scales[scale](di[accessor]) + inflation;\n  };\n}\n\nfunction mg_position(str, args) {\n  if (str === 'bottom' || str === 'top') {\n    return [mg_get_plot_left(args), mg_get_plot_right(args)];\n  }\n\n  if (str === 'left' || str === 'right') {\n    return [mg_get_plot_bottom(args), args.top];\n  }\n}\n\nfunction mg_cat_position(str, args) {\n  if (str === 'bottom' || str === 'top') {\n    return [mg_get_plot_left(args), mg_get_plot_right(args)]\n  }\n\n  if (str === 'left' || str === 'right') {\n    return [mg_get_plot_bottom(args), mg_get_plot_top(args)];\n  }\n}\n\nfunction MGScale(args) {\n  // big wrapper around d3 scale that automatically formats & calculates scale bounds\n  // according to the data, and handles other niceties.\n  var scaleArgs = {}\n  scaleArgs.use_inflator = false;\n  scaleArgs.zero_bottom = false;\n  scaleArgs.scaleType = 'numerical';\n\n  this.namespace = function(_namespace) {\n    scaleArgs.namespace = _namespace;\n    scaleArgs.namespace_accessor_name = scaleArgs.namespace + '_accessor';\n    scaleArgs.scale_name = scaleArgs.namespace.toUpperCase();\n    scaleArgs.scalefn_name = scaleArgs.namespace + 'f';\n    return this;\n  }\n\n  this.scaleName = function(scaleName) {\n    scaleArgs.scale_name = scaleName.toUpperCase();\n    scaleArgs.scalefn_name = scaleName +'f';\n    return this;\n  }\n\n  this.inflateDomain = function(tf) {\n    scaleArgs.use_inflator = tf;\n    return this;\n  }\n\n  this.zeroBottom = function(tf) {\n    scaleArgs.zero_bottom = tf;\n    return this;\n  }\n\n  /////////////////////////////////////////////////////////////////////////////////////////////////////////\n  /// all scale domains are either numerical (number, date, etc.) or categorical (factor, label, etc) /////\n  /////////////////////////////////////////////////////////////////////////////////////////////////////////\n  // these functions automatically create the d3 scale function and place the domain.\n\n  this.numericalDomainFromData = function() {\n    var other_flat_data_arrays = [];\n\n    if (arguments.length > 0) {\n      other_flat_data_arrays = arguments;\n    }\n\n    // pull out a non-empty array in args.data.\n    var illustrative_data;\n    for (var i = 0; i < args.data.length; i++) {\n      if (args.data[i].length > 0) {\n        illustrative_data = args.data[i];\n      }\n    }\n    scaleArgs.is_time_series = mg_is_date(illustrative_data[0][args[scaleArgs.namespace_accessor_name]])\n      ? true\n      : false;\n\n    mg_add_scale_function(args, scaleArgs.scalefn_name, scaleArgs.scale_name, args[scaleArgs.namespace_accessor_name]);\n\n    mg_min_max_numerical(args, scaleArgs, other_flat_data_arrays, scaleArgs.use_inflator);\n\n    var time_scale = (args.utc_time)\n      ? d3.scaleUtc()\n      : d3.scaleTime();\n\n    args.scales[scaleArgs.scale_name] = (scaleArgs.is_time_series)\n      ? time_scale\n      : (mg_is_function(args[scaleArgs.namespace + '_scale_type']))\n        ? args.y_scale_type()\n        : (args[scaleArgs.namespace + '_scale_type'] === 'log')\n          ? d3.scaleLog()\n          : d3.scaleLinear();\n\n    args.scales[scaleArgs.scale_name].domain([args.processed['min_' + scaleArgs.namespace], args.processed['max_' + scaleArgs.namespace]]);\n    scaleArgs.scaleType = 'numerical';\n\n    return this;\n  }\n\n  this.categoricalDomain = function(domain) {\n    args.scales[scaleArgs.scale_name] = d3.scaleOrdinal().domain(domain);\n    mg_add_scale_function(args, scaleArgs.scalefn_name, scaleArgs.scale_name, args[scaleArgs.namespace_accessor_name]);\n    return this;\n  }\n\n  this.categoricalDomainFromData = function() {\n    // make args.categorical_variables.\n    // lets make the categorical variables.\n    var all_data = mg_flatten_array(args.data)\n    //d3.set(data.map(function(d){return d[args.group_accessor]})).values()\n    scaleArgs.categoricalVariables = d3.set(all_data.map(function(d) {\n      return d[args[scaleArgs.namespace_accessor_name]] })).values();\n    args.scales[scaleArgs.scale_name] = d3.scaleBand()\n      .domain(scaleArgs.categoricalVariables);\n\n    scaleArgs.scaleType = 'categorical';\n    return this;\n  }\n\n  /////////////////////////////////////////////////////////////////////////////////////////////////////////////\n  ////////// all scale ranges are either positional (for axes, etc) or arbitrary (colors, size, etc) //////////\n  /////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n  this.numericalRange = function(range) {\n    if (typeof range === 'string') {\n      args\n        .scales[scaleArgs.scale_name]\n        .range(mg_position(range, args));\n    } else {\n      args\n        .scales[scaleArgs.scale_name]\n        .range(range);\n    }\n\n    return this;\n  }\n\n  this.categoricalRangeBands = function(range, halfway) {\n    if (halfway === undefined) halfway = false;\n\n    var namespace = scaleArgs.namespace;\n    var paddingPercentage = args[namespace + '_padding_percentage'];\n    var outerPaddingPercentage = args[namespace + '_outer_padding_percentage'];\n    if (typeof range === 'string') {\n      // if string, it's a location. Place it accordingly.\n      args.scales[scaleArgs.scale_name]\n        .range(mg_position(range, args))\n        .paddingInner(paddingPercentage)\n        .paddingOuter(outerPaddingPercentage);\n    } else {\n      args.scales[scaleArgs.scale_name]\n        .range(range)\n        .paddingInner(paddingPercentage)\n        .paddingOuter(outerPaddingPercentage);\n    }\n\n    mg_add_scale_function(\n      args,\n      scaleArgs.scalefn_name,\n      scaleArgs.scale_name,\n      args[scaleArgs.namespace_accessor_name],\n      halfway\n        ? args.scales[scaleArgs.scale_name].bandwidth() / 2\n        : 0\n    );\n\n    return this;\n  }\n\n  this.categoricalRange = function(range) {\n    args.scales[scaleArgs.scale_name].range(range);\n    mg_add_scale_function(args, scaleArgs.scalefn_name, scaleArgs.scale_name, args[scaleArgs.namespace_accessor_name]);\n    return this;\n  }\n\n  this.categoricalColorRange = function() {\n    args.scales[scaleArgs.scale_name] = args.scales[scaleArgs.scale_name].domain().length > 10\n      ? d3.scaleOrdinal(d3.schemeCategory20)\n      : d3.scaleOrdinal(d3.schemeCategory10);\n\n    args\n      .scales[scaleArgs.scale_name]\n      .domain(scaleArgs.categoricalVariables);\n\n    mg_add_scale_function(args, scaleArgs.scalefn_name, scaleArgs.scale_name, args[scaleArgs.namespace_accessor_name]);\n    return this;\n  }\n\n  this.clamp = function(yn) {\n    args.scales[scaleArgs.scale_name].clamp(yn);\n    return this;\n  }\n\n  return this;\n}\n\nMG.scale_factory = MGScale;\n\n/////////////////////////////// x, x_accessor, markers, baselines, etc.\nfunction mg_min_max_numerical(args, scaleArgs, additional_data_arrays) {\n  // A BIT OF EXPLANATION ABOUT THIS FUNCTION\n  // This function pulls out all the accessor values in all the arrays in args.data.\n  // We also have this additional argument, additional_data_arrays, which is an array of arrays of raw data values.\n  // These values also get concatenated to the data pulled from args.data, and the extents are calculate from that.\n  // They are optional.\n  //\n  // This may seem arbitrary, but it gives us a lot of flexibility. For instance, if we're calculating\n  // the min and max for the y axis of a line chart, we're going to want to also factor in baselines (horizontal lines\n  // that might potentially be outside of the y value bounds). The easiest way to do this is in the line.js code\n  // & scale creation to just flatten the args.baselines array, pull out hte values, and feed it in\n  // so it appears in additional_data_arrays.\n  var namespace = scaleArgs.namespace;\n  var namespace_accessor_name = scaleArgs.namespace_accessor_name;\n  var use_inflator = scaleArgs.use_inflator;\n  var zero_bottom = scaleArgs.zero_bottom;\n\n  var accessor = args[namespace_accessor_name];\n\n  // add together all relevant data arrays.\n  var all_data = mg_flatten_array(args.data)\n    .map(function(dp) {\n      return dp[accessor] })\n    .concat(mg_flatten_array(additional_data_arrays));\n\n  // do processing for log\n  if (args[namespace + '_scale_type'] === 'log') {\n    all_data = all_data.filter(function(d) {\n      return d > 0;\n    });\n  }\n\n  // use inflator?\n  var extents = d3.extent(all_data);\n  var min_val = extents[0];\n  var max_val = extents[1];\n\n  // bolt scale domain to zero when the right conditions are met:\n  // not pulling the bottom of the range from data\n  // not zero-bottomed\n  // not a time series\n  if (zero_bottom && !args['min_' + namespace + '_from_data'] && min_val > 0 && !scaleArgs.is_time_series) {\n    min_val = args[namespace + '_scale_type'] === 'log' ? 1 : 0;\n  }\n\n  if (args[namespace + '_scale_type'] !== 'log' && min_val < 0 && !scaleArgs.is_time_series) {\n    min_val = min_val - (min_val - min_val * args.inflator) * use_inflator;\n  }\n\n  if (!scaleArgs.is_time_series) {\n    max_val = (max_val < 0) ? max_val + (max_val - max_val * args.inflator) * use_inflator : max_val * (use_inflator ? args.inflator : 1);\n  }\n\n  min_val = args['min_' + namespace] || min_val;\n  max_val = args['max_' + namespace] || max_val;\n  // if there's a single data point, we should custom-set the min and max values.\n\n  if (min_val === max_val && !(args['min_' + namespace] && args['max_' + namespace])) {\n\n    if (mg_is_date(min_val)) {\n      max_val = new Date(MG.clone(min_val).setDate(min_val.getDate() + 1));\n      min_val = new Date(MG.clone(min_val).setDate(min_val.getDate() - 1));\n    } else if (typeof min_val === 'number') {\n      min_val = min_val - 1;\n      max_val = min_val + 1;\n      mg_force_xax_count_to_be_two(args);\n    }\n  }\n\n  args.processed['min_' + namespace] = min_val;\n  args.processed['max_' + namespace] = max_val;\n\n  MG.call_hook('x_axis.process_min_max', args, args.processed.min_x, args.processed.max_x);\n  MG.call_hook('y_axis.process_min_max', args, args.processed.min_y, args.processed.max_y);\n}\n\nfunction mg_categorical_group_color_scale(args) {\n  if (args.color_accessor !== false) {\n    if (args.ygroup_accessor) {\n      // add a custom accessor element.\n      if (args.color_accessor === null) {\n        args.color_accessor = args.y_accessor;\n      } else {}\n    }\n    if (args.color_accessor !== null) {\n      new MG.scale_factory(args)\n        .namespace('color')\n        .categoricalDomainFromData()\n        .categoricalColorRange();\n    }\n  }\n}\n\nfunction mg_add_color_categorical_scale(args, domain, accessor) {\n  args.scales.color = d3.scaleOrdinal(d3.schemeCategory20).domain(domain);\n  args.scalefns.color = function(d) {\n    return args.scales.color(d[accessor]);\n  };\n}\n\nfunction mg_get_categorical_domain(data, accessor) {\n  return d3.set(data.map(function(d) {\n      return d[accessor]; }))\n    .values();\n}\n\nfunction mg_get_color_domain(args) {\n  var color_domain;\n  if (args.color_domain === null) {\n    if (args.color_type === 'number') {\n      color_domain = d3.extent(args.data[0], function(d) {\n        return d[args.color_accessor]; });\n    } else if (args.color_type === 'category') {\n      color_domain = mg_get_categorical_domain(args.data[0], args.color_accessor);\n\n    }\n  } else {\n    color_domain = args.color_domain;\n  }\n  return color_domain;\n}\n\nfunction mg_get_color_range(args) {\n  var color_range;\n  if (args.color_range === null) {\n    if (args.color_type === 'number') {\n      color_range = ['blue', 'red'];\n    } else {\n      color_range = null;\n    }\n  } else {\n    color_range = args.color_range;\n  }\n  return color_range;\n}\n\nfunction processScaleTicks (args, axis) {\n  var accessor = args[axis + '_accessor'];\n  var scale_ticks = args.scales[axis.toUpperCase()].ticks(args[axis + 'ax_count']);\n  var max = args.processed['max_' + axis];\n\n  function log10 (val) {\n    if (val === 1000) {\n      return 3;\n    }\n    if (val === 1000000) {\n      return 7;\n    }\n    return Math.log(val) / Math.LN10;\n  }\n\n  if (args[axis + '_scale_type'] === 'log') {\n    // get out only whole logs\n    scale_ticks = scale_ticks.filter(function (d) {\n      return Math.abs(log10(d)) % 1 < 1e-6 || Math.abs(log10(d)) % 1 > 1 - 1e-6;\n    });\n  }\n\n  // filter out fraction ticks if our data is ints and if xmax > number of generated ticks\n  var number_of_ticks = scale_ticks.length;\n\n  // is our data object all ints?\n  var data_is_int = true;\n  args.data.forEach(function (d, i) {\n    d.forEach(function (d, i) {\n      if (d[accessor] % 1 !== 0) {\n        data_is_int = false;\n        return false;\n      }\n    });\n  });\n\n  if (data_is_int && number_of_ticks > max && args.format === 'count') {\n    // remove non-integer ticks\n    scale_ticks = scale_ticks.filter(function (d) {\n      return d % 1 === 0;\n    });\n  }\n  args.processed[axis + '_ticks'] = scale_ticks;\n}\n\nfunction rugPlacement (args, axisArgs) {\n  var position = axisArgs.position;\n  var ns = axisArgs.namespace;\n  var coordinates = {};\n  if (position === 'left') {\n    coordinates.x1 = mg_get_left(args) + 1;\n    coordinates.x2 = mg_get_left(args) + args.rug_buffer_size;\n    coordinates.y1 = args.scalefns[ns + 'f'];\n    coordinates.y2 = args.scalefns[ns + 'f'];\n  }\n  if (position === 'right') {\n    coordinates.x1 = mg_get_right(args) - 1,\n    coordinates.x2 = mg_get_right(args) - args.rug_buffer_size,\n    coordinates.y1 = args.scalefns[ns + 'f'];\n    coordinates.y2 = args.scalefns[ns + 'f'];\n  }\n  if (position === 'top') {\n    coordinates.x1 = args.scalefns[ns + 'f'];\n    coordinates.x2 = args.scalefns[ns + 'f'];\n    coordinates.y1 = mg_get_top(args) + 1;\n    coordinates.y2 = mg_get_top(args) + args.rug_buffer_size;\n  }\n  if (position === 'bottom') {\n    coordinates.x1 = args.scalefns[ns + 'f'];\n    coordinates.x2 = args.scalefns[ns + 'f'];\n    coordinates.y1 = mg_get_bottom(args) - 1;\n    coordinates.y2 = mg_get_bottom(args) - args.rug_buffer_size;\n  }\n  return coordinates;\n}\n\nfunction rimPlacement (args, axisArgs) {\n  var ns = axisArgs.namespace;\n  var position = axisArgs.position;\n  var tick_length = args.processed[ns + '_ticks'].length;\n  var ticks = args.processed[ns + '_ticks'];\n  var scale = args.scales[ns.toUpperCase()];\n  var coordinates = {};\n\n  if (position === 'left') {\n    coordinates.x1 = mg_get_left(args);\n    coordinates.x2 = mg_get_left(args);\n    coordinates.y1 = scale(ticks[0]).toFixed(2);\n    coordinates.y2 = scale(ticks[tick_length - 1]).toFixed(2);\n  }\n  if (position === 'right') {\n    coordinates.x1 = mg_get_right(args);\n    coordinates.x2 = mg_get_right(args);\n    coordinates.y1 = scale(ticks[0]).toFixed(2);\n    coordinates.y2 = scale(ticks[tick_length - 1]).toFixed(2);\n  }\n  if (position === 'top') {\n    coordinates.x1 = mg_get_left(args);\n    coordinates.x2 = mg_get_right(args);\n    coordinates.y1 = mg_get_top(args);\n    coordinates.y2 = mg_get_top(args);\n  }\n  if (position === 'bottom') {\n    coordinates.x1 = mg_get_left(args);\n    coordinates.x2 = mg_get_right(args);\n    coordinates.y1 = mg_get_bottom(args);\n    coordinates.y2 = mg_get_bottom(args);\n  }\n\n  if (position === 'left' || position === 'right') {\n    if (args.axes_not_compact) {\n      coordinates.y1 = mg_get_bottom(args);\n      coordinates.y2 = mg_get_top(args);\n    } else if (tick_length) {\n      coordinates.y1 = scale(ticks[0]).toFixed(2);\n      coordinates.y2 = scale(ticks[tick_length - 1]).toFixed(2);\n    }\n  }\n\n  return coordinates;\n}\n\nfunction labelPlacement (args, axisArgs) {\n  var position = axisArgs.position;\n  var ns = axisArgs.namespace;\n  var tickLength = args[ns + 'ax_tick_length'];\n  var scale = args.scales[ns.toUpperCase()];\n  var coordinates = {};\n\n  if (position === 'left') {\n    coordinates.x = mg_get_left(args) - tickLength * 3 / 2;\n    coordinates.y = function (d) {\n      return scale(d).toFixed(2);\n    };\n    coordinates.dx = -3;\n    coordinates.dy = '.35em';\n    coordinates.textAnchor = 'end';\n    coordinates.text = function (d) {\n      return mg_compute_yax_format(args)(d);\n    };\n  }\n  if (position === 'right') {\n    coordinates.x = mg_get_right(args) + tickLength * 3 / 2;\n    coordinates.y = function (d) {\n      return scale(d).toFixed(2);\n    };\n    coordinates.dx = 3;\n    coordinates.dy = '.35em';\n    coordinates.textAnchor = 'start';\n    coordinates.text = function (d) {\n      return mg_compute_yax_format(args)(d); };\n  }\n  if (position === 'top') {\n    coordinates.x = function (d) {\n      return scale(d).toFixed(2);\n    };\n    coordinates.y = (mg_get_top(args) - tickLength * 7 / 3).toFixed(2);\n    coordinates.dx = 0;\n    coordinates.dy = '0em';\n    coordinates.textAnchor = 'middle';\n    coordinates.text = function (d) {\n      return mg_default_xax_format(args)(d);\n    };\n  }\n  if (position === 'bottom') {\n    coordinates.x = function (d) {\n      return scale(d).toFixed(2);\n    };\n    coordinates.y = (mg_get_bottom(args) + tickLength * 7 / 3).toFixed(2);\n    coordinates.dx = 0;\n    coordinates.dy = '.50em';\n    coordinates.textAnchor = 'middle';\n    coordinates.text = function (d) {\n      return mg_default_xax_format(args)(d);\n    };\n  }\n\n  return coordinates;\n}\n\nfunction selectXaxFormat (args) {\n  var c = args.chart_type;\n  if (!args.processed.xax_format) {\n    if (args.xax_format) {\n      args.processed.xax_format = args.xax_format;\n    } else {\n      if (c === 'line' || c === 'point' || c === 'histogram') {\n        args.processed.xax_format = mg_default_xax_format(args);\n      } else if (c === 'bar') {\n        args.processed.xax_format = mg_default_bar_xax_format(args);\n      }\n    }\n  }\n}\n\nfunction secondaryLabels (g, args, axisArgs) {\n  if (args.time_series && (args.show_years || args.show_secondary_x_label)) {\n    var tf = mg_get_yformat_and_secondary_time_function(args);\n    addSecondaryLabelElements(args, axisArgs, g, tf.timeframe, tf.yformat, tf.secondary);\n  }\n}\n\nfunction addSecondaryLabelElements (args, axisArgs, g, time_frame, yformat, secondary_function) {\n  var years = secondary_function(args.processed.min_x, args.processed.max_x);\n  if (years.length === 0) {\n    var first_tick = args.scales.X.ticks(args.xax_count)[0];\n    years = [first_tick];\n  }\n\n  var yg = mg_add_g(g, 'mg-year-marker');\n  if (time_frame === 'default' && args.show_year_markers) {\n    yearMarkerLine(args, axisArgs, yg, years, yformat);\n  }\n  if (time_frame != 'years') yearMarkerText(args, axisArgs, yg, years, yformat);\n}\n\nfunction yearMarkerLine (args, axisArgs, g, years, yformat) {\n  g.selectAll('.mg-year-marker')\n    .data(years).enter()\n    .append('line')\n    .attr('x1', function (d) {\n      return args.scales.X(d).toFixed(2); })\n    .attr('x2', function (d) {\n      return args.scales.X(d).toFixed(2); })\n    .attr('y1', mg_get_top(args))\n    .attr('y2', mg_get_bottom(args));\n}\n\nfunction yearMarkerText (args, axisArgs, g, years, yformat) {\n  var position = axisArgs.position;\n  var ns = axisArgs.namespace;\n  var scale = args.scales[ns.toUpperCase()];\n  var x, y, dy, textAnchor, textFcn;\n  var xAxisTextElement = d3.select(args.target)\n    .select('.mg-x-axis text').node().getBoundingClientRect();\n\n  if (position === 'top') {\n    x = function (d, i) {\n      return scale(d).toFixed(2); };\n    y = (mg_get_top(args) - args.xax_tick_length * 7 / 3) - (xAxisTextElement.height);\n    dy = '.50em';\n    textAnchor = 'middle';\n    textFcn = function (d) {\n      return yformat(new Date(d)); };\n  }\n  if (position === 'bottom') {\n    x = function (d, i) {\n      return scale(d).toFixed(2); };\n    y = (mg_get_bottom(args) + args.xax_tick_length * 7 / 3) + (xAxisTextElement.height * 0.8);\n    dy = '.50em';\n    textAnchor = 'middle';\n    textFcn = function (d) {\n      return yformat(new Date(d)); };\n  }\n\n  g.selectAll('.mg-year-marker')\n    .data(years).enter()\n    .append('text')\n    .attr('x', x)\n    .attr('y', y)\n    .attr('dy', dy)\n    .attr('text-anchor', textAnchor)\n    .text(textFcn);\n}\n\nfunction addNumericalLabels (g, args, axisArgs) {\n  var ns = axisArgs.namespace;\n  var coords = labelPlacement(args, axisArgs);\n  var ticks = args.processed[ns + '_ticks'];\n\n  var labels = g.selectAll('.mg-yax-labels')\n    .data(ticks).enter()\n    .append('text')\n    .attr('x', coords.x)\n    .attr('dx', coords.dx)\n    .attr('y', coords.y)\n    .attr('dy', coords.dy)\n    .attr('text-anchor', coords.textAnchor)\n    .text(coords.text);\n\n  // move the labels if they overlap\n  if (ns == 'x') {\n    selectXaxFormat(args);\n    if (args.time_series && args.european_clock) {\n      labels.append('tspan').classed('mg-european-hours', true).text(function (_d, i) {\n        var d = new Date(_d);\n        if (i === 0) return d3.timeFormat('%H')(d);\n        else return '';\n      });\n      labels.append('tspan').classed('mg-european-minutes-seconds', true).text(function (_d, i) {\n        var d = new Date(_d);\n        return ':' + args.processed.xax_format(d);\n      });\n    } else {\n      labels.text(function (d) {\n        return args.xax_units + args.processed.xax_format(d);\n      });\n    }\n    secondaryLabels(g, args, axisArgs);\n  }\n\n  if (mg_elements_are_overlapping(labels)) {\n    labels.filter(function (d, i) {\n      return (i + 1) % 2 === 0;\n    }).remove();\n\n    var svg = mg_get_svg_child_of(args.target);\n    svg.selectAll('.mg-' + ns + 'ax-ticks').filter(function (d, i) {\n      return (i + 1) % 2 === 0; })\n      .remove();\n  }\n}\n\nfunction addTickLines (g, args, axisArgs) {\n  // name\n  var ns = axisArgs.namespace;\n  var position = axisArgs.position;\n  var scale = args.scales[ns.toUpperCase()];\n\n  var ticks = args.processed[ns + '_ticks'];\n  var ticksClass = 'mg-' + ns + 'ax-ticks';\n  var extendedTicksClass = 'mg-extended-' + ns + 'ax-ticks';\n  var extendedTicks = args[ns + '_extended_ticks'];\n  var tickLength = args[ns + 'ax_tick_length'];\n\n  var x1, x2, y1, y2;\n\n  if (position === 'left') {\n    x1 = mg_get_left(args);\n    x2 = extendedTicks ? mg_get_right(args) : mg_get_left(args) - tickLength;\n    y1 = function (d) {\n      return scale(d).toFixed(2);\n    };\n    y2 = function (d) {\n      return scale(d).toFixed(2);\n    };\n  }\n  if (position === 'right') {\n    x1 = mg_get_right(args);\n    x2 = extendedTicks ? mg_get_left(args) : mg_get_right(args) + tickLength;\n    y1 = function (d) {\n      return scale(d).toFixed(2);\n    };\n    y2 = function (d) {\n      return scale(d).toFixed(2);\n    };\n  }\n  if (position === 'top') {\n    x1 = function (d) {\n      return scale(d).toFixed(2);\n    };\n    x2 = function (d) {\n      return scale(d).toFixed(2);\n    };\n    y1 = mg_get_top(args);\n    y2 = extendedTicks ? mg_get_bottom(args) : mg_get_top(args) - tickLength;\n  }\n  if (position === 'bottom') {\n    x1 = function (d) {\n      return scale(d).toFixed(2);\n    };\n    x2 = function (d) {\n      return scale(d).toFixed(2);\n    };\n    y1 = mg_get_bottom(args);\n    y2 = extendedTicks ? mg_get_top(args) : mg_get_bottom(args) + tickLength;\n  }\n\n  g.selectAll('.' + ticksClass)\n    .data(ticks).enter()\n    .append('line')\n    .classed(extendedTicksClass, extendedTicks)\n    .attr('x1', x1)\n    .attr('x2', x2)\n    .attr('y1', y1)\n    .attr('y2', y2);\n}\n\nfunction initializeAxisRim (g, args, axisArgs) {\n  var namespace = axisArgs.namespace;\n  var tick_length = args.processed[namespace + '_ticks'].length;\n\n  var rim = rimPlacement(args, axisArgs);\n\n  if (!args[namespace + '_extended_ticks'] && !args[namespace + '_extended_ticks'] && tick_length) {\n    g.append('line')\n      .attr('x1', rim.x1)\n      .attr('x2', rim.x2)\n      .attr('y1', rim.y1)\n      .attr('y2', rim.y2);\n  }\n}\n\nfunction initializeRug (args, rug_class) {\n  var svg = mg_get_svg_child_of(args.target);\n  var all_data = mg_flatten_array(args.data);\n  var rug = svg.selectAll('line.' + rug_class).data(all_data);\n\n  // set the attributes that do not change after initialization, per\n  rug.enter().append('svg:line').attr('class', rug_class).attr('opacity', 0.3);\n\n  // remove rug elements that are no longer in use\n  mg_exit_and_remove(rug);\n\n  // set coordinates of new rug elements\n  mg_exit_and_remove(rug);\n  return rug;\n}\n\nfunction rug (args, axisArgs) {\n  'use strict';\n  args.rug_buffer_size = args.chart_type === 'point' ? args.buffer / 2 : args.buffer * 2 / 3;\n\n  var rug = initializeRug(args, 'mg-' + axisArgs.namespace + '-rug');\n  var rug_positions = rugPlacement(args, axisArgs);\n  rug.attr('x1', rug_positions.x1)\n    .attr('x2', rug_positions.x2)\n    .attr('y1', rug_positions.y1)\n    .attr('y2', rug_positions.y2);\n\n  mg_add_color_accessor_to_rug(rug, args, 'mg-' + axisArgs.namespace + '-rug-mono');\n}\n\nfunction categoricalLabelPlacement (args, axisArgs, group) {\n  var ns = axisArgs.namespace;\n  var position = axisArgs.position;\n  var scale = args.scales[ns.toUpperCase()];\n  var groupScale = args.scales[(ns + 'group').toUpperCase()];\n  var coords = {};\n  coords.cat = {};\n  coords.group = {};\n  // x, y, dy, text-anchor\n\n  if (position === 'left') {\n    coords.cat.x = mg_get_plot_left(args) - args.buffer;\n    coords.cat.y = function (d) {\n      return groupScale(group) + scale(d) + scale.bandwidth() / 2;\n    };\n    coords.cat.dy = '.35em';\n    coords.cat.textAnchor = 'end';\n    coords.group.x = mg_get_plot_left(args) - args.buffer;\n    coords.group.y = groupScale(group) + (groupScale.bandwidth ? groupScale.bandwidth() / 2 : 0);\n    coords.group.dy = '.35em';\n    coords.group.textAnchor = args['rotate_' + ns + '_labels'] ? 'end' : 'end';\n  }\n\n  if (position === 'right') {\n    coords.cat.x = mg_get_plot_right(args) - args.buffer;\n    coords.cat.y = function (d) {\n      return groupScale(group) + scale(d) + scale.bandwidth() / 2;\n    };\n    coords.cat.dy = '.35em';\n    coords.cat.textAnchor = 'start';\n    coords.group.x = mg_get_plot_right(args) - args.buffer;\n    coords.group.y = groupScale(group) + (groupScale.bandwidth ? groupScale.bandwidth() / 2 : 0);\n    coords.group.dy = '.35em';\n    coords.group.textAnchor = 'start';\n  }\n\n  if (position === 'top') {\n    coords.cat.x = function (d) {\n      return groupScale(group) + scale(d) + scale.bandwidth() / 2;\n    };\n    coords.cat.y = mg_get_plot_top(args) + args.buffer;\n    coords.cat.dy = '.35em';\n    coords.cat.textAnchor = args['rotate_' + ns + '_labels'] ? 'start' : 'middle';\n    coords.group.x = groupScale(group) + (groupScale.bandwidth ? groupScale.bandwidth() / 2 : 0);\n    coords.group.y = mg_get_plot_top(args) + args.buffer;\n    coords.group.dy = '.35em';\n    coords.group.textAnchor = args['rotate_' + ns + '_labels'] ? 'start' : 'middle';\n  }\n\n  if (position === 'bottom') {\n    coords.cat.x = function (d) {\n      return groupScale(group) + scale(d) + scale.bandwidth() / 2;\n    };\n    coords.cat.y = mg_get_plot_bottom(args) + args.buffer;\n    coords.cat.dy = '.35em';\n    coords.cat.textAnchor = args['rotate_' + ns + '_labels'] ? 'start' : 'middle';\n    coords.group.x = groupScale(group) + (groupScale.bandwidth ? groupScale.bandwidth() / 2 - scale.bandwidth() / 2 : 0);\n    coords.group.y = mg_get_plot_bottom(args) + args.buffer;\n    coords.group.dy = '.35em';\n    coords.group.textAnchor = args['rotate_' + ns + '_labels'] ? 'start' : 'middle';\n  }\n\n  return coords;\n}\n\nfunction categoricalLabels (args, axisArgs) {\n  var ns = axisArgs.namespace;\n  var nsClass = 'mg-' + ns + '-axis';\n  var scale = args.scales[ns.toUpperCase()];\n  var groupScale = args.scales[(ns + 'group').toUpperCase()];\n  var groupAccessor = ns + 'group_accessor';\n\n  var svg = mg_get_svg_child_of(args.target);\n  mg_selectAll_and_remove(svg, '.' + nsClass);\n  var g = mg_add_g(svg, nsClass);\n  var group_g;\n  var groups = groupScale.domain && groupScale.domain()\n    ? groupScale.domain()\n    : ['1'];\n\n  groups.forEach(function (group) {\n    // grab group placement stuff.\n    var coords = categoricalLabelPlacement(args, axisArgs, group);\n\n    group_g = mg_add_g(g, 'mg-group-' + mg_normalize(group));\n    if (args[groupAccessor] !== null) {\n      var labels = group_g.append('text')\n        .classed('mg-barplot-group-label', true)\n        .attr('x', coords.group.x)\n        .attr('y', coords.group.y)\n        .attr('dy', coords.group.dy)\n        .attr('text-anchor', coords.group.textAnchor)\n        .text(group);\n\n    } else {\n      var labels = group_g.selectAll('text')\n        .data(scale.domain())\n        .enter()\n        .append('text')\n        .attr('x', coords.cat.x)\n        .attr('y', coords.cat.y)\n        .attr('dy', coords.cat.dy)\n        .attr('text-anchor', coords.cat.textAnchor)\n        .text(String);\n    }\n    if (args['rotate_' + ns + '_labels']) {\n      rotateLabels(labels, args['rotate_' + ns + '_labels']);\n    }\n  });\n}\n\nfunction categoricalGuides (args, axisArgs) {\n  // for each group\n  // for each data point\n\n  var ns = axisArgs.namespace;\n  var scalef = args.scalefns[ns + 'f'];\n  var groupf = args.scalefns[ns + 'groupf'];\n  var groupScale = args.scales[(ns + 'group').toUpperCase()];\n  var scale = args.scales[ns.toUpperCase()];\n  var position = axisArgs.position;\n\n  var svg = mg_get_svg_child_of(args.target);\n  var alreadyPlotted = [];\n\n  var x1, x2, y1, y2;\n  var grs = (groupScale.domain && groupScale.domain()) ? groupScale.domain() : [null];\n\n  mg_selectAll_and_remove(svg, '.mg-category-guides');\n  var g = mg_add_g(svg, 'mg-category-guides');\n\n  grs.forEach(function (group) {\n    scale.domain().forEach(function (cat) {\n      if (position === 'left' || position === 'right') {\n        x1 = mg_get_plot_left(args);\n        x2 = mg_get_plot_right(args);\n        y1 = scale(cat) + groupScale(group) + scale.bandwidth() / 2;\n        y2 = scale(cat) + groupScale(group) + scale.bandwidth() / 2;\n      }\n\n      if (position === 'top' || position === 'bottom') {\n        x1 = scale(cat) + groupScale(group) + scale.bandwidth() / 2 * (group === null);\n        x2 = scale(cat) + groupScale(group) + scale.bandwidth() / 2 * (group === null);\n        y1 = mg_get_plot_bottom(args);\n        y2 = mg_get_plot_top(args);\n      }\n\n      g.append('line')\n        .attr('x1', x1)\n        .attr('x2', x2)\n        .attr('y1', y1)\n        .attr('y2', y2)\n        .attr('stroke-dasharray', '2,1');\n    });\n\n    var first = groupScale(group) + scale(scale.domain()[0]) + scale.bandwidth() / 2 * (group === null || (position !== 'top' && position != 'bottom'));\n    var last = groupScale(group) + scale(scale.domain()[scale.domain().length - 1]) + scale.bandwidth() / 2 * (group === null || (position !== 'top' && position != 'bottom'));\n\n    if (position === 'left' || position === 'right') {\n      x11 = mg_get_plot_left(args);\n      x21 = mg_get_plot_left(args);\n      y11 = first;\n      y21 = last;\n\n      x12 = mg_get_plot_right(args);\n      x22 = mg_get_plot_right(args);\n      y12 = first;\n      y22 = last;\n    }\n\n    if (position === 'bottom' || position === 'top') {\n      x11 = first;\n      x21 = last;\n      y11 = mg_get_plot_bottom(args);\n      y21 = mg_get_plot_bottom(args);\n\n      x12 = first;\n      x22 = last;\n      y12 = mg_get_plot_top(args);\n      y22 = mg_get_plot_top(args);\n    }\n\n    g.append('line')\n      .attr('x1', x11)\n      .attr('x2', x21)\n      .attr('y1', y11)\n      .attr('y2', y21)\n      .attr('stroke-dasharray', '2,1');\n\n    g.append('line')\n      .attr('x1', x12)\n      .attr('x2', x22)\n      .attr('y1', y12)\n      .attr('y2', y22)\n      .attr('stroke-dasharray', '2,1');\n  });\n}\n\nfunction rotateLabels (labels, rotation_degree) {\n  if (rotation_degree) {\n    labels.attr('transform', function () {\n      var elem = d3.select(this);\n      return 'rotate(' + rotation_degree + ' ' + elem.attr('x') + ',' + elem.attr('y') + ')';\n    });\n\n  }\n}\n\nfunction zeroLine (args, axisArgs) {\n  var svg = mg_get_svg_child_of(args.target);\n  var ns = axisArgs.namespace;\n  var position = axisArgs.position;\n  var scale = args.scales[ns.toUpperCase()];\n  var x1, x2, y1, y2;\n  if (position === 'left' || position === 'right') {\n    x1 = mg_get_plot_left(args);\n    x2 = mg_get_plot_right(args);\n    y1 = scale(0) + 1;\n    y2 = scale(0) + 1;\n  }\n  if (position === 'bottom' || position === 'top') {\n    y1 = mg_get_plot_top(args);\n    y2 = mg_get_plot_bottom(args);\n    x1 = scale(0) - 1;\n    x2 = scale(0) - 1;\n  }\n\n  svg.append('line')\n    .attr('x1', x1)\n    .attr('x2', x2)\n    .attr('y1', y1)\n    .attr('y2', y2)\n    .attr('stroke', 'black');\n}\n\nvar mgDrawAxis = {};\n\nmgDrawAxis.categorical = function (args, axisArgs) {\n  var ns = axisArgs.namespace;\n\n  categoricalLabels(args, axisArgs);\n  categoricalGuides(args, axisArgs);\n};\n\nmgDrawAxis.numerical = function (args, axisArgs) {\n  var namespace = axisArgs.namespace;\n  var axisName = namespace + '_axis';\n  var axisClass = 'mg-' + namespace + '-axis';\n  var svg = mg_get_svg_child_of(args.target);\n\n  mg_selectAll_and_remove(svg, '.' + axisClass);\n\n  if (!args[axisName]) {\n    return this;\n  }\n\n  var g = mg_add_g(svg, axisClass);\n\n  processScaleTicks(args, namespace);\n  initializeAxisRim(g, args, axisArgs);\n  addTickLines(g, args, axisArgs);\n  addNumericalLabels(g, args, axisArgs);\n\n  // add label\n  if (args[namespace + '_label']) {\n    axisArgs.label(svg.select('.mg-' + namespace + '-axis'), args);\n  }\n\n  // add rugs\n  if (args[namespace + '_rug']) {\n    rug(args, axisArgs);\n  }\n\n  if (args.show_bar_zero) {\n    mg_bar_add_zero_line(args);\n  }\n\n  return this;\n};\n\nfunction axisFactory (args) {\n  var axisArgs = {};\n  axisArgs.type = 'numerical';\n\n  this.namespace = function (ns) {\n    // take the ns in the scale, and use it to\n    axisArgs.namespace = ns;\n    return this;\n  };\n\n  this.rug = function (tf) {\n    axisArgs.rug = tf;\n    return this;\n  };\n\n  this.label = function (tf) {\n    axisArgs.label = tf;\n    return this;\n  };\n\n  this.type = function (t) {\n    axisArgs.type = t;\n    return this;\n  };\n\n  this.position = function (pos) {\n    axisArgs.position = pos;\n    return this;\n  };\n\n  this.zeroLine = function (tf) {\n    axisArgs.zeroLine = tf;\n    return this;\n  };\n\n  this.draw = function () {\n    mgDrawAxis[axisArgs.type](args, axisArgs);\n    return this;\n  };\n\n  return this;\n\n}\n\nMG.axis_factory = axisFactory;\n\n/* ================================================================================ */\n/* ================================================================================ */\n/* ================================================================================ */\n\nfunction y_rug (args) {\n  'use strict';\n\n  if (!args.y_rug) {\n    return;\n  }\n\n  args.rug_buffer_size = args.chart_type === 'point'\n    ? args.buffer / 2\n    : args.buffer * 2 / 3;\n\n  var rug = mg_make_rug(args, 'mg-y-rug');\n\n  rug.attr('x1', args.left + 1)\n    .attr('x2', args.left + args.rug_buffer_size)\n    .attr('y1', args.scalefns.yf)\n    .attr('y2', args.scalefns.yf);\n\n  mg_add_color_accessor_to_rug(rug, args, 'mg-y-rug-mono');\n}\n\nMG.y_rug = y_rug;\n\nfunction mg_change_y_extents_for_bars (args, my) {\n  if (args.chart_type === 'bar') {\n    my.min = 0;\n    my.max = d3.max(args.data[0], function (d) {\n      var trio = [];\n      trio.push(d[args.y_accessor]);\n\n      if (args.baseline_accessor !== null) {\n        trio.push(d[args.baseline_accessor]);\n      }\n\n      if (args.predictor_accessor !== null) {\n        trio.push(d[args.predictor_accessor]);\n      }\n\n      return Math.max.apply(null, trio);\n    });\n  }\n  return my;\n}\n\nfunction mg_compute_yax_format (args) {\n  var yax_format = args.yax_format;\n  if (!yax_format) {\n    if (args.format === 'count') {\n      // increase decimals if we have small values, useful for realtime data\n      if (args.processed.max_y < 0.0001) {\n        args.decimals = 6;\n      } else if (args.processed.max_y < 0.1) {\n        args.decimals = 4;\n      }\n\n      yax_format = function (d) {\n        var pf;\n\n        if (d < 1.0 && d > -1.0 && d !== 0) {\n          // don't scale tiny values\n          pf = d3.format(',.' + args.decimals + 'f');\n        } else if (d < 1000) {\n          pf = d3.format(',.0f');\n        } else {\n          pf = d3.format(',.2s');\n        }\n\n        // are we adding units after the value or before?\n        if (args.yax_units_append) {\n          return pf(d) + args.yax_units;\n        } else {\n          return args.yax_units + pf(d);\n        }\n      };\n    } else { // percentage\n      yax_format = function (d_) {\n        var n = d3.format('.0%');\n        return n(d_);\n      };\n    }\n  }\n  return yax_format;\n}\n\nfunction mg_bar_add_zero_line (args) {\n  var svg = mg_get_svg_child_of(args.target);\n  var extents = args.scales.X.domain();\n  if (0 >= extents[0] && extents[1] >= 0) {\n    var r = args.scales.Y.range();\n    var g = args.categorical_groups.length\n      ? args.scales.YGROUP(args.categorical_groups[args.categorical_groups.length - 1])\n      : args.scales.YGROUP();\n\n    svg.append('svg:line')\n      .attr('x1', args.scales.X(0))\n      .attr('x2', args.scales.X(0))\n      .attr('y1', r[0] + mg_get_plot_top(args))\n      .attr('y2', r[r.length - 1] + g)\n      .attr('stroke', 'black')\n      .attr('opacity', .2);\n  }\n}\n\nfunction set_min_max_y (args) {\n  // flatten data\n  // remove weird data, if log.\n  var data = mg_flatten_array(args.data);\n\n  if (args.y_scale_type === 'log') {\n    data = data.filter(function (d) {\n      return d[args.y_accessor] > 0;\n    });\n  }\n\n  if (args.baselines) {\n    data = data.concat(args.baselines);\n  }\n\n  var extents = d3.extent(data, function (d) {\n    return d[args.y_accessor];\n  });\n\n  var my = {};\n  my.min = extents[0];\n  my.max = extents[1];\n  // the default case is for the y-axis to start at 0, unless we explicitly want it\n  // to start at an arbitrary number or from the data's minimum value\n  if (my.min >= 0 && !args.min_y && !args.min_y_from_data) {\n    my.min = 0;\n  }\n\n  mg_change_y_extents_for_bars(args, my);\n  my.min = (args.min_y !== null) ? args.min_y : my.min;\n\n  my.max = (args.max_y !== null) ? args.max_y : (my.max < 0) ? my.max + (my.max - my.max * args.inflator) : my.max * args.inflator;\n\n  if (args.y_scale_type !== 'log' && my.min < 0) {\n    my.min = my.min - (my.min - my.min * args.inflator);\n  }\n\n  if (!args.min_y && args.min_y_from_data) {\n    var buff = (my.max - my.min) * .01;\n    my.min = extents[0] - buff;\n    my.max = extents[1] + buff;\n  }\n  args.processed.min_y = my.min;\n  args.processed.max_y = my.max;\n}\n\nfunction mg_y_domain_range (args, scale) {\n  scale.domain([args.processed.min_y, args.processed.max_y])\n    .range([mg_get_plot_bottom(args), args.top]);\n  return scale;\n}\n\nfunction mg_define_y_scales (args) {\n  var scale = (mg_is_function(args.y_scale_type))\n    ? args.y_scale_type()\n    : (args.y_scale_type === 'log')\n      ? d3.scaleLog()\n      : d3.scaleLinear();\n\n  if (args.y_scale_type === 'log') {\n    if (args.chart_type === 'histogram') {\n      // log histogram plots should start just below 1\n      // so that bins with single counts are visible\n      args.processed.min_y = 0.2;\n    } else {\n      if (args.processed.min_y <= 0) {\n        args.processed.min_y = 1;\n      }\n    }\n  }\n  args.scales.Y = mg_y_domain_range(args, scale);\n  args.scales.Y.clamp(args.y_scale_type === 'log');\n\n  // used for ticks and such, and designed to be paired with log or linear\n  args.scales.Y_axis = mg_y_domain_range(args, d3.scaleLinear());\n}\n\nfunction mg_add_y_label (g, args) {\n  if (args.y_label) {\n    g.append('text')\n      .attr('class', 'label')\n      .attr('x', function () {\n        return -1 * (mg_get_plot_top(args) +\n        ((mg_get_plot_bottom(args)) - (mg_get_plot_top(args))) / 2);\n      })\n      .attr('y', function () {\n        return args.left / 2;\n      })\n      .attr('dy', '0.4em')\n      .attr('text-anchor', 'middle')\n      .text(function (d) {\n        return args.y_label;\n      })\n      .attr('transform', function (d) {\n        return 'rotate(-90)';\n      });\n  }\n}\n\nfunction mg_add_y_axis_rim (g, args) {\n  var tick_length = args.processed.y_ticks.length;\n  if (!args.x_extended_ticks && !args.y_extended_ticks && tick_length) {\n    var y1scale, y2scale;\n\n    if (args.axes_not_compact && args.chart_type !== 'bar') {\n      y1scale = args.height - args.bottom;\n      y2scale = args.top;\n    } else if (tick_length) {\n      y1scale = args.scales.Y(args.processed.y_ticks[0]).toFixed(2);\n      y2scale = args.scales.Y(args.processed.y_ticks[tick_length - 1]).toFixed(2);\n    } else {\n      y1scale = 0;\n      y2scale = 0;\n    }\n\n    g.append('line')\n      .attr('x1', args.left)\n      .attr('x2', args.left)\n      .attr('y1', y1scale)\n      .attr('y2', y2scale);\n  }\n}\n\nfunction mg_add_y_axis_tick_lines (g, args) {\n  g.selectAll('.mg-yax-ticks')\n    .data(args.processed.y_ticks).enter()\n    .append('line')\n    .classed('mg-extended-yax-ticks', args.y_extended_ticks)\n    .attr('x1', args.left)\n    .attr('x2', function () {\n      return (args.y_extended_ticks) ? args.width - args.right : args.left - args.yax_tick_length;\n    })\n    .attr('y1', function (d) {\n      return args.scales.Y(d).toFixed(2);\n    })\n    .attr('y2', function (d) {\n      return args.scales.Y(d).toFixed(2);\n    });\n}\n\nfunction mg_add_y_axis_tick_labels (g, args) {\n  var yax_format = mg_compute_yax_format(args);\n  g.selectAll('.mg-yax-labels')\n    .data(args.processed.y_ticks).enter()\n    .append('text')\n    .attr('x', args.left - args.yax_tick_length * 3 / 2)\n    .attr('dx', -3)\n    .attr('y', function (d) {\n      return args.scales.Y(d).toFixed(2);\n    })\n    .attr('dy', '.35em')\n    .attr('text-anchor', 'end')\n    .text(function (d) {\n      var o = yax_format(d);\n      return o;\n    });\n}\n\n// TODO ought to be deprecated, only used by histogram\nfunction y_axis (args) {\n  if (!args.processed) {\n    args.processed = {};\n  }\n\n  var svg = mg_get_svg_child_of(args.target);\n  MG.call_hook('y_axis.process_min_max', args, args.processed.min_y, args.processed.max_y);\n  mg_selectAll_and_remove(svg, '.mg-y-axis');\n\n  if (!args.y_axis) {\n    return this;\n  }\n\n  var g = mg_add_g(svg, 'mg-y-axis');\n  mg_add_y_label(g, args);\n  mg_process_scale_ticks(args, 'y');\n  mg_add_y_axis_rim(g, args);\n  mg_add_y_axis_tick_lines(g, args);\n  mg_add_y_axis_tick_labels(g, args);\n\n  if (args.y_rug) {\n    y_rug(args);\n  }\n\n  return this;\n}\n\nMG.y_axis = y_axis;\n\nfunction mg_add_categorical_labels (args) {\n  var svg = mg_get_svg_child_of(args.target);\n  mg_selectAll_and_remove(svg, '.mg-y-axis');\n  var g = mg_add_g(svg, 'mg-y-axis');\n  var group_g;(args.categorical_groups.length ? args.categorical_groups : ['1']).forEach(function (group) {\n    group_g = mg_add_g(g, 'mg-group-' + mg_normalize(group));\n\n    if (args.ygroup_accessor !== null) {\n      mg_add_group_label(group_g, group, args);\n    } else {\n      var labels = mg_add_graphic_labels(group_g, group, args);\n      mg_rotate_labels(labels, args.rotate_y_labels);\n    }\n  });\n}\n\nfunction mg_add_graphic_labels (g, group, args) {\n  return g.selectAll('text').data(args.scales.Y.domain()).enter().append('svg:text')\n    .attr('x', args.left - args.buffer)\n    .attr('y', function (d) {\n      return args.scales.YGROUP(group) + args.scales.Y(d) + args.scales.Y.bandwidth() / 2;\n    })\n    .attr('dy', '.35em')\n    .attr('text-anchor', 'end')\n    .text(String);\n}\n\nfunction mg_add_group_label (g, group, args) {\n  g.append('svg:text')\n    .classed('mg-barplot-group-label', true)\n    .attr('x', args.left - args.buffer)\n    .attr('y', args.scales.YGROUP(group) + args.scales.YGROUP.bandwidth() / 2)\n    .attr('dy', '.35em')\n    .attr('text-anchor', 'end')\n    .text(group);\n}\n\nfunction mg_draw_group_lines (args) {\n  var svg = mg_get_svg_child_of(args.target);\n  var groups = args.scales.YGROUP.domain();\n  var first = groups[0];\n  var last = groups[groups.length - 1];\n\n  svg.select('.mg-category-guides').selectAll('mg-group-lines')\n    .data(groups)\n    .enter().append('line')\n      .attr('x1', mg_get_plot_left(args))\n      .attr('x2', mg_get_plot_left(args))\n      .attr('y1', function (d) {\n        return args.scales.YGROUP(d);\n      })\n      .attr('y2', function (d) {\n        return args.scales.YGROUP(d) + args.ygroup_height;\n      })\n      .attr('stroke-width', 1);\n}\n\nfunction mg_y_categorical_show_guides (args) {\n  // for each group\n  // for each data point\n  var svg = mg_get_svg_child_of(args.target);\n  var alreadyPlotted = [];\n  args.data[0].forEach(function (d) {\n    if (alreadyPlotted.indexOf(d[args.y_accessor]) === -1) {\n      svg.select('.mg-category-guides').append('line')\n        .attr('x1', mg_get_plot_left(args))\n        .attr('x2', mg_get_plot_right(args))\n        .attr('y1', args.scalefns.yf(d) + args.scalefns.ygroupf(d))\n        .attr('y2', args.scalefns.yf(d) + args.scalefns.ygroupf(d))\n        .attr('stroke-dasharray', '2,1');\n    }\n  });\n}\n\nfunction y_axis_categorical (args) {\n  if (!args.y_axis) {\n    return this;\n  }\n\n  mg_add_categorical_labels(args);\n  // mg_draw_group_scaffold(args);\n  if (args.show_bar_zero) mg_bar_add_zero_line(args);\n  if (args.ygroup_accessor) mg_draw_group_lines(args);\n  if (args.y_categorical_show_guides) mg_y_categorical_show_guides(args);\n  return this;\n}\n\nMG.y_axis_categorical = y_axis_categorical;\n\nfunction x_rug(args) {\n  'use strict';\n\n  if(!args.x_rug) {\n    return;\n  }\n\n  args.rug_buffer_size = args.chart_type === 'point'\n    ? args.buffer / 2\n    : args.buffer;\n\n  var rug = mg_make_rug(args, 'mg-x-rug');\n\n  rug.attr('x1', args.scalefns.xf)\n    .attr('x2', args.scalefns.xf)\n    .attr('y1', args.height - args.bottom - args.rug_buffer_size)\n    .attr('y2', args.height - args.bottom);\n\n  mg_add_color_accessor_to_rug(rug, args, 'mg-x-rug-mono');\n}\n\nMG.x_rug = x_rug;\n\nfunction mg_add_processed_object(args) {\n  if (!args.processed) {\n    args.processed = {};\n  }\n}\n\n// TODO ought to be deprecated, only used by histogram\nfunction x_axis(args) {\n  'use strict';\n\n  var svg = mg_get_svg_child_of(args.target);\n  mg_add_processed_object(args);\n\n  mg_select_xax_format(args);\n  mg_selectAll_and_remove(svg, '.mg-x-axis');\n\n  if (!args.x_axis) {\n    return this;\n  }\n\n  var g = mg_add_g(svg, 'mg-x-axis');\n\n  mg_add_x_ticks(g, args);\n  mg_add_x_tick_labels(g, args);\n  if (args.x_label) { mg_add_x_label(g, args); }\n  if (args.x_rug) { x_rug(args); }\n\n  return this;\n}\n\nMG.x_axis = x_axis;\n\nfunction x_axis_categorical(args) {\n  var svg = mg_get_svg_child_of(args.target);\n  var additional_buffer = 0;\n  if (args.chart_type === 'bar') {\n    additional_buffer = args.buffer + 5;\n  }\n\n  mg_add_categorical_scale(args, 'X', args.categorical_variables.reverse(), args.left, mg_get_plot_right(args) - additional_buffer);\n  mg_add_scale_function(args, 'xf', 'X', 'value');\n  mg_selectAll_and_remove(svg, '.mg-x-axis');\n\n  var g = mg_add_g(svg, 'mg-x-axis');\n\n  if (!args.x_axis) {\n    return this;\n  }\n\n  mg_add_x_axis_categorical_labels(g, args, additional_buffer);\n  return this;\n}\n\nfunction mg_add_x_axis_categorical_labels(g, args, additional_buffer) {\n  var labels = g.selectAll('text')\n    .data(args.categorical_variables)\n    .enter()\n    .append('text');\n\n  labels\n    .attr('x', function(d) {\n      return args.scales.X(d) + args.scales.X.bandwidth() / 2 + (args.buffer) * args.bar_outer_padding_percentage + (additional_buffer / 2);\n    })\n    .attr('y', mg_get_plot_bottom(args))\n    .attr('dy', '.35em')\n    .attr('text-anchor', 'middle')\n    .text(String);\n\n  if (args.truncate_x_labels) {\n    labels.each(function(d, idx) {\n      var elem = this, width = args.scales.X.bandwidth();\n      truncate_text(elem, d, width);\n    });\n  }\n  mg_rotate_labels(labels, args.rotate_x_labels);\n}\n\nMG.x_axis_categorical = x_axis_categorical;\n\nfunction mg_point_add_color_scale(args) {\n  var color_domain, color_range;\n\n  if (args.color_accessor !== null) {\n    color_domain = mg_get_color_domain(args);\n    color_range = mg_get_color_range(args);\n\n    if (args.color_type === 'number') {\n      args.scales.color = d3.scaleLinear()\n        .domain(color_domain)\n        .range(color_range)\n        .clamp(true);\n    } else {\n      args.scales.color = args.color_range !== null\n        ? d3.scaleOrdinal().range(color_range)\n        : (color_domain.length > 10\n          ? d3.scaleOrdinal(d3.schemeCategory20)\n          : d3.scaleOrdinal(d3.schemeCategory10));\n\n      args.scales.color.domain(color_domain);\n    }\n    mg_add_scale_function(args, 'color', 'color', args.color_accessor);\n  }\n}\n\nfunction mg_get_color_domain(args) {\n  var color_domain;\n  if (args.color_domain === null) {\n    if (args.color_type === 'number') {\n      color_domain = d3.extent(args.data[0], function(d) {\n        return d[args.color_accessor];\n      });\n    } else if (args.color_type === 'category') {\n      color_domain = d3.set(args.data[0]\n          .map(function(d) {\n            return d[args.color_accessor];\n        }))\n        .values();\n\n      color_domain.sort();\n    }\n  } else {\n    color_domain = args.color_domain;\n  }\n  return color_domain;\n}\n\nfunction mg_get_color_range(args) {\n  var color_range;\n  if (args.color_range === null) {\n    if (args.color_type === 'number') {\n      color_range = ['blue', 'red'];\n    } else {\n      color_range = null;\n    }\n  } else {\n    color_range = args.color_range;\n  }\n  return color_range;\n}\n\nfunction mg_point_add_size_scale(args) {\n  var min_size, max_size, size_domain, size_range;\n  if (args.size_accessor !== null) {\n    size_domain = mg_get_size_domain(args);\n    size_range = mg_get_size_range(args);\n\n    args.scales.size = d3.scaleLinear()\n      .domain(size_domain)\n      .range(size_range)\n      .clamp(true);\n\n    mg_add_scale_function(args, 'size', 'size', args.size_accessor);\n  }\n}\n\nfunction mg_get_size_domain(args) {\n  return (args.size_domain === null)\n    ? d3.extent(args.data[0], function(d) { return d[args.size_accessor]; })\n    : args.size_domain;\n}\n\nfunction mg_get_size_range(args) {\n  var size_range;\n  if (args.size_range === null) {\n    size_range = [1, 5];\n  } else {\n    size_range = args.size_range;\n  }\n  return size_range;\n}\n\nfunction mg_add_x_label(g, args) {\n  if (args.x_label) {\n    g.append('text')\n      .attr('class', 'label')\n      .attr('x', function() {\n        return mg_get_plot_left(args) + (mg_get_plot_right(args) - mg_get_plot_left(args)) / 2;\n      })\n      .attr('dx', args.x_label_nudge_x != null ? args.x_label_nudge_x : 0)\n      .attr('y', function() {\n        var xAxisTextElement = d3.select(args.target)\n          .select('.mg-x-axis text').node().getBoundingClientRect();\n        return mg_get_bottom(args) + args.xax_tick_length * (7 / 3) + xAxisTextElement.height * 0.8 + 10;\n      })\n      .attr('dy', '.5em')\n      .attr('text-anchor', 'middle')\n      .text(function(d) {\n        return args.x_label;\n      });\n  }\n}\n\nfunction mg_default_bar_xax_format(args) {\n  return function(d) {\n    if (d < 1.0 && d > -1.0 && d !== 0) {\n      // don't scale tiny values\n      return args.xax_units + d.toFixed(args.decimals);\n    } else {\n      var pf = d3.format(',.0f');\n      return args.xax_units + pf(d);\n    }\n  };\n}\n\nfunction mg_get_time_frame(diff) {\n  // diff should be (max_x - min_x) / 1000, in other words, the difference in seconds.\n  var time_frame;\n  if (mg_milisec_diff(diff)) {\n    time_frame = 'millis';\n  } else if (mg_sec_diff(diff)) {\n    time_frame = 'seconds';\n  } else if (mg_day_diff(diff)) {\n    time_frame = 'less-than-a-day';\n  } else if (mg_four_days(diff)) {\n    time_frame = 'four-days';\n  } else if (mg_many_days(diff)) { // a handful of months?\n    time_frame = 'many-days';\n  } else if (mg_many_months(diff)) {\n    time_frame = 'many-months';\n  } else if (mg_years(diff)) {\n    time_frame = 'years';\n  } else {\n    time_frame = 'default';\n  }\n  return time_frame;\n}\n\nfunction mg_milisec_diff(diff) {\n  return diff < 10;\n}\n\nfunction mg_sec_diff(diff) {\n  return diff < 60;\n}\n\nfunction mg_day_diff(diff) {\n  return diff / (60 * 60) <= 24;\n}\n\nfunction mg_four_days(diff) {\n  return diff / (60 * 60) <= 24 * 4;\n}\n\nfunction mg_many_days(diff) {\n  return diff / (60 * 60 * 24) <= 93;\n}\n\nfunction mg_many_months(diff) {\n  return diff / (60 * 60 * 24) < 365 * 2;\n}\n\nfunction mg_years(diff) {\n  return diff / (60 * 60 * 24) >= 365 * 2;\n}\n\nfunction mg_get_time_format(utc, diff) {\n  var main_time_format;\n  if (mg_milisec_diff(diff)) {\n    main_time_format = MG.time_format(utc, '%M:%S.%L');\n  } else if (mg_sec_diff(diff)) {\n    main_time_format = MG.time_format(utc, '%M:%S');\n  } else if (mg_day_diff(diff)) {\n    main_time_format = MG.time_format(utc, '%H:%M');\n  } else if (mg_four_days(diff)) {\n    main_time_format = MG.time_format(utc, '%H:%M');\n  } else if (mg_many_days(diff)) {\n    main_time_format = MG.time_format(utc, '%b %d');\n  } else if (mg_many_months(diff)) {\n    main_time_format = MG.time_format(utc, '%b');\n  } else {\n    main_time_format = MG.time_format(utc, '%Y');\n  }\n  return main_time_format;\n}\n\nfunction mg_process_time_format(args) {\n  var diff;\n  var main_time_format;\n  var time_frame;\n\n  if (args.time_series) {\n    diff = (args.processed.max_x - args.processed.min_x) / 1000;\n    time_frame = mg_get_time_frame(diff);\n    main_time_format = mg_get_time_format(args.utc_time, diff);\n  }\n\n  args.processed.main_x_time_format = main_time_format;\n  args.processed.x_time_frame = time_frame;\n}\n\nfunction mg_default_xax_format(args) {\n  if (args.xax_format) {\n    return args.xax_format;\n  }\n\n  var data = args.processed.original_data || args.data;\n  var flattened = mg_flatten_array(data)[0];\n  var test_point_x = flattened[args.processed.original_x_accessor || args.x_accessor];\n  if (test_point_x === undefined) {\n    test_point_x = flattened;\n  }\n\n  return function(d) {\n    mg_process_time_format(args);\n\n    if (mg_is_date(test_point_x)) {\n      return args.processed.main_x_time_format(new Date(d));\n    } else if (typeof test_point_x === 'number') {\n      var is_float = d % 1 !== 0;\n      var pf;\n\n      if (is_float) {\n        pf = d3.format(',.' + args.decimals + 'f');\n      } else if (d < 1000) {\n        pf = d3.format(',.0f');\n      } else {\n        pf = d3.format(',.2s');\n      }\n      return args.xax_units + pf(d);\n    } else {\n      return args.xax_units + d;\n    }\n  };\n}\n\nfunction mg_add_x_ticks(g, args) {\n  mg_process_scale_ticks(args, 'x');\n  mg_add_x_axis_rim(args, g);\n  mg_add_x_axis_tick_lines(args, g);\n}\n\nfunction mg_add_x_axis_rim(args, g) {\n  var tick_length = args.processed.x_ticks.length;\n  var last_i = args.scales.X.ticks(args.xax_count).length - 1;\n\n  if (!args.x_extended_ticks) {\n    g.append('line')\n      .attr('x1', function() {\n        if (args.xax_count === 0) {\n          return mg_get_plot_left(args);\n        } else if (args.axes_not_compact && args.chart_type !== 'bar') {\n          return args.left;\n        } else {\n          return (args.scales.X(args.scales.X.ticks(args.xax_count)[0])).toFixed(2);\n        }\n      })\n      .attr('x2', function() {\n        if (args.xax_count === 0 || (args.axes_not_compact && args.chart_type !== 'bar')) {\n          return mg_get_right(args);\n        } else {\n          return args.scales.X(args.scales.X.ticks(args.xax_count)[last_i]).toFixed(2);\n        }\n      })\n      .attr('y1', args.height - args.bottom)\n      .attr('y2', args.height - args.bottom);\n  }\n}\n\nfunction mg_add_x_axis_tick_lines(args, g) {\n  g.selectAll('.mg-xax-ticks')\n    .data(args.processed.x_ticks).enter()\n    .append('line')\n    .attr('x1', function(d) {\n      return args.scales.X(d).toFixed(2); })\n    .attr('x2', function(d) {\n      return args.scales.X(d).toFixed(2); })\n    .attr('y1', args.height - args.bottom)\n    .attr('y2', function() {\n      return (args.x_extended_ticks) ? args.top : args.height - args.bottom + args.xax_tick_length;\n    })\n    .attr('class', function() {\n      if (args.x_extended_ticks) {\n        return 'mg-extended-xax-ticks';\n      }\n    })\n    .classed('mg-xax-ticks', true);\n}\n\nfunction mg_add_x_tick_labels(g, args) {\n  mg_add_primary_x_axis_label(args, g);\n  mg_add_secondary_x_axis_label(args, g);\n}\n\nfunction mg_add_primary_x_axis_label(args, g) {\n  var labels = g.selectAll('.mg-xax-labels')\n    .data(args.processed.x_ticks).enter()\n    .append('text')\n    .attr('x', function(d) {\n      return args.scales.X(d).toFixed(2);\n    })\n    .attr('y', (args.height - args.bottom + args.xax_tick_length * 7 / 3).toFixed(2))\n    .attr('dy', '.50em')\n    .attr('text-anchor', 'middle');\n\n  if (args.time_series && args.european_clock) {\n    labels.append('tspan').classed('mg-european-hours', true).text(function(_d, i) {\n      var d = new Date(_d);\n      if (i === 0) return d3.timeFormat('%H')(d);\n      else return '';\n    });\n    labels.append('tspan').classed('mg-european-minutes-seconds', true).text(function(_d, i) {\n      var d = new Date(_d);\n      return ':' + args.processed.xax_format(d);\n    });\n  } else {\n    labels.text(function(d) {\n      return args.xax_units + args.processed.xax_format(d);\n    });\n  }\n\n  // CHECK TO SEE IF OVERLAP for labels. If so,\n  // remove half of them. This is a dirty hack.\n  // We will need to figure out a more principled way of doing this.\n  if (mg_elements_are_overlapping(labels)) {\n    labels.filter(function(d, i) {\n      return (i + 1) % 2 === 0;\n    }).remove();\n\n    var svg = mg_get_svg_child_of(args.target);\n    svg.selectAll('.mg-xax-ticks')\n      .filter(function(d, i) {\n        return (i + 1) % 2 === 0;\n      })\n      .remove();\n  }\n}\n\nfunction mg_add_secondary_x_axis_label(args, g) {\n  if (args.time_series && (args.show_years || args.show_secondary_x_label)) {\n    var tf = mg_get_yformat_and_secondary_time_function(args);\n    mg_add_secondary_x_axis_elements(args, g, tf.timeframe, tf.yformat, tf.secondary);\n  }\n}\n\nfunction mg_get_yformat_and_secondary_time_function(args) {\n  var tf = {};\n  tf.timeframe = args.processed.x_time_frame;\n  switch (tf.timeframe) {\n    case 'millis':\n    case 'seconds':\n      tf.secondary = d3.timeDays;\n      if (args.european_clock) tf.yformat = MG.time_format(args.utc_time, '%b %d');\n      else tf.yformat = MG.time_format(args.utc_time, '%I %p');\n      break;\n    case 'less-than-a-day':\n      tf.secondary = d3.timeDays;\n      tf.yformat = MG.time_format(args.utc_time, '%b %d');\n      break;\n    case 'four-days':\n      tf.secondary = d3.timeDays;\n      tf.yformat = MG.time_format(args.utc_time, '%b %d');\n      break;\n    case 'many-days':\n      tf.secondary = d3.timeYears;\n      tf.yformat = MG.time_format(args.utc_time, '%Y');\n      break;\n    case 'many-months':\n      tf.secondary = d3.timeYears;\n      tf.yformat = MG.time_format(args.utc_time, '%Y');\n      break;\n    default:\n      tf.secondary = d3.timeYears;\n      tf.yformat = MG.time_format(args.utc_time, '%Y');\n  }\n  return tf;\n}\n\nfunction mg_add_secondary_x_axis_elements(args, g, time_frame, yformat, secondary_function) {\n  var years = secondary_function(args.processed.min_x, args.processed.max_x);\n  if (years.length === 0) {\n    var first_tick = args.scales.X.ticks(args.xax_count)[0];\n    years = [first_tick];\n  }\n\n  var yg = mg_add_g(g, 'mg-year-marker');\n  if (time_frame === 'default' && args.show_year_markers) {\n    mg_add_year_marker_line(args, yg, years, yformat);\n  }\n  if (time_frame != 'years') mg_add_year_marker_text(args, yg, years, yformat);\n}\n\nfunction mg_add_year_marker_line(args, g, years, yformat) {\n  g.selectAll('.mg-year-marker')\n    .data(years).enter()\n    .append('line')\n    .attr('x1', function(d) {\n      return args.scales.X(d).toFixed(2);\n    })\n    .attr('x2', function(d) {\n      return args.scales.X(d).toFixed(2);\n    })\n    .attr('y1', mg_get_top(args))\n    .attr('y2', mg_get_bottom(args));\n}\n\nfunction mg_add_year_marker_text(args, g, years, yformat) {\n  g.selectAll('.mg-year-marker')\n    .data(years).enter()\n    .append('text')\n    .attr('x', function(d, i) {\n      return args.scales.X(d).toFixed(2);\n    })\n    .attr('y', function() {\n      var xAxisTextElement = d3.select(args.target)\n        .select('.mg-x-axis text').node().getBoundingClientRect();\n      return (mg_get_bottom(args) + args.xax_tick_length * 7 / 3) + (xAxisTextElement.height * 0.8);\n    })\n    .attr('dy', '.50em')\n    .attr('text-anchor', 'middle')\n    .text(function(d) {\n      return yformat(new Date(d));\n    });\n}\n\nfunction mg_min_max_x_for_nonbars(mx, args, data) {\n  var extent_x = d3.extent(data, function(d) {\n    return d[args.x_accessor];\n  });\n  mx.min = extent_x[0];\n  mx.max = extent_x[1];\n}\n\nfunction mg_min_max_x_for_bars(mx, args, data) {\n  mx.min = d3.min(data, function(d) {\n    var trio = [\n      d[args.x_accessor],\n      (d[args.baseline_accessor]) ? d[args.baseline_accessor] : 0,\n      (d[args.predictor_accessor]) ? d[args.predictor_accessor] : 0\n    ];\n    return Math.min.apply(null, trio);\n  });\n\n  if (mx.min > 0) mx.min = 0;\n\n  mx.max = d3.max(data, function(d) {\n    var trio = [\n      d[args.x_accessor],\n      (d[args.baseline_accessor]) ? d[args.baseline_accessor] : 0,\n      (d[args.predictor_accessor]) ? d[args.predictor_accessor] : 0\n    ];\n    return Math.max.apply(null, trio);\n  });\n  return mx;\n}\n\nfunction mg_min_max_x_for_dates(mx) {\n  var yesterday = MG.clone(mx.min).setDate(mx.min.getDate() - 1);\n  var tomorrow = MG.clone(mx.min).setDate(mx.min.getDate() + 1);\n  mx.min = yesterday;\n  mx.max = tomorrow;\n}\n\nfunction mg_min_max_x_for_numbers(mx) {\n  // TODO do we want to rewrite this?\n  mx.min = mx.min - 1;\n  mx.max = mx.max + 1;\n}\n\nfunction mg_min_max_x_for_strings(mx) {\n  // TODO shouldn't be allowing strings here to be coerced into numbers\n  mx.min = Number(mx.min) - 1;\n  mx.max = Number(mx.max) + 1;\n}\n\nfunction mg_force_xax_count_to_be_two(args) {\n  args.xax_count = 2;\n}\n\nfunction mg_sort_through_data_type_and_set_x_min_max_accordingly(mx, args, data) {\n  if (args.chart_type === 'line' || args.chart_type === 'point' || args.chart_type === 'histogram') {\n    mg_min_max_x_for_nonbars(mx, args, data);\n\n  } else if (args.chart_type === 'bar') {\n    mg_min_max_x_for_bars(mx, args, data);\n  }\n  // if data set is of length 1, expand the range so that we can build the x-axis\n  if (mx.min === mx.max && !(args.min_x && args.max_x)) {\n    if (mg_is_date(mx.min)) {\n      mg_min_max_x_for_dates(mx);\n    } else if (typeof min_x === 'number') {\n      mg_min_max_x_for_numbers(mx);\n    } else if (typeof min_x === 'string') {\n      mg_min_max_x_for_strings(mx);\n    }\n    // force xax_count to be 2\n    mg_force_xax_count_to_be_two(args);\n  }\n}\n\nfunction mg_select_xax_format(args) {\n  var c = args.chart_type;\n  if (!args.processed.xax_format) {\n    if (args.xax_format) {\n      args.processed.xax_format = args.xax_format;\n    } else {\n      if (c === 'line' || c === 'point' || c === 'histogram') {\n        args.processed.xax_format = mg_default_xax_format(args);\n      } else if (c === 'bar') {\n        args.processed.xax_format = mg_default_bar_xax_format(args);\n      }\n    }\n  }\n}\n\nfunction mg_merge_args_with_defaults(args) {\n  var defaults = {\n    target: null,\n    title: null,\n    description: null\n  };\n\n  if (!args) {\n    args = {};\n  }\n\n  if (!args.processed) {\n    args.processed = {};\n  }\n\n  args = merge_with_defaults(args, defaults);\n  return args;\n}\n\nfunction mg_is_time_series(args) {\n  var first_elem = mg_flatten_array(args.processed.original_data || args.data)[0];\n  args.time_series = mg_is_date(first_elem[args.processed.original_x_accessor || args.x_accessor]);\n}\n\nfunction mg_init_compute_width(args) {\n  var svg_width = args.width;\n  if (args.full_width) {\n    svg_width = get_width(args.target);\n  }\n  if (args.x_axis_type === 'categorical' && svg_width === null) {\n    svg_width = mg_categorical_calculate_height(args, 'x');\n  }\n\n  args.width = svg_width;\n}\n\nfunction mg_init_compute_height(args) {\n  var svg_height = args.height;\n  if (args.full_height) {\n    svg_height = get_height(args.target);\n  }\n  if (args.y_axis_type === 'categorical' && svg_height === null) {\n    svg_height = mg_categorical_calculate_height(args, 'y');\n  }\n\n  args.height = svg_height;\n}\n\nfunction mg_remove_svg_if_chart_type_has_changed(svg, args) {\n  if ((!svg.selectAll('.mg-main-line').empty() && args.chart_type !== 'line') ||\n    (!svg.selectAll('.mg-points').empty() && args.chart_type !== 'point') ||\n    (!svg.selectAll('.mg-histogram').empty() && args.chart_type !== 'histogram') ||\n    (!svg.selectAll('.mg-barplot').empty() && args.chart_type !== 'bar')\n  ) {\n    svg.remove();\n  }\n}\n\nfunction mg_add_svg_if_it_doesnt_exist(svg, args) {\n  if (mg_get_svg_child_of(args.target).empty()) {\n    svg = d3.select(args.target)\n      .append('svg')\n      .classed('linked', args.linked)\n      .attr('width', args.width)\n      .attr('height', args.height);\n  }\n  return svg;\n}\n\nfunction mg_add_clip_path_for_plot_area(svg, args) {\n  svg.selectAll('.mg-clip-path').remove();\n  svg.append('defs')\n    .attr('class', 'mg-clip-path')\n    .append('clipPath')\n    .attr('id', 'mg-plot-window-' + mg_target_ref(args.target))\n    .append('svg:rect')\n    .attr('x', mg_get_left(args))\n    .attr('y', mg_get_top(args))\n    .attr('width', args.width - args.left - args.right - args.buffer)\n    .attr('height', args.height - args.top - args.bottom - args.buffer + 1);\n}\n\nfunction mg_adjust_width_and_height_if_changed(svg, args) {\n  if (args.width !== Number(svg.attr('width'))) {\n    svg.attr('width', args.width);\n  }\n  if (args.height !== Number(svg.attr('height'))) {\n    svg.attr('height', args.height);\n  }\n}\n\nfunction mg_set_viewbox_for_scaling(svg, args) {\n  // we need to reconsider how we handle automatic scaling\n  svg.attr('viewBox', '0 0 ' + args.width + ' ' + args.height);\n  if (args.full_width || args.full_height) {\n    svg.attr('preserveAspectRatio', 'xMinYMin meet');\n  }\n}\n\nfunction mg_remove_missing_classes_and_text(svg) {\n  // remove missing class\n  svg.classed('mg-missing', false);\n\n  // remove missing text\n  svg.selectAll('.mg-missing-text').remove();\n  svg.selectAll('.mg-missing-pane').remove();\n}\n\nfunction mg_remove_outdated_lines(svg, args) {\n  // if we're updating an existing chart and we have fewer lines than\n  // before, remove the outdated lines, e.g. if we had 3 lines, and we're calling\n  // data_graphic() on the same target with 2 lines, remove the 3rd line\n\n  var i = 0;\n\n  if (svg.selectAll('.mg-main-line').nodes().length >= args.data.length) {\n    // now, the thing is we can't just remove, say, line3 if we have a custom\n    // line-color map, instead, see which are the lines to be removed, and delete those\n    if (args.custom_line_color_map.length > 0) {\n      var array_full_series = function(len) {\n        var arr = new Array(len);\n        for (var i = 0; i < arr.length; i++) { arr[i] = i + 1; }\n        return arr;\n      };\n\n      // get an array of lines ids to remove\n      var lines_to_remove = arr_diff(\n        array_full_series(args.max_data_size),\n        args.custom_line_color_map);\n\n      for (i = 0; i < lines_to_remove.length; i++) {\n        svg.selectAll('.mg-main-line.mg-line' + lines_to_remove[i] + '-color')\n          .remove();\n      }\n    } else {\n      // if we don't have a custom line-color map, just remove the lines from the end\n      var num_of_new = args.data.length;\n      var num_of_existing = (svg.selectAll('.mg-main-line').nodes()) ? svg.selectAll('.mg-main-line').nodes().length : 0;\n\n      for (i = num_of_existing; i > num_of_new; i--) {\n        svg.selectAll('.mg-main-line.mg-line' + i + '-color')\n          .remove();\n      }\n    }\n  }\n}\n\nfunction mg_raise_container_error(container, args) {\n  if (container.empty()) {\n    console.warn('The specified target element \"' + args.target + '\" could not be found in the page. The chart will not be rendered.');\n    return;\n  }\n}\n\nfunction categoricalInitialization(args, ns) {\n  var which = ns === 'x' ? args.width : args.height;\n  mg_categorical_count_number_of_groups(args, ns);\n  mg_categorical_count_number_of_lanes(args, ns);\n  mg_categorical_calculate_group_length(args, ns, which);\n  if (which) mg_categorical_calculate_bar_thickness(args, ns);\n}\n\n\nfunction mg_categorical_count_number_of_groups(args, ns) {\n  var accessor_string = ns + 'group_accessor';\n  var accessor = args[accessor_string];\n  args.categorical_groups = [];\n  if (accessor) {\n    var data = args.data[0];\n    args.categorical_groups = d3.set(data.map(function(d) {\n      return d[accessor] })).values();\n  }\n}\n\nfunction mg_categorical_count_number_of_lanes(args, ns) {\n  var accessor_string = ns + 'group_accessor';\n  var groupAccessor = args[accessor_string];\n\n  args.total_bars = args.data[0].length;\n  if (groupAccessor) {\n    var group_bars = count_array_elements(pluck(args.data[0], groupAccessor));\n    group_bars = d3.max(Object.keys(group_bars).map(function(d) {\n      return group_bars[d] }));\n    args.bars_per_group = group_bars;\n  } else {\n    args.bars_per_group = args.data[0].length;\n  }\n}\n\nfunction mg_categorical_calculate_group_length(args, ns, which) {\n  var groupHeight = ns + 'group_height';\n  if (which) {\n    var gh = ns === 'y' ?\n      (args.height - args.top - args.bottom - args.buffer * 2) / (args.categorical_groups.length || 1) :\n      (args.width - args.left - args.right - args.buffer * 2) / (args.categorical_groups.length || 1);\n\n    args[groupHeight] = gh;\n  } else {\n    var step = (1 + args[ns + '_padding_percentage']) * args.bar_thickness;\n    args[groupHeight] = args.bars_per_group * step + args[ns + '_outer_padding_percentage'] * 2 * step; //args.bar_thickness + (((args.bars_per_group-1) * args.bar_thickness) * (args.bar_padding_percentage + args.bar_outer_padding_percentage*2));\n  }\n}\n\nfunction mg_categorical_calculate_bar_thickness(args, ns) {\n  // take one group height.\n  var step = (args[ns + 'group_height']) / (args.bars_per_group + args[ns + '_outer_padding_percentage']);\n  args.bar_thickness = step - (step * args[ns + '_padding_percentage']);\n}\n\nfunction mg_categorical_calculate_height(args, ns) {\n  var groupContribution = (args[ns + 'group_height']) * (args.categorical_groups.length || 1);\n\n  var marginContribution = ns === 'y'\n    ? args.top + args.bottom + args.buffer * 2\n    : args.left + args.right + args.buffer * 2;\n\n  return groupContribution + marginContribution +\n    (args.categorical_groups.length * args[ns + 'group_height'] * (args[ns + 'group_padding_percentage'] + args[ns + 'group_outer_padding_percentage']));\n}\n\nfunction mg_barchart_extrapolate_group_and_thickness_from_height(args) {\n  // we need to set args.bar_thickness, group_height\n}\n\nfunction init(args) {\n  'use strict';\n  args = arguments[0];\n  args = mg_merge_args_with_defaults(args);\n  // If you pass in a dom element for args.target, the expectation\n  // of a string elsewhere will break.\n  var container = d3.select(args.target);\n  mg_raise_container_error(container, args);\n\n  var svg = container.selectAll('svg');\n\n  // some things that will need to be calculated if we have a categorical axis.\n  if (args.y_axis_type === 'categorical') { categoricalInitialization(args, 'y'); }\n  if (args.x_axis_type === 'categorical') { categoricalInitialization(args, 'x'); }\n\n  mg_is_time_series(args);\n  mg_init_compute_width(args);\n  mg_init_compute_height(args);\n\n  mg_remove_svg_if_chart_type_has_changed(svg, args);\n  svg = mg_add_svg_if_it_doesnt_exist(svg, args);\n\n  mg_add_clip_path_for_plot_area(svg, args);\n  mg_adjust_width_and_height_if_changed(svg, args);\n  mg_set_viewbox_for_scaling(svg, args);\n  mg_remove_missing_classes_and_text(svg);\n  chart_title(args);\n  mg_remove_outdated_lines(svg, args);\n\n  return this;\n}\n\nMG.init = init;\n\nfunction mg_return_label(d) {\n  return d.label;\n}\n\nfunction mg_remove_existing_markers(svg) {\n  svg.selectAll('.mg-markers').remove();\n  svg.selectAll('.mg-baselines').remove();\n}\n\nfunction mg_in_range(args) {\n  return function(d) {\n    return (args.scales.X(d[args.x_accessor]) >= mg_get_plot_left(args)) && (args.scales.X(d[args.x_accessor]) <= mg_get_plot_right(args));\n  };\n}\n\nfunction mg_x_position(args) {\n  return function(d) {\n    return args.scales.X(d[args.x_accessor]);\n  };\n}\n\nfunction mg_x_position_fixed(args) {\n  var _mg_x_pos = mg_x_position(args);\n  return function(d) {\n    return _mg_x_pos(d).toFixed(2);\n  };\n}\n\nfunction mg_y_position_fixed(args) {\n  var _mg_y_pos = args.scales.Y;\n  return function(d) {\n    return _mg_y_pos(d.value).toFixed(2);\n  };\n}\n\nfunction mg_place_annotations(checker, class_name, args, svg, line_fcn, text_fcn) {\n  var g;\n  if (checker) {\n    g = svg.append('g').attr('class', class_name);\n    line_fcn(g, args);\n    text_fcn(g, args);\n  }\n}\n\nfunction mg_place_markers(args, svg) {\n  mg_place_annotations(args.markers, 'mg-markers', args, svg, mg_place_marker_lines, mg_place_marker_text);\n}\n\nfunction mg_place_baselines(args, svg) {\n  mg_place_annotations(args.baselines, 'mg-baselines', args, svg, mg_place_baseline_lines, mg_place_baseline_text);\n}\n\nfunction mg_place_marker_lines(gm, args) {\n  var x_pos_fixed = mg_x_position_fixed(args);\n  gm.selectAll('.mg-markers')\n    .data(args.markers.filter(mg_in_range(args)))\n    .enter()\n    .append('line')\n    .attr('x1', x_pos_fixed)\n    .attr('x2', x_pos_fixed)\n    .attr('y1', args.top)\n    .attr('y2', mg_get_plot_bottom(args))\n    .attr('class', function(d) {\n      return d.lineclass;\n    })\n    .attr('stroke-dasharray', '3,1');\n}\n\nfunction mg_place_marker_text(gm, args) {\n  gm.selectAll('.mg-markers')\n    .data(args.markers.filter(mg_in_range(args)))\n    .enter()\n    .append('text')\n      .attr('class', function(d) {\n        return d.textclass || ''; })\n      .classed('mg-marker-text', true)\n      .attr('x', mg_x_position(args))\n      .attr('y', args.x_axis_position === 'bottom' ? mg_get_top(args) * 0.95 : mg_get_bottom(args) + args.buffer)\n      .attr('text-anchor', 'middle')\n      .text(mg_return_label)\n      .each(function(d) {\n        if (d.click) {\n          d3.select(this).style('cursor', 'pointer')\n            .on('click', d.click);\n        }\n      });\n\n  mg_prevent_horizontal_overlap(gm.selectAll('.mg-marker-text').nodes(), args);\n}\n\nfunction mg_place_baseline_lines(gb, args) {\n  var y_pos = mg_y_position_fixed(args);\n  gb.selectAll('.mg-baselines')\n    .data(args.baselines)\n    .enter().append('line')\n    .attr('x1', mg_get_plot_left(args))\n    .attr('x2', mg_get_plot_right(args))\n    .attr('y1', y_pos)\n    .attr('y2', y_pos);\n}\n\nfunction mg_place_baseline_text(gb, args) {\n  var y_pos = mg_y_position_fixed(args);\n  gb.selectAll('.mg-baselines')\n    .data(args.baselines)\n    .enter().append('text')\n    .attr('x', mg_get_plot_right(args))\n    .attr('y', y_pos)\n    .attr('dy', -3)\n    .attr('text-anchor', 'end')\n    .text(mg_return_label);\n}\n\nfunction markers(args) {\n  'use strict';\n\n  var svg = mg_get_svg_child_of(args.target);\n  mg_remove_existing_markers(svg);\n  mg_place_markers(args, svg);\n  mg_place_baselines(args, svg);\n  return this;\n}\n\nMG.markers = markers;\n\nfunction mg_clear_mouseover_container(svg) {\n  svg.selectAll('.mg-active-datapoint-container').selectAll('*').remove();\n}\n\nfunction mg_setup_mouseover_container(svg, args) {\n  svg.select('.mg-active-datapoint').remove();\n  var text_anchor = args.mouseover_align === 'right'\n    ? 'end'\n    : (args.mouseover_align === 'left'\n      ? 'start'\n      : 'middle');\n\n  var mouseover_x = (args.mouseover_align === 'right')\n    ? mg_get_plot_right(args)\n    : (args.mouseover_align === 'left'\n      ? mg_get_plot_left(args)\n      : (args.width - args.left - args.right) / 2 + args.left);\n\n  var active_datapoint = svg.select('.mg-active-datapoint-container')\n    .append('text')\n    .attr('class', 'mg-active-datapoint')\n    .attr('xml:space', 'preserve')\n    .attr('text-anchor', text_anchor);\n\n  // set the rollover text's position; if we have markers on two lines,\n  // nudge up the rollover text a bit\n  var active_datapoint_y_nudge = 0.75;\n\n  var y_position = (args.x_axis_position === 'bottom')\n    ? mg_get_top(args) * active_datapoint_y_nudge\n    : mg_get_bottom(args) + args.buffer * 3;\n\n  if (args.markers) {\n    var yPos;\n    svg.selectAll('.mg-marker-text')\n      .each(function() {\n        if (!yPos) {\n          yPos = d3.select(this).attr('y');\n        } else if (yPos !== d3.select(this).attr('y')) {\n          active_datapoint_y_nudge = 0.56;\n        }\n      });\n  }\n\n  active_datapoint\n    .attr('transform', 'translate(' + mouseover_x + ',' + (y_position) + ')');\n}\n\nfunction mg_mouseover_tspan(svg, text) {\n  var tspan = '';\n  var cl = null;\n  if (arguments.length === 3) cl = arguments[2];\n  tspan = svg.append('tspan').text(text);\n  if (cl !== null) tspan.classed(cl, true);\n  this.tspan = tspan;\n\n  this.bold = function() {\n    this.tspan.attr('font-weight', 'bold');\n    return this;\n  };\n\n  this.font_size = function(pts) {\n    this.tspan.attr('font-size', pts);\n    return this;\n  }\n\n  this.x = function(x) {\n    this.tspan.attr('x', x);\n    return this;\n  };\n  this.y = function(y) {\n    this.tspan.attr('y', y);\n    return this;\n  };\n  this.elem = function() {\n    return this.tspan;\n  };\n  return this;\n}\n\nfunction mg_reset_text_container(svg) {\n  var textContainer = svg.select('.mg-active-datapoint');\n  textContainer\n    .selectAll('*')\n    .remove();\n  return textContainer;\n}\n\nfunction mg_mouseover_row(row_number, container, rargs) {\n  var lineHeight = 1.1;\n  this.rargs = rargs;\n\n  var rrr = container.append('tspan')\n    .attr('x', 0)\n    .attr('y', (row_number * lineHeight) + 'em');\n\n  this.text = function(text) {\n    return mg_mouseover_tspan(rrr, text);\n  }\n  return this;\n}\n\nfunction mg_mouseover_text(args, rargs) {\n  var lineHeight = 1.1;\n  this.row_number = 0;\n  this.rargs = rargs;\n  mg_setup_mouseover_container(rargs.svg, args);\n\n  this.text_container = mg_reset_text_container(rargs.svg);\n\n  this.mouseover_row = function(rargs) {\n    var that = this;\n    var rrr = mg_mouseover_row(that.row_number, that.text_container, rargs);\n    that.row_number += 1;\n    return rrr;\n  }\n\n  return this;\n}\n\nfunction MG_WindowResizeTracker() {\n  var targets = [];\n\n  var Observer;\n  if (typeof MutationObserver !== \"undefined\") {\n    Observer = MutationObserver;\n  } else if (typeof WebKitMutationObserver !== \"undefined\") {\n    Observer = WebKitMutationObserver;\n  }\n\n  function window_listener() {\n    targets.forEach(function(target) {\n      var svg = d3.select(target).select('svg');\n\n      // skip if svg is not visible\n      if (!svg.empty() && (svg.node().parentNode.offsetWidth > 0 || svg.node().parentNode.offsetHeight > 0)) {\n        var aspect = svg.attr('width') !== 0 ? (svg.attr('height') / svg.attr('width')) : 0;\n\n        var newWidth = get_width(target);\n\n        svg.attr('width', newWidth);\n        svg.attr('height', aspect * newWidth);\n      }\n    });\n  }\n\n  function remove_target(target) {\n    var index = targets.indexOf(target);\n    if (index !== -1) {\n      targets.splice(index, 1);\n    }\n\n    if (targets.length === 0) {\n      window.removeEventListener('resize', window_listener, true);\n    }\n  }\n\n  return {\n    add_target: function(target) {\n      if (targets.length === 0) {\n        window.addEventListener('resize', window_listener, true);\n      }\n\n      if (targets.indexOf(target) === -1) {\n        targets.push(target);\n\n        if (Observer) {\n          var observer = new Observer(function(mutations) {\n            var targetNode = d3.select(target).node();\n\n            if (!targetNode || mutations.some(\n                function(mutation) {\n                  for (var i = 0; i < mutation.removedNodes.length; i++) {\n                    if (mutation.removedNodes[i] === targetNode) {\n                      return true;\n                    }\n                  }\n                })) {\n              observer.disconnect();\n              remove_target(target);\n            }\n          });\n\n          observer.observe(d3.select(target).node().parentNode, { childList: true });\n        }\n      }\n    }\n  };\n}\n\nvar mg_window_resize_tracker = new MG_WindowResizeTracker();\n\nfunction mg_window_listeners(args) {\n  mg_if_aspect_ratio_resize_svg(args);\n}\n\nfunction mg_if_aspect_ratio_resize_svg(args) {\n  // have we asked the svg to fill a div, if so resize with div\n  if (args.full_width || args.full_height) {\n    mg_window_resize_tracker.add_target(args.target);\n  }\n}\n\nif (mg_jquery_exists()) {\n    /*!\n     * Bootstrap v3.3.1 (http://getbootstrap.com)\n     * Copyright 2011-2014 Twitter, Inc.\n     * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n     */\n\n    /*!\n     * Generated using the Bootstrap Customizer (http://getbootstrap.com/customize/?id=c3834cc5b59ef727da53)\n     * Config saved to config.json and https://gist.github.com/c3834cc5b59ef727da53\n     */\n\n    /* ========================================================================\n     * Bootstrap: dropdown.js v3.3.1\n     * http://getbootstrap.com/javascript/#dropdowns\n     * ========================================================================\n     * Copyright 2011-2014 Twitter, Inc.\n     * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n     * ======================================================================== */\n\n\n    +function ($) {\n      'use strict';\n\n      if(typeof $().dropdown == 'function')\n        return true;\n\n      // DROPDOWN CLASS DEFINITION\n      // =========================\n\n      var backdrop = '.dropdown-backdrop';\n      var toggle   = '[data-toggle=\"dropdown\"]';\n      var Dropdown = function (element) {\n        $(element).on('click.bs.dropdown', this.toggle);\n      };\n\n      Dropdown.VERSION = '3.3.1';\n\n      Dropdown.prototype.toggle = function (e) {\n        var $this = $(this);\n\n        if ($this.is('.disabled, :disabled')) return;\n\n        var $parent  = getParent($this);\n        var isActive = $parent.hasClass('open');\n\n        clearMenus();\n\n        if (!isActive) {\n          if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {\n            // if mobile we use a backdrop because click events don't delegate\n            $('<div class=\"dropdown-backdrop\"/>').insertAfter($(this)).on('click', clearMenus);\n          }\n\n          var relatedTarget = { relatedTarget: this };\n          $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget));\n\n          if (e.isDefaultPrevented()) return;\n\n          $this\n            .trigger('focus')\n            .attr('aria-expanded', 'true');\n\n          $parent\n            .toggleClass('open')\n            .trigger('shown.bs.dropdown', relatedTarget);\n        }\n\n        return false;\n      };\n\n      Dropdown.prototype.keydown = function (e) {\n        if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return;\n\n        var $this = $(this);\n\n        e.preventDefault();\n        e.stopPropagation();\n\n        if ($this.is('.disabled, :disabled')) return;\n\n        var $parent  = getParent($this);\n        var isActive = $parent.hasClass('open');\n\n        if ((!isActive && e.which != 27) || (isActive && e.which == 27)) {\n          if (e.which == 27) $parent.find(toggle).trigger('focus');\n          return $this.trigger('click');\n        }\n\n        var desc = ' li:not(.divider):visible a';\n        var $items = $parent.find('[role=\"menu\"]' + desc + ', [role=\"listbox\"]' + desc);\n\n        if (!$items.length) return;\n\n        var index = $items.index(e.target);\n\n        if (e.which == 38 && index > 0)                 index--;                        // up\n        if (e.which == 40 && index < $items.length - 1) index++;                        // down\n        if (!~index)                                      index = 0;\n\n        $items.eq(index).trigger('focus');\n      };\n\n      function clearMenus(e) {\n        if (e && e.which === 3) return;\n        $(backdrop).remove();\n        $(toggle).each(function () {\n          var $this         = $(this);\n          var $parent       = getParent($this);\n          var relatedTarget = { relatedTarget: this };\n\n          if (!$parent.hasClass('open')) return;\n\n          $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget));\n\n          if (e.isDefaultPrevented()) return;\n\n          $this.attr('aria-expanded', 'false');\n          $parent.removeClass('open').trigger('hidden.bs.dropdown', relatedTarget);\n        });\n      }\n\n      function getParent($this) {\n        var selector = $this.attr('data-target');\n\n        if (!selector) {\n          selector = $this.attr('href');\n          selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\\s]*$)/, ''); // strip for ie7\n        }\n\n        var $parent = selector && $(selector);\n\n        return $parent && $parent.length ? $parent : $this.parent();\n      }\n\n\n      // DROPDOWN PLUGIN DEFINITION\n      // ==========================\n\n      function Plugin(option) {\n        return this.each(function () {\n          var $this = $(this);\n          var data  = $this.data('bs.dropdown');\n\n          if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)));\n          if (typeof option == 'string') data[option].call($this);\n        });\n      }\n\n      var old = $.fn.dropdown;\n\n      $.fn.dropdown             = Plugin;\n      $.fn.dropdown.Constructor = Dropdown;\n\n\n      // DROPDOWN NO CONFLICT\n      // ====================\n\n      $.fn.dropdown.noConflict = function () {\n        $.fn.dropdown = old;\n        return this;\n      };\n\n\n      // APPLY TO STANDARD DROPDOWN ELEMENTS\n      // ===================================\n\n      $(document)\n        .on('click.bs.dropdown.data-api', clearMenus)\n        .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation(); })\n        .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)\n        .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)\n        .on('keydown.bs.dropdown.data-api', '[role=\"menu\"]', Dropdown.prototype.keydown)\n        .on('keydown.bs.dropdown.data-api', '[role=\"listbox\"]', Dropdown.prototype.keydown);\n\n    }(jQuery);\n}\n\nMG.button_layout = function(target) {\n  'use strict';\n  this.target = target;\n  this.feature_set = {};\n  this.public_name = {};\n  this.sorters = {};\n  this.manual = [];\n  this.manual_map = {};\n  this.manual_callback = {};\n\n  this._strip_punctuation = function(s) {\n    var punctuationless = s.replace(/[^a-zA-Z0-9 _]+/g, '');\n    var finalString = punctuationless.replace(/ +?/g, '');\n    return finalString;\n  };\n\n  this.data = function(data) {\n    this._data = data;\n    return this;\n  };\n\n  this.manual_button = function(feature, feature_set, callback) {\n    this.feature_set[feature] = feature_set;\n    this.manual_map[this._strip_punctuation(feature)] = feature;\n    this.manual_callback[feature] = callback; // the default is going to be the first feature.\n    return this;\n  };\n\n  this.button = function(feature) {\n    if (arguments.length > 1) {\n      this.public_name[feature] = arguments[1];\n    }\n\n    if (arguments.length > 2) {\n      this.sorters[feature] = arguments[2];\n    }\n\n    this.feature_set[feature] = [];\n    return this;\n  };\n\n  this.callback = function(callback) {\n    this._callback = callback;\n    return this;\n  };\n\n  this.display = function() {\n    var callback = this._callback;\n    var manual_callback = this.manual_callback;\n    var manual_map = this.manual_map;\n\n    var d, f, features, feat;\n    features = Object.keys(this.feature_set);\n\n    var mapDtoF = function(f) {\n      return d[f]; };\n\n    var i;\n\n    // build out this.feature_set with this.data\n    for (i = 0; i < this._data.length; i++) {\n      d = this._data[i];\n      f = features.map(mapDtoF);\n      for (var j = 0; j < features.length; j++) {\n        feat = features[j];\n        if (this.feature_set[feat].indexOf(f[j]) === -1) {\n          this.feature_set[feat].push(f[j]);\n        }\n      }\n    }\n\n    for (feat in this.feature_set) {\n      if (this.sorters.hasOwnProperty(feat)) {\n        this.feature_set[feat].sort(this.sorters[feat]);\n      }\n    }\n\n    $(this.target).empty();\n\n    $(this.target).append(\"<div class='col-lg-12 segments text-center'></div>\");\n\n    var dropdownLiAClick = function() {\n      var k = $(this).data('key');\n      var feature = $(this).data('feature');\n      var manual_feature;\n      $('.' + feature + '-btns button.btn span.title').html(k);\n      if (!manual_map.hasOwnProperty(feature)) {\n        callback(feature, k);\n      } else {\n        manual_feature = manual_map[feature];\n        manual_callback[manual_feature](k);\n      }\n\n      return false;\n    };\n\n    for (var feature in this.feature_set) {\n      features = this.feature_set[feature];\n      $(this.target + ' div.segments').append(\n        '<div class=\"btn-group ' + this._strip_punctuation(feature) + '-btns text-left\">' + // This never changes.\n        '<button type=\"button\" class=\"btn btn-default btn-lg dropdown-toggle\" data-toggle=\"dropdown\">' +\n        \"<span class='which-button'>\" + (this.public_name.hasOwnProperty(feature) ? this.public_name[feature] : feature) + \"</span>\" +\n        \"<span class='title'>\" + (this.manual_callback.hasOwnProperty(feature) ? this.feature_set[feature][0] : 'all') + \"</span>\" + // if a manual button, don't default to all in label.\n        '<span class=\"caret\"></span>' +\n        '</button>' +\n        '<ul class=\"dropdown-menu\" role=\"menu\">' +\n        (!this.manual_callback.hasOwnProperty(feature) ? '<li><a href=\"#\" data-feature=\"' + feature + '\" data-key=\"all\">All</a></li>' : \"\") +\n        (!this.manual_callback.hasOwnProperty(feature) ? '<li class=\"divider\"></li>' : \"\") +\n        '</ul>' + '</div>');\n\n      for (i = 0; i < features.length; i++) {\n        if (features[i] !== 'all' && features[i] !== undefined) { // strange bug with undefined being added to manual buttons.\n          $(this.target + ' div.' + this._strip_punctuation(feature) + '-btns ul.dropdown-menu').append(\n            '<li><a href=\"#\" data-feature=\"' + this._strip_punctuation(feature) + '\" data-key=\"' + features[i] + '\">' + features[i] + '</a></li>'\n          );\n        }\n      }\n\n      $('.' + this._strip_punctuation(feature) + '-btns .dropdown-menu li a').on('click', dropdownLiAClick);\n    }\n\n    return this;\n  };\n\n  return this;\n};\n\n(function() {\n  'use strict';\n\n  function mg_line_color_text(elem, d, args) {\n    elem.classed('mg-hover-line' + d.line_id + '-color', args.colors === null)\n      .attr('fill', args.colors === null ? '' : args.colors[d.line_id - 1]);\n  }\n\n  function mg_line_graph_generators(args, plot, svg) {\n    mg_add_line_generator(args, plot);\n    mg_add_area_generator(args, plot);\n    mg_add_flat_line_generator(args, plot);\n    mg_add_confidence_band_generator(args, plot, svg);\n  }\n\n  function mg_add_confidence_band_generator(args, plot, svg) {\n    plot.existing_band = svg.selectAll('.mg-confidence-band').nodes();\n    if (args.show_confidence_band) {\n      plot.confidence_area = d3.area()\n        .defined(plot.line.defined())\n        .x(args.scalefns.xf)\n        .y0(function(d) {\n          var l = args.show_confidence_band[0];\n          if (d[l] != undefined) {\n            return args.scales.Y(d[l]);\n          } else {\n            return args.scales.Y(d[args.y_accessor]);\n          }\n        })\n        .y1(function(d) {\n          var u = args.show_confidence_band[1];\n          if (d[u] != undefined) {\n            return args.scales.Y(d[u]);\n          } else {\n            return args.scales.Y(d[args.y_accessor]);\n          }\n        })\n        .curve(args.interpolate);\n    }\n  }\n\n  function mg_add_area_generator(args, plot) {\n    plot.area = d3.area()\n      .defined(plot.line.defined())\n      .x(args.scalefns.xf)\n      .y0(args.scales.Y.range()[0])\n      .y1(args.scalefns.yf)\n      .curve(args.interpolate);\n  }\n\n  function mg_add_flat_line_generator(args, plot) {\n    plot.flat_line = d3.line()\n      .defined(function(d) {\n        return (d['_missing'] === undefined || d['_missing'] !== true) && d[args.y_accessor] !== null;\n      })\n      .x(args.scalefns.xf)\n      .y(function() {\n        return args.scales.Y(plot.data_median); })\n      .curve(args.interpolate);\n  }\n\n  function mg_add_line_generator(args, plot) {\n    plot.line = d3.line()\n      .x(args.scalefns.xf)\n      .y(args.scalefns.yf)\n      .curve(args.interpolate);\n\n    // if missing_is_zero is not set, then hide data points that fall in missing\n    // data ranges or that have been explicitly identified as missing in the\n    // data source.\n    if (!args.missing_is_zero) {\n      // a line is defined if the _missing attrib is not set to true\n      // and the y-accessor is not null\n      plot.line = plot.line.defined(function(d) {\n        return (d['_missing'] === undefined || d['_missing'] !== true) && d[args.y_accessor] !== null;\n      });\n    }\n  }\n\n  function mg_add_confidence_band(args, plot, svg, which_line) {\n    if (args.show_confidence_band) {\n      var confidenceBand;\n      if (svg.select('.mg-confidence-band-' + which_line).empty()) {\n        svg.append('path')\n          .attr('class', 'mg-confidence-band mg-confidence-band-' + which_line)\n      }\n\n      // transition this line's confidence band\n      confidenceBand = svg.select('.mg-confidence-band-' + which_line);\n\n      confidenceBand\n        .transition()\n        .duration(function() {\n          return (args.transition_on_update) ? 1000 : 0;\n        })\n        .attr('d', plot.confidence_area(args.data[which_line - 1]))\n        .attr('clip-path', 'url(#mg-plot-window-' + mg_target_ref(args.target) + ')')\n    }\n  }\n\n  function mg_add_area(args, plot, svg, which_line, line_id) {\n    var areas = svg.selectAll('.mg-main-area.mg-area' + line_id);\n    if (plot.display_area) {\n      // if area already exists, transition it\n      if (!areas.empty()) {\n        svg.node().appendChild(areas.node());\n\n        areas.transition()\n          .duration(plot.update_transition_duration)\n          .attr('d', plot.area(args.data[which_line]))\n          .attr('clip-path', 'url(#mg-plot-window-' + mg_target_ref(args.target) + ')');\n      } else { // otherwise, add the area\n        svg.append('path')\n          .classed('mg-main-area', true)\n          .classed('mg-area' + line_id, true)\n          .classed('mg-area' + line_id + '-color', args.colors === null)\n          .attr('d', plot.area(args.data[which_line]))\n          .attr('fill', args.colors === null ? '' : args.colors[line_id - 1])\n          .attr('clip-path', 'url(#mg-plot-window-' + mg_target_ref(args.target) + ')');\n      }\n    } else if (!areas.empty()) {\n      areas.remove();\n    }\n  }\n\n  function mg_default_color_for_path(this_path, line_id) {\n    this_path.classed('mg-line' + (line_id) + '-color', true);\n  }\n\n  function mg_color_line(args, this_path, which_line, line_id) {\n    if (args.colors) {\n      // for now, if args.colors is not an array, then keep moving as if nothing happened.\n      // if args.colors is not long enough, default to the usual line_id color.\n      if (args.colors.constructor === Array) {\n        this_path.attr('stroke', args.colors[which_line]);\n        if (args.colors.length < which_line + 1) {\n          // Go with default coloring.\n          // this_path.classed('mg-line' + (line_id) + '-color', true);\n          mg_default_color_for_path(this_path, line_id);\n        }\n      } else {\n        // this_path.classed('mg-line' + (line_id) + '-color', true);\n        mg_default_color_for_path(this_path, line_id);\n      }\n    } else {\n      // this is the typical workflow\n      // this_path.classed('mg-line' + (line_id) + '-color', true);\n      mg_default_color_for_path(this_path, line_id);\n    }\n  }\n\n  function mg_add_line_element(args, plot, this_path, which_line) {\n    if (args.animate_on_load) {\n      plot.data_median = d3.median(args.data[which_line], function(d) {\n        return d[args.y_accessor]; });\n      this_path.attr('d', plot.flat_line(args.data[which_line]))\n        .transition()\n        .duration(1000)\n        .attr('d', plot.line(args.data[which_line]))\n        .attr('clip-path', 'url(#mg-plot-window-' + mg_target_ref(args.target) + ')');\n    } else { // or just add the line\n      this_path.attr('d', plot.line(args.data[which_line]))\n        .attr('clip-path', 'url(#mg-plot-window-' + mg_target_ref(args.target) + ')');\n    }\n  }\n\n  function mg_add_line(args, plot, svg, existing_line, which_line, line_id) {\n    if (!existing_line.empty()) {\n      svg.node().appendChild(existing_line.node());\n\n      var lineTransition = existing_line.transition()\n        .duration(plot.update_transition_duration);\n\n      if (!plot.display_area && args.transition_on_update && !args.missing_is_hidden) {\n        lineTransition.attrTween('d', path_tween(plot.line(args.data[which_line]), 4));\n      } else {\n        lineTransition.attr('d', plot.line(args.data[which_line]));\n      }\n    } else { // otherwise...\n      // if we're animating on load, animate the line from its median value\n      var this_path = svg.append('path')\n        .attr('class', 'mg-main-line mg-line' + line_id);\n\n      mg_color_line(args, this_path, which_line, line_id);\n      mg_add_line_element(args, plot, this_path, which_line);\n    }\n  }\n\n  function mg_add_legend_element(args, plot, which_line, line_id) {\n    var this_legend;\n    if (args.legend) {\n      if (is_array(args.legend)) {\n        this_legend = args.legend[which_line];\n      } else if (is_function(args.legend)) {\n        this_legend = args.legend(args.data[which_line]);\n      }\n\n      if (args.legend_target) {\n        if (args.colors && args.colors.constructor === Array) {\n          plot.legend_text = \"<span style='color:\" + args.colors[which_line] + \"'>&mdash; \" +\n            this_legend + '&nbsp; </span>' + plot.legend_text;\n        } else {\n          plot.legend_text = \"<span class='mg-line\" + line_id + \"-legend-color'>&mdash; \" +\n            this_legend + '&nbsp; </span>' + plot.legend_text;\n        }\n      } else {\n        var anchor_point, anchor_orientation, dx;\n        if (args.y_axis_position === 'left') {\n          anchor_point = args.data[which_line][args.data[which_line].length - 1];\n          anchor_orientation = 'start';\n          dx = args.buffer;\n        } else {\n          anchor_point = args.data[which_line][0];\n          anchor_orientation = 'end';\n          dx = -args.buffer;\n        }\n        var legend_text = plot.legend_group.append('svg:text')\n          .attr('x', args.scalefns.xf(anchor_point))\n          .attr('dx', dx)\n          .attr('y', args.scalefns.yf(anchor_point))\n          .attr('dy', '.35em')\n          .attr('font-size', 10)\n          .attr('text-anchor', anchor_orientation)\n          .attr('font-weight', '300')\n          .text(this_legend);\n\n        if (args.colors && args.colors.constructor === Array) {\n          if (args.colors.length < which_line + 1) {\n            legend_text.classed('mg-line' + (line_id) + '-legend-color', true);\n          } else {\n            legend_text.attr('fill', args.colors[which_line]);\n          }\n        } else {\n          legend_text.classed('mg-line' + (line_id) + '-legend-color', true);\n        }\n\n        mg_prevent_vertical_overlap(plot.legend_group.selectAll('.mg-line-legend text').nodes(), args);\n      }\n    }\n  }\n\n  function mg_plot_legend_if_legend_target(target, legend) {\n    if (target) {\n      d3.select(target).html(legend);\n    }\n  }\n\n  function mg_add_legend_group(args, plot, svg) {\n    if (args.legend) plot.legend_group = mg_add_g(svg, 'mg-line-legend');\n  }\n\n  function mg_remove_existing_line_rollover_elements(svg) {\n    // remove the old rollovers if they already exist\n    mg_selectAll_and_remove(svg, '.mg-rollover-rect');\n    mg_selectAll_and_remove(svg, '.mg-voronoi');\n\n    // remove the old rollover text and circle if they already exist\n    mg_selectAll_and_remove(svg, '.mg-active-datapoint');\n    mg_selectAll_and_remove(svg, '.mg-line-rollover-circle');\n    //mg_selectAll_and_remove(svg, '.mg-active-datapoint-container');\n  }\n\n  function mg_add_rollover_circle(args, svg) {\n    // append circle\n    var circle = svg.selectAll('.mg-line-rollover-circle')\n      .data(args.data)\n      .enter().append('circle')\n      .attr('cx', 0)\n      .attr('cy', 0)\n      .attr('r', 0);\n\n    if (args.colors && args.colors.constructor === Array) {\n      circle\n        .attr('class', function(d) {\n          return 'mg-line' + d.line_id;\n        })\n        .attr('fill', function(d, i) {\n          return args.colors[i];\n        })\n        .attr('stroke', function(d, i) {\n          return args.colors[i];\n        });\n    } else {\n      circle.attr('class', function(d, i) {\n        return [\n          'mg-line' + d.line_id,\n          'mg-line' + d.line_id + '-color',\n          'mg-area' + d.line_id + '-color'\n        ].join(' ');\n      });\n    }\n    circle.classed('mg-line-rollover-circle', true);\n  }\n\n  function mg_set_unique_line_id_for_each_series(args) {\n    // update our data by setting a unique line id for each series\n    // increment from 1... unless we have a custom increment series\n    var line_id = 1;\n    for (var i = 0; i < args.data.length; i++) {\n      for (var j = 0; j < args.data[i].length; j++) {\n        // Index is saved as original line id for the legend values\n        args.data[i][j].index = line_id;\n        // if custom line-color map is set, use that instead of line_id (For colors)\n        if (args.custom_line_color_map.length > 0) {\n          args.data[i][j].line_id = args.custom_line_color_map[i];\n        } else {\n          args.data[i][j].line_id = line_id;\n        }\n      }\n      line_id++;\n    }\n  }\n\n  function mg_nest_data_for_voronoi(args) {\n    return d3.merge(args.data);\n  }\n\n  function mg_line_class_string(args) {\n    return function(d) {\n      var class_string;\n\n      if (args.linked) {\n        var v = d[args.x_accessor];\n        var formatter = MG.time_format(args.utc_time, args.linked_format);\n\n        // only format when x-axis is date\n        var id = (typeof v === 'number') ? (d.line_id - 1) : formatter(v);\n        class_string = 'roll_' + id + ' mg-line' + d.line_id;\n\n        if (args.color === null) {\n          class_string += ' mg-line' + d.line_id + '-color';\n        }\n        return class_string;\n\n      } else {\n        class_string = 'mg-line' + d.line_id;\n        if (args.color === null) class_string += ' mg-line' + d.line_id + '-color';\n        return class_string;\n      }\n    };\n  }\n\n  function mg_add_voronoi_rollover(args, svg, rollover_on, rollover_off, rollover_move) {\n    var voronoi = d3.voronoi()\n      .x(function(d) {\n        return args.scales.X(d[args.x_accessor]).toFixed(2); })\n      .y(function(d) {\n        return args.scales.Y(d[args.y_accessor]).toFixed(2); })\n      .extent([\n        [args.buffer, args.buffer + args.title_y_position],\n        [args.width - args.buffer, args.height - args.buffer]\n      ]);\n\n    var g = mg_add_g(svg, 'mg-voronoi');\n    g.selectAll('path')\n      .data(voronoi.polygons(mg_nest_data_for_voronoi(args)))\n      .enter()\n      .append('path')\n      .filter(function(d) {\n        return d !== undefined && d.length > 0; })\n      .attr('d', function(d) {\n        return d == null ? null : 'M' + d.join('L') + 'Z'; })\n      .datum(function(d) {\n        return d == null ? null : d.data; }) // because of d3.voronoi, reassign d\n      .attr('class', mg_line_class_string(args))\n      .on('mouseover', rollover_on)\n      .on('mouseout', rollover_off)\n      .on('mousemove', rollover_move);\n\n    mg_configure_voronoi_rollover(args, svg);\n  }\n\n  function nest_data_for_aggregate_rollover(args) {\n    var data_nested = d3.nest()\n      .key(function(d) {\n        return d[args.x_accessor]; })\n      .entries(d3.merge(args.data));\n    data_nested.forEach(function(entry) {\n      var datum = entry.values[0];\n      entry.key = datum[args.x_accessor];\n    });\n\n    if (args.x_sort) {\n      return data_nested.sort(function(a, b) {\n        return new Date(a.key) - new Date(b.key); });\n    } else {\n      return data_nested;\n    }\n  }\n\n  function mg_add_aggregate_rollover(args, svg, rollover_on, rollover_off, rollover_move) {\n    // Undo the keys getting coerced to strings, by setting the keys from the values\n    // This is necessary for when we have X axis keys that are things like\n    var data_nested = nest_data_for_aggregate_rollover(args);\n\n    var xf = data_nested.map(function(di) {\n      return args.scales.X(di.key);\n    });\n\n    var g = svg.append('g')\n      .attr('class', 'mg-rollover-rect');\n\n    g.selectAll('.mg-rollover-rects')\n      .data(data_nested).enter()\n      .append('rect')\n      .attr('x', function(d, i) {\n        if (xf.length === 1) return mg_get_plot_left(args);\n        else if (i === 0) return xf[i].toFixed(2);\n        else return ((xf[i - 1] + xf[i]) / 2).toFixed(2);\n      })\n      .attr('y', args.top)\n      .attr('width', function(d, i) {\n        if (xf.length === 1) return mg_get_plot_right(args);\n        else if (i === 0) return ((xf[i + 1] - xf[i]) / 2).toFixed(2);\n        else if (i === xf.length - 1) return ((xf[i] - xf[i - 1]) / 2).toFixed(2);\n        else return ((xf[i + 1] - xf[i - 1]) / 2).toFixed(2);\n      })\n      .attr('class', function(d) {\n        var line_classes = d.values.map(function(datum) {\n          var lc = mg_line_class(datum.line_id);\n          if (args.colors === null) lc += ' ' + mg_line_color_class(datum.line_id);\n          return lc;\n        }).join(' ');\n        if (args.linked && d.values.length > 0) {\n          line_classes += ' ' + mg_rollover_id_class(mg_rollover_format_id(d.values[0], 0, args));\n        }\n\n        return line_classes;\n      })\n      .attr('height', args.height - args.bottom - args.top - args.buffer)\n      .attr('opacity', 0)\n      .on('mouseover', rollover_on)\n      .on('mouseout', rollover_off)\n      .on('mousemove', rollover_move);\n\n    mg_configure_aggregate_rollover(args, svg);\n  }\n\n  function mg_configure_singleton_rollover(args, svg) {\n    svg.select('.mg-rollover-rect rect')\n      .on('mouseover')(args.data[0][0], 0);\n  }\n\n  function mg_configure_voronoi_rollover(args, svg) {\n    for (var i = 0; i < args.data.length; i++) {\n      var j = i + 1;\n\n      if (args.custom_line_color_map.length > 0 &&\n        args.custom_line_color_map[i] !== undefined) {\n        j = args.custom_line_color_map[i];\n      }\n\n      if (args.data[i].length === 1 && !svg.selectAll('.mg-voronoi .mg-line' + j).empty()) {\n        svg.selectAll('.mg-voronoi .mg-line' + j)\n          .on('mouseover')(args.data[i][0], 0);\n\n        svg.selectAll('.mg-voronoi .mg-line' + j)\n          .on('mouseout')(args.data[i][0], 0);\n      }\n    }\n  }\n\n  function mg_line_class(line_id) {\n    return 'mg-line' + line_id;\n  }\n\n  function mg_line_color_class(line_id) {\n    return 'mg-line' + line_id + '-color';\n  }\n\n  function mg_rollover_id_class(id) {\n    return 'roll_' + id;\n  }\n\n  function mg_rollover_format_id(d, i, args) {\n    var v = d[args.x_accessor];\n    var formatter = MG.time_format(args.utc_time, args.linked_format);\n    // only format when x-axis is date\n    var id = (typeof v === 'number') ? i : formatter(v);\n    return id;\n  }\n\n  function mg_add_single_line_rollover(args, svg, rollover_on, rollover_off, rollover_move) {\n    // set to 1 unless we have a custom increment series\n    var line_id = 1;\n    if (args.custom_line_color_map.length > 0) {\n      line_id = args.custom_line_color_map[0];\n    }\n\n    var g = svg.append('g')\n      .attr('class', 'mg-rollover-rect');\n\n    var xf = args.data[0].map(args.scalefns.xf);\n\n    g.selectAll('.mg-rollover-rects')\n      .data(args.data[0]).enter()\n      .append('rect')\n      .attr('class', function(d, i) {\n        var cl = mg_line_color_class(line_id) + ' ' + mg_line_class(d.line_id);\n        if (args.linked) cl += cl + ' ' + mg_rollover_id_class(mg_rollover_format_id(d, i, args));\n        return cl;\n      })\n      .attr('x', function(d, i) {\n        // if data set is of length 1\n        if (xf.length === 1) return mg_get_plot_left(args);\n        else if (i === 0) return xf[i].toFixed(2);\n        else return ((xf[i - 1] + xf[i]) / 2).toFixed(2);\n      })\n      .attr('y', function(d, i) {\n        return (args.data.length > 1) ? args.scalefns.yf(d) - 6 // multi-line chart sensitivity\n          : args.top;\n      })\n      .attr('width', function(d, i) {\n        // if data set is of length 1\n        if (xf.length === 1) return mg_get_plot_right(args);\n        else if (i === 0) return ((xf[i + 1] - xf[i]) / 2).toFixed(2);\n        else if (i === xf.length - 1) return ((xf[i] - xf[i - 1]) / 2).toFixed(2);\n        else return ((xf[i + 1] - xf[i - 1]) / 2).toFixed(2);\n      })\n      .attr('height', function(d, i) {\n        return (args.data.length > 1) ? 12 // multi-line chart sensitivity\n          : args.height - args.bottom - args.top - args.buffer;\n      })\n      .attr('opacity', 0)\n      .on('mouseover', rollover_on)\n      .on('mouseout', rollover_off)\n      .on('mousemove', rollover_move);\n\n    if (mg_is_singleton(args)) {\n      mg_configure_singleton_rollover(args, svg);\n    }\n  }\n\n  function mg_configure_aggregate_rollover(args, svg) {\n    var rect = svg.selectAll('.mg-rollover-rect rect');\n    var rect_first = rect.nodes()[0][0] || rect.nodes()[0];\n    if (args.data.filter(function(d) { return d.length === 1; }).length > 0) {\n      rect.on('mouseover')(rect_first.__data__, 0);\n    }\n  }\n\n  function mg_is_standard_multiline(args) {\n    return args.data.length > 1 && !args.aggregate_rollover;\n  }\n\n  function mg_is_aggregated_rollover(args) {\n    return args.data.length > 1 && args.aggregate_rollover;\n  }\n\n  function mg_is_singleton(args) {\n    return args.data.length === 1 && args.data[0].length === 1;\n  }\n\n  function mg_draw_all_line_elements(args, plot, svg) {\n    mg_remove_dangling_bands(plot, svg);\n\n    for (var i = args.data.length - 1; i >= 0; i--) {\n      var this_data = args.data[i];\n\n      // passing the data for the current line\n      MG.call_hook('line.before_each_series', [this_data, args]);\n\n      // override increment if we have a custom increment series\n      var line_id = i + 1;\n      if (args.custom_line_color_map.length > 0) {\n        line_id = args.custom_line_color_map[i];\n      }\n\n      args.data[i].line_id = line_id;\n\n      if (this_data.length === 0) {\n        continue;\n      }\n      var existing_line = svg.select('path.mg-main-line.mg-line' + (line_id));\n\n      mg_add_confidence_band(args, plot, svg, line_id);\n      mg_add_area(args, plot, svg, i, line_id);\n      mg_add_line(args, plot, svg, existing_line, i, line_id);\n      mg_add_legend_element(args, plot, i, line_id);\n\n      // passing the data for the current line\n      MG.call_hook('line.after_each_series', [this_data, existing_line, args]);\n    }\n  }\n\n  function mg_remove_dangling_bands(plot, svg) {\n    if (plot.existing_band[0] && plot.existing_band[0].length > svg.selectAll('.mg-main-line').node().length) {\n      svg.selectAll('.mg-confidence-band').remove();\n    }\n  }\n\n  function mg_line_main_plot(args) {\n    var plot = {};\n    var svg = mg_get_svg_child_of(args.target);\n\n    // remove any old legends if they exist\n    mg_selectAll_and_remove(svg, '.mg-line-legend');\n    mg_add_legend_group(args, plot, svg);\n\n    plot.data_median = 0;\n    plot.update_transition_duration = (args.transition_on_update) ? 1000 : 0;\n    plot.display_area = args.area && !args.use_data_y_min && args.data.length <= 1 && args.aggregate_rollover === false;\n    plot.legend_text = '';\n    mg_line_graph_generators(args, plot, svg);\n    plot.existing_band = svg.selectAll('.mg-confidence-band').nodes();\n\n    // should we continue with the default line render? A `line.all_series` hook should return false to prevent the default.\n    var continueWithDefault = MG.call_hook('line.before_all_series', [args]);\n    if (continueWithDefault !== false) {\n      mg_draw_all_line_elements(args, plot, svg);\n    }\n\n    mg_plot_legend_if_legend_target(args.legend_target, plot.legend_text);\n  }\n\n  function mg_line_rollover_setup(args, graph) {\n    var svg = mg_get_svg_child_of(args.target);\n\n    if (svg.selectAll('.mg-active-datapoint-container').nodes().length === 0) {\n      mg_add_g(svg, 'mg-active-datapoint-container');\n    }\n\n    mg_remove_existing_line_rollover_elements(svg);\n    mg_add_rollover_circle(args, svg);\n    mg_set_unique_line_id_for_each_series(args);\n\n    if (mg_is_standard_multiline(args)) {\n      mg_add_voronoi_rollover(args, svg, graph.rolloverOn(args), graph.rolloverOff(args), graph.rolloverMove(args));\n    } else if (mg_is_aggregated_rollover(args)) {\n      mg_add_aggregate_rollover(args, svg, graph.rolloverOn(args), graph.rolloverOff(args), graph.rolloverMove(args));\n    } else {\n      mg_add_single_line_rollover(args, svg, graph.rolloverOn(args), graph.rolloverOff(args), graph.rolloverMove(args));\n    }\n  }\n\n  function mg_update_rollover_circle(args, svg, d) {\n    if (args.aggregate_rollover && args.data.length > 1) {\n      // hide the circles in case a non-contiguous series is present\n      svg.selectAll('circle.mg-line-rollover-circle')\n        .style('opacity', 0);\n\n      d.values.forEach(function(datum) {\n        if (mg_data_in_plot_bounds(datum, args)) mg_update_aggregate_rollover_circle(args, svg, datum);\n      });\n    } else if ((args.missing_is_hidden && d['_missing']) || d[args.y_accessor] === null) {\n      // disable rollovers for hidden parts of the line\n      // recall that hidden parts are missing data ranges and possibly also\n      // data points that have been explicitly identified as missing\n      return;\n    } else {\n      // show circle on mouse-overed rect\n      if (mg_data_in_plot_bounds(d, args)) {\n        mg_update_generic_rollover_circle(args, svg, d);\n      }\n    }\n  }\n\n  function mg_update_aggregate_rollover_circle(args, svg, datum) {\n    svg.select('circle.mg-line-rollover-circle.mg-line' + datum.line_id)\n      .attr('cx', args.scales.X(datum[args.x_accessor]).toFixed(2))\n      .attr('cy', args.scales.Y(datum[args.y_accessor]).toFixed(2))\n      .attr('r', args.point_size)\n      .style('opacity', 1);\n  }\n\n  function mg_update_generic_rollover_circle(args, svg, d) {\n    svg.selectAll('circle.mg-line-rollover-circle.mg-line' + d.line_id)\n      .classed('mg-line-rollover-circle', true)\n      .attr('cx', function() {\n        return args.scales.X(d[args.x_accessor]).toFixed(2);\n      })\n      .attr('cy', function() {\n        return args.scales.Y(d[args.y_accessor]).toFixed(2);\n      })\n      .attr('r', args.point_size)\n      .style('opacity', 1);\n  }\n\n  function mg_trigger_linked_mouseovers(args, d, i) {\n    if (args.linked && !MG.globals.link) {\n      MG.globals.link = true;\n      if (!args.aggregate_rollover || d.value !== undefined || d.values.length > 0) {\n        var datum = d.values ? d.values[0] : d;\n        var id = mg_rollover_format_id(datum, i, args);\n        // trigger mouseover on matching line in .linked charts\n        d3.selectAll('.' + mg_line_class(datum.line_id) + '.' + mg_rollover_id_class(id))\n          .each(function(d) {\n            d3.select(this)\n              .on('mouseover')(d, i);\n          });\n      }\n    }\n  }\n\n  function mg_trigger_linked_mouseouts(args, d, i) {\n    if (args.linked && MG.globals.link) {\n      MG.globals.link = false;\n\n      var formatter = MG.time_format(args.utc_time, args.linked_format);\n      var datums = d.values ? d.values : [d];\n      datums.forEach(function(datum) {\n        var v = datum[args.x_accessor];\n        var id = (typeof v === 'number') ? i : formatter(v);\n\n        // trigger mouseout on matching line in .linked charts\n        d3.selectAll('.roll_' + id)\n          .each(function(d) {\n            d3.select(this)\n              .on('mouseout')(d);\n          });\n      });\n    }\n  }\n\n  function mg_remove_active_data_points_for_aggregate_rollover(args, svg) {\n    svg.selectAll('circle.mg-line-rollover-circle').filter(function(circle) {\n        return circle.length > 1;\n      })\n      .style('opacity', 0);\n  }\n\n  function mg_remove_active_data_points_for_generic_rollover(args, svg, d) {\n    svg.selectAll('circle.mg-line-rollover-circle.mg-line' + d.line_id)\n      .style('opacity', function() {\n        var id = d.line_id - 1;\n\n        if (args.custom_line_color_map.length > 0 &&\n          args.custom_line_color_map.indexOf(d.line_id) !== undefined\n        ) {\n          id = args.custom_line_color_map.indexOf(d.line_id);\n        }\n\n        if (args.data[id].length === 1) {\n          return 1;\n        } else {\n          return 0;\n        }\n      });\n  }\n\n  function mg_remove_active_text(svg) {\n    svg.select('.mg-active-datapoint').text('');\n  }\n\n  function lineChart(args) {\n    this.init = function(args) {\n      this.args = args;\n\n      if (!args.data || args.data.length === 0) {\n        args.internal_error = 'No data was supplied';\n        internal_error(args);\n        return this;\n      } else {\n        args.internal_error = undefined;\n      }\n\n      raw_data_transformation(args);\n      process_line(args);\n\n      MG.call_hook('line.before_destroy', this);\n\n      init(args);\n\n      // TODO incorporate markers into calculation of x scales\n      new MG.scale_factory(args)\n        .namespace('x')\n        .numericalDomainFromData()\n        .numericalRange('bottom')\n\n      var baselines = (args.baselines || []).map(function(d) {\n        return d[args.y_accessor];\n      });\n\n      new MG.scale_factory(args)\n        .namespace('y')\n        .zeroBottom(true)\n        .inflateDomain(true)\n        .numericalDomainFromData(baselines)\n        .numericalRange('left');\n\n      var svg = mg_get_svg_child_of(args.target);\n\n      if (args.x_axis) {\n        new MG.axis_factory(args)\n          .namespace('x')\n          .type('numerical')\n          .position(args.x_axis_position)\n          .rug(x_rug(args))\n          .label(mg_add_x_label)\n          .draw();\n      }\n\n      if (args.y_axis) {\n        new MG.axis_factory(args)\n          .namespace('y')\n          .type('numerical')\n          .position(args.y_axis_position)\n          .rug(y_rug(args))\n          .label(mg_add_y_label)\n          .draw();\n      }\n\n      this.markers();\n      this.mainPlot();\n      this.rollover();\n      this.windowListeners();\n\n      MG.call_hook('line.after_init', this);\n\n      return this;\n    };\n\n    this.mainPlot = function() {\n      mg_line_main_plot(args);\n      return this;\n    };\n\n    this.markers = function() {\n      markers(args);\n      return this;\n    };\n\n    this.rollover = function() {\n      var that = this;\n      mg_line_rollover_setup(args, that);\n      MG.call_hook('line.after_rollover', args);\n\n      return this;\n    };\n\n    this.rolloverOn = function(args) {\n      var svg = mg_get_svg_child_of(args.target);\n      var fmt = mg_get_rollover_time_format(args);\n\n      return function(d, i) {\n        mg_update_rollover_circle(args, svg, d);\n        mg_trigger_linked_mouseovers(args, d, i);\n\n        svg.selectAll('text')\n          .filter(function(g, j) {\n            return d === g;\n          })\n          .attr('opacity', 0.3);\n\n        // update rollover text except for missing data points\n        if (args.show_rollover_text &&\n            !((args.missing_is_hidden && d['_missing']) || d[args.y_accessor] === null)\n          ) {\n          var mouseover = mg_mouseover_text(args, { svg: svg });\n          var row = mouseover.mouseover_row();\n          if (args.aggregate_rollover) {\n            row.text((args.aggregate_rollover && args.data.length > 1\n              ? mg_format_x_aggregate_mouseover\n              : mg_format_x_mouseover)(args, d));\n          }\n\n          var pts = args.aggregate_rollover && args.data.length > 1\n            ? d.values\n            : [d];\n\n          pts.forEach(function(di) {\n            if (args.aggregate_rollover) {\n              row = mouseover.mouseover_row();\n            }\n\n            if (args.legend) {\n              mg_line_color_text(row.text(args.legend[di.index - 1] + '  ').bold().elem(), di, args);\n            }\n\n            mg_line_color_text(row.text('\\u2014  ').elem(), di, args);\n            if (!args.aggregate_rollover) {\n              row.text(mg_format_x_mouseover(args, di));\n            }\n\n            row.text(mg_format_y_mouseover(args, di, args.time_series === false));\n          })\n        }\n\n        if (args.mouseover) {\n          args.mouseover(d, i);\n        }\n      };\n    };\n\n    this.rolloverOff = function(args) {\n      var svg = mg_get_svg_child_of(args.target);\n\n      return function(d, i) {\n        mg_trigger_linked_mouseouts(args, d, i);\n        if (args.aggregate_rollover) {\n          mg_remove_active_data_points_for_aggregate_rollover(args, svg);\n        } else {\n          mg_remove_active_data_points_for_generic_rollover(args, svg, d);\n        }\n\n        if (args.data[0].length > 1) {\n          mg_clear_mouseover_container(svg);\n        }\n\n        if (args.mouseout) {\n          args.mouseout(d, i);\n        }\n      };\n    };\n\n    this.rolloverMove = function(args) {\n      return function(d, i) {\n        if (args.mousemove) {\n          args.mousemove(d, i);\n        }\n      };\n    };\n\n    this.windowListeners = function() {\n      mg_window_listeners(this.args);\n      return this;\n    };\n\n    this.init(args);\n  }\n\n  MG.register('line', lineChart);\n}).call(this);\n\n(function() {\n  'use strict';\n\n  function histogram(args) {\n    this.init = function(args) {\n      this.args = args;\n\n      raw_data_transformation(args);\n      process_histogram(args);\n      init(args);\n\n      new MG.scale_factory(args)\n        .namespace('x')\n        .numericalDomainFromData()\n        .numericalRange('bottom');\n\n      var baselines = (args.baselines || []).map(function(d) {\n        return d[args.y_accessor]\n      });\n\n      new MG.scale_factory(args)\n        .namespace('y')\n        .zeroBottom(true)\n        .inflateDomain(true)\n        .numericalDomainFromData(baselines)\n        .numericalRange('left');\n\n      x_axis(args);\n      y_axis(args);\n\n      this.mainPlot();\n      this.markers();\n      this.rollover();\n      this.windowListeners();\n\n      return this;\n    };\n\n    this.mainPlot = function() {\n      var svg = mg_get_svg_child_of(args.target);\n\n      //remove the old histogram, add new one\n      svg.selectAll('.mg-histogram').remove();\n\n      var g = svg.append('g')\n        .attr('class', 'mg-histogram');\n\n      var bar = g.selectAll('.mg-bar')\n        .data(args.data[0])\n        .enter().append('g')\n        .attr('class', 'mg-bar')\n        .attr('transform', function(d) {\n          return \"translate(\" + args.scales.X(d[args.x_accessor]).toFixed(2) + \",\" + args.scales.Y(d[args.y_accessor]).toFixed(2) + \")\";\n        });\n\n      //draw bars\n      bar.append('rect')\n        .attr('x', 1)\n        .attr('width', function(d, i) {\n          if (args.data[0].length === 1) {\n            return (args.scalefns.xf(args.data[0][0]) - args.bar_margin).toFixed(0);\n          } else if (i !== args.data[0].length - 1) {\n            return (args.scalefns.xf(args.data[0][i + 1]) - args.scalefns.xf(d)).toFixed(0);\n          } else {\n            return (args.scalefns.xf(args.data[0][1]) - args.scalefns.xf(args.data[0][0])).toFixed(0);\n          }\n        })\n        .attr('height', function(d) {\n          if (d[args.y_accessor] === 0) {\n            return 0;\n          }\n\n          return (args.height - args.bottom - args.buffer - args.scales.Y(d[args.y_accessor])).toFixed(2);\n        });\n\n      return this;\n    };\n\n    this.markers = function() {\n      markers(args);\n      return this;\n    };\n\n    this.rollover = function() {\n      var svg = mg_get_svg_child_of(args.target);\n\n      if (svg.selectAll('.mg-active-datapoint-container').nodes().length === 0) {\n        mg_add_g(svg, 'mg-active-datapoint-container');\n      }\n\n      //remove the old rollovers if they already exist\n      svg.selectAll('.mg-rollover-rect').remove();\n      svg.selectAll('.mg-active-datapoint').remove();\n\n      var g = svg.append('g')\n        .attr('class', 'mg-rollover-rect');\n\n      //draw rollover bars\n      var bar = g.selectAll('.mg-bar')\n        .data(args.data[0])\n        .enter().append('g')\n        .attr('class', function(d, i) {\n          if (args.linked) {\n            return 'mg-rollover-rects roll_' + i;\n          } else {\n            return 'mg-rollover-rects';\n          }\n        })\n        .attr('transform', function(d) {\n          return \"translate(\" + (args.scales.X(d[args.x_accessor])) + \",\" + 0 + \")\";\n        });\n\n      bar.append('rect')\n        .attr('x', 1)\n        .attr('y', args.buffer + args.title_y_position)\n        .attr('width', function(d, i) {\n          //if data set is of length 1\n          if (args.data[0].length === 1) {\n            return (args.scalefns.xf(args.data[0][0]) - args.bar_margin).toFixed(0);\n          } else if (i !== args.data[0].length - 1) {\n            return (args.scalefns.xf(args.data[0][i + 1]) - args.scalefns.xf(d)).toFixed(0);\n          } else {\n            return (args.scalefns.xf(args.data[0][1]) - args.scalefns.xf(args.data[0][0])).toFixed(0);\n          }\n        })\n        .attr('height', function(d) {\n          return args.height;\n        })\n        .attr('opacity', 0)\n        .on('mouseover', this.rolloverOn(args))\n        .on('mouseout', this.rolloverOff(args))\n        .on('mousemove', this.rolloverMove(args));\n\n      return this;\n    };\n\n    this.rolloverOn = function(args) {\n      var svg = mg_get_svg_child_of(args.target);\n\n      return function(d, i) {\n        svg.selectAll('text')\n          .filter(function(g, j) {\n            return d === g;\n          })\n          .attr('opacity', 0.3);\n\n        var fmt = args.processed.xax_format || MG.time_format(args.utc_time, '%b %e, %Y');\n        var num = format_rollover_number(args);\n\n        svg.selectAll('.mg-bar rect')\n          .filter(function(d, j) {\n            return j === i;\n          })\n          .classed('active', true);\n\n        //trigger mouseover on all matching bars\n        if (args.linked && !MG.globals.link) {\n          MG.globals.link = true;\n\n          //trigger mouseover on matching bars in .linked charts\n          d3.selectAll('.mg-rollover-rects.roll_' + i + ' rect')\n            .each(function(d) { //use existing i\n              d3.select(this).on('mouseover')(d, i);\n            });\n        }\n\n        //update rollover text\n        if (args.show_rollover_text) {\n          var mo = mg_mouseover_text(args, { svg: svg });\n          var row = mo.mouseover_row();\n          row.text('\\u259F  ').elem()\n            .classed('hist-symbol', true);\n\n          row.text(mg_format_x_mouseover(args, d)); // x\n          row.text(mg_format_y_mouseover(args, d, args.time_series === false));\n        }\n\n        if (args.mouseover) {\n          mg_setup_mouseover_container(svg, args);\n          args.mouseover(d, i);\n        }\n      };\n    };\n\n    this.rolloverOff = function(args) {\n      var svg = mg_get_svg_child_of(args.target);\n\n      return function(d, i) {\n        if (args.linked && MG.globals.link) {\n          MG.globals.link = false;\n\n          //trigger mouseout on matching bars in .linked charts\n          d3.selectAll('.mg-rollover-rects.roll_' + i + ' rect')\n            .each(function(d) { //use existing i\n              d3.select(this).on('mouseout')(d, i);\n            });\n        }\n\n        //reset active bar\n        svg.selectAll('.mg-bar rect')\n          .classed('active', false);\n\n        //reset active data point text\n        mg_clear_mouseover_container(svg);\n\n        if (args.mouseout) {\n          args.mouseout(d, i);\n        }\n      };\n    };\n\n    this.rolloverMove = function(args) {\n      return function(d, i) {\n        if (args.mousemove) {\n          args.mousemove(d, i);\n        }\n      };\n    };\n\n    this.windowListeners = function() {\n      mg_window_listeners(this.args);\n      return this;\n    };\n\n    this.init(args);\n  }\n\n  var defaults = {\n    binned: false,\n    bins: null,\n    processed_x_accessor: 'x',\n    processed_y_accessor: 'y',\n    processed_dx_accessor: 'dx',\n    bar_margin: 1\n  };\n\n  MG.register('histogram', histogram, defaults);\n}).call(this);\n\nfunction point_mouseover(args, svg, d) {\n  var mouseover = mg_mouseover_text(args, { svg: svg });\n  var row = mouseover.mouseover_row();\n\n  if (args.color_accessor !== null && args.color_type === 'category') {\n    var label = d[args.color_accessor];\n    row.text(label + '  ').bold().elem().attr('fill', args.scalefns.colorf(d));\n  }\n\n  mg_color_point_mouseover(args, row.text('\\u25CF   ').elem(), d); // point shape\n\n  row.text(mg_format_x_mouseover(args, d)); // x\n  row.text(mg_format_y_mouseover(args, d, args.time_series === false));\n}\n\nfunction mg_color_point_mouseover(args, elem, d) {\n  if (args.color_accessor !== null) {\n    elem.attr('fill', args.scalefns.colorf(d));\n    elem.attr('stroke', args.scalefns.colorf(d));\n  } else {\n    elem.classed('mg-points-mono', true);\n  }\n}\n\n\n(function() {\n  'use strict';\n\n  function mg_filter_out_plot_bounds(data, args) {\n    // max_x, min_x, max_y, min_y;\n    var x = args.x_accessor;\n    var y = args.y_accessor;\n    var new_data = data.filter(function(d) {\n      return (args.min_x === null || d[x] >= args.min_x) &&\n        (args.max_x === null || d[x] <= args.max_x) &&\n        (args.min_y === null || d[y] >= args.min_y) &&\n        (args.max_y === null || d[y] <= args.max_y);\n    })\n    return new_data;\n  }\n\n  function pointChart(args) {\n    this.init = function(args) {\n      this.args = args;\n\n      // infer y_axis and x_axis type;\n      args.x_axis_type = mg_infer_type(args, 'x');\n      args.y_axis_type = mg_infer_type(args, 'y');\n\n      raw_data_transformation(args);\n\n      process_point(args);\n      init(args);\n\n      var xMaker, yMaker;\n\n      if (args.x_axis_type === 'categorical') {\n        xMaker = MG.scale_factory(args)\n          .namespace('x')\n          .categoricalDomainFromData()\n          .categoricalRangeBands([0, args.xgroup_height], args.xgroup_accessor === null);\n\n        if (args.xgroup_accessor) {\n          new MG.scale_factory(args)\n            .namespace('xgroup')\n            .categoricalDomainFromData()\n            .categoricalRangeBands('bottom');\n\n        } else {\n          args.scales.XGROUP = function(d) {\n            return mg_get_plot_left(args) };\n          args.scalefns.xgroupf = function(d) {\n            return mg_get_plot_left(args) };\n        }\n\n        args.scalefns.xoutf = function(d) {\n          return args.scalefns.xf(d) + args.scalefns.xgroupf(d)\n        };\n      } else {\n        xMaker = MG.scale_factory(args)\n          .namespace('x')\n          .inflateDomain(true)\n          .zeroBottom(args.y_axis_type === 'categorical')\n          .numericalDomainFromData((args.baselines || []).map(function(d) {\n            return d[args.x_accessor] }))\n          .numericalRange('bottom');\n\n        args.scalefns.xoutf = args.scalefns.xf;\n      }\n\n      // y-scale generation. This needs to get simplified.\n      if (args.y_axis_type === 'categorical') {\n        yMaker = MG.scale_factory(args)\n          .namespace('y')\n          .zeroBottom(true)\n          .categoricalDomainFromData()\n          .categoricalRangeBands([0, args.ygroup_height], true);\n\n        if (args.ygroup_accessor) {\n\n          new MG.scale_factory(args)\n            .namespace('ygroup')\n            .categoricalDomainFromData()\n            .categoricalRangeBands('left');\n\n        } else {\n          args.scales.YGROUP = function() {\n            return mg_get_plot_top(args) };\n          args.scalefns.ygroupf = function(d) {\n            return mg_get_plot_top(args) };\n\n        }\n        args.scalefns.youtf = function(d) {\n          return args.scalefns.yf(d) + args.scalefns.ygroupf(d) };\n\n      } else {\n        var baselines = (args.baselines || []).map(function(d) {\n          return d[args.y_accessor] });\n        yMaker = MG.scale_factory(args)\n          .namespace('y')\n          .inflateDomain(true)\n          .zeroBottom(args.x_axis_type === 'categorical')\n          .numericalDomainFromData(baselines)\n          .numericalRange('left');\n\n        args.scalefns.youtf = function(d) {\n          return args.scalefns.yf(d) };\n      }\n\n      /////// COLOR accessor\n      if (args.color_accessor !== null) {\n        var colorScale = MG.scale_factory(args).namespace('color');\n        if (args.color_type === 'number') {\n          // do the color scale.\n          // etiher get color range, or what.\n          colorScale\n            .numericalDomainFromData(mg_get_color_domain(args))\n            .numericalRange(mg_get_color_range(args))\n            .clamp(true);\n        } else {\n          if (args.color_domain) {\n            colorScale\n              .categoricalDomain(args.color_domain)\n              .categoricalRange(args.color_range);\n          } else {\n            colorScale\n              .categoricalDomainFromData()\n              .categoricalColorRange();\n          }\n        }\n      }\n\n      if (args.size_accessor) {\n        new MG.scale_factory(args).namespace('size')\n          .numericalDomainFromData()\n          .numericalRange(mg_get_size_range(args))\n          .clamp(true);\n      }\n\n      new MG.axis_factory(args)\n        .namespace('x')\n        .type(args.x_axis_type)\n        .zeroLine(args.y_axis_type === 'categorical')\n        .position(args.x_axis_position)\n        .rug(x_rug(args))\n        .label(mg_add_x_label)\n        .draw();\n\n      new MG.axis_factory(args)\n        .namespace('y')\n        .type(args.y_axis_type)\n        .zeroLine(args.x_axis_type === 'categorical')\n        .position(args.y_axis_position)\n        .rug(y_rug(args))\n        .label(mg_add_y_label)\n        .draw();\n\n      this.mainPlot();\n      this.markers();\n      this.rollover();\n      this.windowListeners();\n\n      return this;\n    };\n\n    this.markers = function() {\n      markers(args);\n      if (args.least_squares) {\n        add_ls(args);\n      }\n\n      return this;\n    };\n\n    this.mainPlot = function() {\n      var svg = mg_get_svg_child_of(args.target);\n      var g;\n\n      var data = mg_filter_out_plot_bounds(args.data[0], args);\n      //remove the old points, add new one\n      svg.selectAll('.mg-points').remove();\n\n      g = svg.append('g')\n        .classed('mg-points', true);\n\n\n      var pts = g.selectAll('circle')\n        .data(data)\n        .enter().append('circle')\n        .attr('class', function(d, i) {\n          return 'path-' + i;\n        })\n        .attr('cx', args.scalefns.xoutf)\n        .attr('cy', function(d) {\n          return args.scalefns.youtf(d);\n        });\n\n      //are we coloring our points, or just using the default color?\n      if (args.color_accessor !== null) {\n        pts.attr('fill', args.scalefns.colorf);\n        pts.attr('stroke', args.scalefns.colorf);\n      } else {\n        pts.classed('mg-points-mono', true);\n      }\n\n      if (args.size_accessor !== null) {\n        pts.attr('r', args.scalefns.sizef);\n      } else {\n        pts.attr('r', args.point_size);\n      }\n\n      return this;\n    };\n\n    this.rollover = function() {\n      var svg = mg_get_svg_child_of(args.target);\n\n      if (svg.selectAll('.mg-active-datapoint-container').nodes().length === 0) {\n        mg_add_g(svg, 'mg-active-datapoint-container');\n      }\n\n      //remove the old rollovers if they already exist\n      svg.selectAll('.mg-voronoi').remove();\n\n      //add rollover paths\n      var voronoi = d3.voronoi()\n        .x(args.scalefns.xoutf)\n        .y(args.scalefns.youtf)\n        .extent([\n          [args.buffer, args.buffer + args.title_y_position],\n          [args.width - args.buffer, args.height - args.buffer]\n        ]);\n\n      var paths = svg.append('g')\n        .attr('class', 'mg-voronoi');\n\n      paths.selectAll('path')\n        .data(voronoi.polygons(mg_filter_out_plot_bounds(args.data[0], args)))\n        .enter().append('path')\n        .attr('d', function(d) {\n          return d == null ? null : 'M' + d.join(',') + 'Z'; })\n        .attr('class', function(d, i) {\n          return 'path-' + i;\n        })\n        .style('fill-opacity', 0)\n        .on('mouseover', this.rolloverOn(args))\n        .on('mouseout', this.rolloverOff(args))\n        .on('mousemove', this.rolloverMove(args));\n\n      if (args.data[0].length === 1) {\n        point_mouseover(args, svg, args.data[0][0]);\n      }\n\n      return this;\n    };\n\n    this.rolloverOn = function(args) {\n      var svg = mg_get_svg_child_of(args.target);\n\n      return function(d, i) {\n        svg.selectAll('.mg-points circle')\n          .classed('selected', false);\n\n        //highlight active point\n        var pts = svg.selectAll('.mg-points circle.path-' + i)\n          .classed('selected', true);\n\n        if (args.size_accessor) {\n          pts.attr('r', function(di) {\n            return args.scalefns.sizef(di) + args.active_point_size_increase;\n          });\n        } else {\n          pts.attr('r', args.point_size + args.active_point_size_increase);\n        }\n\n        //trigger mouseover on all points for this class name in .linked charts\n        if (args.linked && !MG.globals.link) {\n          MG.globals.link = true;\n\n          //trigger mouseover on matching point in .linked charts\n          d3.selectAll('.mg-voronoi .path-' + i)\n            .each(function() {\n              d3.select(this).on('mouseover')(d, i);\n            });\n        }\n\n        if (args.show_rollover_text) {\n          point_mouseover(args, svg, d.data);\n        }\n\n        if (args.mouseover) {\n          args.mouseover(d, i);\n        }\n      };\n    };\n\n    this.rolloverOff = function(args) {\n      var svg = mg_get_svg_child_of(args.target);\n\n      return function(d, i) {\n        if (args.linked && MG.globals.link) {\n          MG.globals.link = false;\n\n          d3.selectAll('.mg-voronoi .path-' + i)\n            .each(function() {\n              d3.select(this).on('mouseout')(d, i);\n            });\n        }\n\n        //reset active point\n        var pts = svg.selectAll('.mg-points circle')\n          .classed('unselected', false)\n          .classed('selected', false);\n\n        if (args.size_accessor) {\n          pts.attr('r', args.scalefns.sizef);\n        } else {\n          pts.attr('r', args.point_size);\n        }\n\n        //reset active data point text\n        if (args.data[0].length > 1) mg_clear_mouseover_container(svg);\n\n        if (args.mouseout) {\n          args.mouseout(d, i);\n        }\n      };\n    };\n\n    this.rolloverMove = function(args) {\n      return function(d, i) {\n        if (args.mousemove) {\n          args.mousemove(d, i);\n        }\n      };\n    };\n\n    this.update = function(args) {\n      return this;\n    };\n\n    this.windowListeners = function() {\n      mg_window_listeners(this.args);\n      return this;\n    };\n\n    this.init(args);\n  }\n\n  var defaults = {\n    y_padding_percentage: 0.05, // for categorical scales\n    y_outer_padding_percentage: .2, // for categorical scales\n    ygroup_padding_percentage: 0, // for categorical scales\n    ygroup_outer_padding_percentage: 0, // for categorical scales\n    x_padding_percentage: 0.05, // for categorical scales\n    x_outer_padding_percentage: .2, // for categorical scales\n    xgroup_padding_percentage: 0, // for categorical scales\n    xgroup_outer_padding_percentage: 0, // for categorical scales\n    y_categorical_show_guides: true,\n    x_categorical_show_guides: true,\n    buffer: 16,\n    ls: false,\n    lowess: false,\n    point_size: 2.5,\n    label_accessor: null,\n    size_accessor: null,\n    color_accessor: null,\n    size_range: null, // when we set a size_accessor option, this array determines the size range, e.g. [1,5]\n    color_range: null, // e.g. ['blue', 'red'] to color different groups of points\n    size_domain: null,\n    color_domain: null,\n    active_point_size_increase: 1,\n    color_type: 'number' // can be either 'number' - the color scale is quantitative - or 'category' - the color scale is qualitative.\n  };\n\n  MG.register('point', pointChart, defaults);\n}).call(this);\n\n(function() {\n  'use strict';\n\n  // TODO add styles to stylesheet instead\n  function scaffold(args) {\n    var svg = mg_get_svg_child_of(args.target);\n    // main margins\n    svg.append('line')\n      .attr('x1', 0)\n      .attr('x2', args.width)\n      .attr('y1', args.top)\n      .attr('y2', args.top)\n      .attr('stroke', 'black');\n    svg.append('line')\n      .attr('x1', 0)\n      .attr('x2', args.width)\n      .attr('y1', args.height-args.bottom)\n      .attr('y2', args.height-args.bottom)\n      .attr('stroke', 'black');\n\n    svg.append('line')\n      .attr('x1', args.left)\n      .attr('x2', args.left)\n      .attr('y1', 0)\n      .attr('y2', args.height)\n      .attr('stroke', 'black');\n\n    svg.append('line')\n      .attr('x1', args.width-args.right)\n      .attr('x2', args.width-args.right)\n      .attr('y1', 0)\n      .attr('y2', args.height)\n      .attr('stroke', 'black');\n\n    // plot area margins\n    svg.append('line')\n      .attr('x1', 0)\n      .attr('x2', args.width)\n      .attr('y1', args.height-args.bottom-args.buffer)\n      .attr('y2', args.height-args.bottom-args.buffer)\n      .attr('stroke', 'gray');\n\n    svg.append('line')\n      .attr('x1', 0)\n      .attr('x2', args.width)\n      .attr('y1', args.top+args.buffer)\n      .attr('y2', args.top+args.buffer)\n      .attr('stroke', 'gray');\n\n    svg.append('line')\n      .attr('x1', args.left + args.buffer)\n      .attr('x2', args.left + args.buffer)\n      .attr('y1', 0)\n      .attr('y2', args.height)\n      .attr('stroke', 'gray');\n    svg.append('line')\n      .attr('x1', args.width -args.right - args.buffer)\n      .attr('x2', args.width -args.right - args.buffer)\n      .attr('y1', 0)\n      .attr('y2', args.height)\n      .attr('stroke', 'gray');\n  }\n\n  // barchart re-write.\n  function mg_targeted_legend(args) {\n    var labels;\n    var plot = '';\n    if (args.legend_target) {\n\n      var div = d3.select(args.legend_target).append('div').classed('mg-bar-target-legend', true);\n      \n      if (args.orientation == 'horizontal') labels = args.scales.Y.domain()\n      else labels = args.scales.X.domain();\n\n      labels.forEach(function(label) {\n        var outer_span = div.append('span').classed('mg-bar-target-element', true);\n        outer_span.append('span')\n          .classed('mg-bar-target-legend-shape', true)\n          .style('color', args.scales.COLOR(label))\n          .text('\\u25FC ');\n        outer_span.append('span')\n          .classed('mg-bar-target-legend-text', true)\n          .text(label);\n\n      });\n    }\n  }\n\n  function legend_on_graph(svg, args) {\n    // draw each element at the top right\n    // get labels\n\n    var labels;\n    if (args.orientation=='horizontal') labels = args.scales.Y.domain()\n    else labels = args.scales.X.domain();\n\n    var lineCount = 0;\n    var lineHeight = 1.1;\n    var g = svg.append('g').classed(\"mg-bar-legend\", true);\n    var textContainer = g.append('text');\n\n    //\n\n    textContainer\n      .selectAll('*')\n      .remove();\n    textContainer\n      .attr('width', args.right)\n      .attr('height', 100)\n      .attr('text-anchor', 'start');\n\n    labels.forEach(function(label) {\n      var sub_container = textContainer.append('tspan')\n        .attr('x', mg_get_plot_right(args))\n        .attr('y', args.height / 2)\n        .attr('dy', (lineCount * lineHeight) + 'em');\n      sub_container.append('tspan')\n        .text('\\u25a0 ')\n        .attr('fill', args.scales.COLOR(label))\n        .attr('font-size', 20)\n      sub_container.append('tspan')\n        .text(label)\n        .attr('font-weight', 300)\n        .attr('font-size', 10);\n      lineCount++;\n    })\n\n    // d.values.forEach(function (datum) {\n    //   formatted_y = mg_format_y_rollover(args, num, datum);\n\n    //   if (args.y_rollover_format !== null) {\n    //     formatted_y = number_rollover_format(args.y_rollover_format, datum, args.y_accessor);\n    //   } else {\n    //     formatted_y = args.yax_units + num(datum[args.y_accessor]);\n    //   }\n\n    //   sub_container = textContainer.append('tspan').attr('x', 0).attr('y', (lineCount * lineHeight) + 'em');\n    //   formatted_y = mg_format_y_rollover(args, num, datum);\n    //   mouseover_tspan(sub_container, '\\u2014  ')\n    //     .color(args, datum);\n    //   mouseover_tspan(sub_container, formatted_x + ' ' + formatted_y);\n\n    //   lineCount++;\n    // });\n  }\n\n  function barChart(args) {\n    this.args = args;\n\n    this.init = function(args) {\n      this.args = args;\n      args.x_axis_type = mg_infer_type(args, 'x');\n      args.y_axis_type = mg_infer_type(args, 'y');\n\n      // this is specific to how rects work in svg, let's keep track of the bar orientation to\n      // plot appropriately.\n      if (args.x_axis_type == 'categorical') {\n        args.orientation = 'vertical';\n      } else if (args.y_axis_type == 'categorical') {\n        args.orientation = 'horizontal';\n      } else if (args.x_axis_type != 'categorical' && args.y_axis_type != 'categorical') {\n        // histogram.\n        args.orientation = 'vertical';\n      }\n\n      raw_data_transformation(args);\n\n      process_point(args);\n      init(args);\n\n      var xMaker, yMaker;\n\n      if (args.x_axis_type === 'categorical') {\n        xMaker = MG.scale_factory(args)\n          .namespace('x')\n          .categoricalDomainFromData()\n          .categoricalRangeBands([0, args.xgroup_height], args.xgroup_accessor === null);\n\n        if (args.xgroup_accessor) {\n          new MG.scale_factory(args)\n            .namespace('xgroup')\n            .categoricalDomainFromData()\n            .categoricalRangeBands('bottom');\n\n        } else {\n          args.scales.XGROUP = function(d) {\n            return mg_get_plot_left(args) };\n          args.scalefns.xgroupf = function(d) {\n            return mg_get_plot_left(args) };\n        }\n\n        args.scalefns.xoutf = function(d) {\n          return args.scalefns.xf(d) + args.scalefns.xgroupf(d)\n        };\n      } else {\n        xMaker = MG.scale_factory(args)\n          .namespace('x')\n          .inflateDomain(true)\n          .zeroBottom(args.y_axis_type === 'categorical')\n          .numericalDomainFromData((args.baselines || []).map(function(d) {\n            return d[args.x_accessor] }))\n          .numericalRange('bottom');\n\n        args.scalefns.xoutf = args.scalefns.xf;\n      }\n\n      // y-scale generation. This needs to get simplified.\n      if (args.y_axis_type === 'categorical') {\n        yMaker = MG.scale_factory(args)\n          .namespace('y')\n          .zeroBottom(true)\n          .categoricalDomainFromData()\n          .categoricalRangeBands([0, args.ygroup_height], true);\n\n        if (args.ygroup_accessor) {\n\n          new MG.scale_factory(args)\n            .namespace('ygroup')\n            .categoricalDomainFromData()\n            .categoricalRangeBands('left');\n\n        } else {\n          args.scales.YGROUP = function() {\n            return mg_get_plot_top(args) };\n          args.scalefns.ygroupf = function(d) {\n            return mg_get_plot_top(args) };\n\n        }\n        args.scalefns.youtf = function(d) {\n          return args.scalefns.yf(d) + args.scalefns.ygroupf(d) };\n\n      } else {\n        var baselines = (args.baselines || []).map(function(d) {\n          return d[args.y_accessor] });\n\n        yMaker = MG.scale_factory(args)\n          .namespace('y')\n          .inflateDomain(true)\n          .zeroBottom(args.x_axis_type === 'categorical')\n          .numericalDomainFromData(baselines)\n          .numericalRange('left');\n\n        args.scalefns.youtf = function(d) {\n          return args.scalefns.yf(d) };\n      }\n\n      if (args.ygroup_accessor !== null) {\n        args.ycolor_accessor = args.y_accessor;\n        MG.scale_factory(args)\n          .namespace('ycolor')\n          .scaleName('color')\n          .categoricalDomainFromData()\n          .categoricalColorRange();\n      }\n\n      if (args.xgroup_accessor !== null) {\n        args.xcolor_accessor = args.x_accessor;\n        MG.scale_factory(args)\n          .namespace('xcolor')\n          .scaleName('color')\n          .categoricalDomainFromData()\n          .categoricalColorRange();\n      }\n\n      // if (args.ygroup_accessor !== null) {\n      //   MG.scale_factory(args)\n      //     .namespace('ygroup')\n      //     .categoricalDomainFromData()\n      //     .categoricalColorRange();\n      // }\n\n      new MG.axis_factory(args)\n        .namespace('x')\n        .type(args.x_axis_type)\n        .zeroLine(args.y_axis_type === 'categorical')\n        .position(args.x_axis_position)\n        .draw();\n\n      new MG.axis_factory(args)\n        .namespace('y')\n        .type(args.y_axis_type)\n        .zeroLine(args.x_axis_type === 'categorical')\n        .position(args.y_axis_position)\n        .draw();\n\n      //mg_categorical_group_color_scale(args);\n\n      this.mainPlot();\n      this.markers();\n      this.rollover();\n      this.windowListeners();\n      //scaffold(args)\n\n      return this;\n    };\n\n    this.mainPlot = function() {\n      var svg = mg_get_svg_child_of(args.target);\n      var data = args.data[0];\n      var barplot = svg.select('g.mg-barplot');\n      var fresh_render = barplot.empty();\n\n      var bars;\n      var predictor_bars;\n      var pp, pp0;\n      var baseline_marks;\n\n      var perform_load_animation = fresh_render && args.animate_on_load;\n      var should_transition = perform_load_animation || args.transition_on_update;\n      var transition_duration = args.transition_duration || 1000;\n\n      // draw the plot on first render\n      if (fresh_render) {\n        barplot = svg.append('g')\n          .classed('mg-barplot', true);\n      }\n\n      bars = barplot.selectAll('.mg-bar')\n        .data(data)\n        .enter()\n        .append('rect')\n          .classed('mg-bar', true)\n          .classed('default-bar', args.scales.hasOwnProperty('COLOR') ? false : true);\n\n      // TODO - reimplement\n\n      // reference_accessor {}\n\n      // if (args.predictor_accessor) {\n      //   predictor_bars = barplot.selectAll('.mg-bar-prediction')\n      //     .data(data.filter(function(d) {\n      //       return d.hasOwnProperty(args.predictor_accessor) }));\n\n      //   predictor_bars.exit().remove();\n\n      //   predictor_bars.enter().append('rect')\n      //     .classed('mg-bar-prediction', true);\n      // }\n\n      // if (args.baseline_accessor) {\n      //   baseline_marks = barplot.selectAll('.mg-bar-baseline')\n      //     .data(data.filter(function(d) {\n      //       return d.hasOwnProperty(args.baseline_accessor) }));\n\n      //   baseline_marks.exit().remove();\n\n      //   baseline_marks.enter().append('line')\n      //     .classed('mg-bar-baseline', true);\n      // }\n\n      var appropriate_size;\n\n      // setup transitions\n      // if (should_transition) {\n      //   bars = bars.transition()\n      //     .duration(transition_duration);\n\n      //   if (predictor_bars) {\n      //     predictor_bars = predictor_bars.transition()\n      //       .duration(transition_duration);\n      //   }\n\n      //   if (baseline_marks) {\n      //     baseline_marks = baseline_marks.transition()\n      //       .duration(transition_duration);\n      //   }\n      // }\n\n      //appropriate_size = args.scales.Y_ingroup.rangeBand()/1.5;\n      var length, width, length_type, width_type, length_coord, width_coord,\n          length_scalefn, width_scalefn, length_scale, width_scale,\n          length_accessor, width_accessor, length_coord_map, width_coord_map,\n          length_map, width_map;\n\n      var reference_length_map, reference_length_coord_fn;\n\n      if (args.orientation == 'vertical') {\n        length = 'height';\n        width = 'width';\n        length_type = args.y_axis_type;\n        width_type = args.x_axis_type;\n        length_coord = 'y';\n        width_coord = 'x';\n        length_scalefn = length_type == 'categorical' ? args.scalefns.youtf : args.scalefns.yf;\n        width_scalefn  = width_type == 'categorical' ? args.scalefns.xoutf : args.scalefns.xf;\n        length_scale   = args.scales.Y;\n        width_scale     = args.scales.X;\n        length_accessor = args.y_accessor;\n        width_accessor = args.x_accessor;\n\n        length_coord_map = function(d) {\n          var l;\n          l = length_scalefn(d);\n          if (d[length_accessor] < 0) {\n            l = length_scale(0);\n          }\n          return l;\n        }\n\n        length_map = function(d) {\n          return Math.abs(length_scalefn(d) - length_scale(0));\n        }\n\n        reference_length_map = function(d) {\n          return Math.abs(length_scale(d[args.reference_accessor]) - length_scale(0));\n        }\n\n        reference_length_coord_fn = function(d){\n          return length_scale(d[args.reference_accessor]);\n        }\n      }\n\n      if (args.orientation == 'horizontal') {\n        length = 'width';\n        width = 'height';\n        length_type = args.x_axis_type;\n        width_type = args.y_axis_type;\n        length_coord = 'x';\n        width_coord = 'y';\n        length_scalefn = length_type == 'categorical' ? args.scalefns.xoutf : args.scalefns.xf;\n        width_scalefn = width_type == 'categorical' ? args.scalefns.youtf : args.scalefns.yf;\n        length_scale = args.scales.X;\n        width_scale = args.scales.Y;\n        length_accessor = args.x_accessor;\n        width_accessor = args.y_accessor;\n\n        length_coord_map = function(d) {\n          var l;\n          l = length_scale(0);\n          return l;\n        }\n\n        length_map = function(d) {\n          return Math.abs(length_scalefn(d) - length_scale(0));\n        }\n\n        reference_length_map = function(d) {\n          return Math.abs(length_scale(d[args.reference_accessor]) - length_scale(0));\n        }\n\n        reference_length_coord_fn = function(d){\n          return length_scale(0);\n        }\n      }\n\n      // if (perform_load_animation) {\n      //   bars.attr(length, 0);\n\n      //   if (predictor_bars) {\n      //     predictor_bars.attr(length, 0);\n      //   }\n\n      //   // if (baseline_marks) {\n      //   //   baseline_marks.attr({\n      //   //     x1: args.scales.X(0),\n      //   //     x2: args.scales.X(0)\n      //   //   });\n      //   // }\n      // }\n\n      bars.attr(length_coord, length_coord_map);\n\n      // bars.attr(length_coord, 40)\n      //bars.attr(width_coord, 70)\n\n\n\n      bars.attr(width_coord, function(d) {\n        var w;\n        if (width_type == 'categorical') {\n          w = width_scalefn(d);\n        } else {\n          w = width_scale(0);\n          if (d[width_accessor] < 0) {\n            w = width_scalefn(d);\n          }\n        }\n        w = w - args.bar_thickness/2;\n        return w;\n      });\n\n      if (args.scales.COLOR) {\n        bars.attr('fill', args.scalefns.colorf)\n      }\n\n      bars\n        .attr(length, length_map)\n        .attr(width, function(d) {\n          return args.bar_thickness;\n      });\n\n\n\n\n      if (args.reference_accessor !== null) {\n        var reference_data = data.filter(function(d){\n          return d.hasOwnProperty(args.reference_accessor);\n        })\n        var reference_bars = barplot.selectAll('.mg-categorical-reference')\n          .data(reference_data)\n          .enter()\n          .append('rect');\n\n        reference_bars\n          .attr(length_coord, reference_length_coord_fn)\n          .attr(width_coord, function(d) {\n            return width_scalefn(d) - args.reference_thickness/2\n          })\n          .attr(length, reference_length_map)\n          .attr(width, args.reference_thickness);\n      }\n\n      if (args.comparison_accessor !== null) {\n        var comparison_thickness = null;\n        if (args.comparison_thickness === null) {\n          comparison_thickness = args.bar_thickness/2;\n        } else {\n          comparison_thickness = args.comparison_thickness;\n        }\n\n\n        var comparison_data = data.filter(function(d) {\n          return d.hasOwnProperty(args.comparison_accessor);\n        })\n        var comparison_marks = barplot.selectAll('.mg-categorical-comparison')\n          .data(comparison_data)\n          .enter()\n          .append('line');\n\n        comparison_marks\n          .attr(length_coord + '1', function(d){return length_scale(d[args.comparison_accessor])})\n          .attr(length_coord + '2', function(d){return length_scale(d[args.comparison_accessor])})\n          .attr(width_coord + '1',  function(d){\n            return width_scalefn(d) - comparison_thickness/2;\n          })\n          .attr(width_coord + '2', function(d) {\n            return width_scalefn(d) + comparison_thickness/2;\n          })\n          .attr('stroke', 'black')\n          .attr('stroke-width', args.comparison_width);\n      }\n\n        //bars.attr(width_coord, );\n        // bars.attr('width', 50);\n        // bars.attr('height', 50);\n        // bars.attr('y', function(d){\n        //   var y = args.scales.Y(0);\n        //   if (d[args.y_accessor] < 0) {\n        //     y = args.scalefns.yf(d);\n        //   }\n        //   return y;\n        // });\n\n        // bars.attr('x', function(d){\n        //   return 40;\n        // })\n\n        // bars.attr('width', function(d){\n        //   return 100;\n        // });\n\n        // bars.attr('height', 100);\n\n        // bars.attr('fill', 'black');\n        // bars.attr('x', function(d) {\n        //   var x = args.scales.X(0);\n        //   if (d[args.x_accessor] < 0) {\n        //     x = args.scalefns.xf(d);\n        //   }\n        //   return x;\n        // })\n        // TODO - reimplement.\n        // if (args.predictor_accessor) {\n        //   predictor_bars\n        //     .attr('x', args.scales.X(0))\n        //     .attr('y', function(d) {\n        //       return args.scalefns.ygroupf(d) + args.scalefns.yf(d) + args.scales.Y.rangeBand() * (7 / 16) // + pp0 * appropriate_size/(pp*2) + appropriate_size / 2;\n        //     })\n        //     .attr('height', args.scales.Y.rangeBand() / 8) //appropriate_size / pp)\n        //     .attr('width', function(d) {\n        //       return args.scales.X(d[args.predictor_accessor]) - args.scales.X(0);\n        //     });\n        // }\n\n      // TODO - reimplement.\n      //   if (args.baseline_accessor) {\n\n      //     baseline_marks\n      //       .attr('x1', function(d) {\n      //         return args.scales.X(d[args.baseline_accessor]); })\n      //       .attr('x2', function(d) {\n      //         return args.scales.X(d[args.baseline_accessor]); })\n      //       .attr('y1', function(d) {\n      //         return args.scalefns.ygroupf(d) + args.scalefns.yf(d) + args.scales.Y.rangeBand() / 4\n      //       })\n      //       .attr('y2', function(d) {\n      //         return args.scalefns.ygroupf(d) + args.scalefns.yf(d) + args.scales.Y.rangeBand() * 3 / 4\n      //       });\n      //   }\n        if (args.legend || (args.color_accessor !== null && args.ygroup_accessor !== args.color_accessor)) {\n        if (!args.legend_target) legend_on_graph(svg, args);\n        else mg_targeted_legend(args);\n      }\n      return this;\n    };\n\n    this.markers = function() {\n      markers(args);\n      return this;\n    };\n\n    this.rollover = function() {\n      var svg = mg_get_svg_child_of(args.target);\n      var g;\n\n      if (svg.selectAll('.mg-active-datapoint-container').nodes().length === 0) {\n        mg_add_g(svg, 'mg-active-datapoint-container');\n      }\n\n      //remove the old rollovers if they already exist\n      svg.selectAll('.mg-rollover-rect').remove();\n      svg.selectAll('.mg-active-datapoint').remove();\n\n      // get orientation\n      var length, width, length_type, width_type, length_coord, width_coord,\n        length_scalefn, width_scalefn, length_scale, width_scale,\n        length_accessor, width_accessor;\n\n      var length_coord_map, width_coord_map, length_map, width_map;\n\n      if (args.orientation == 'vertical') {\n        length = 'height';\n        width = 'width';\n        length_type = args.y_axis_type;\n        width_type = args.x_axis_type;\n        length_coord = 'y';\n        width_coord = 'x';\n        length_scalefn = length_type == 'categorical' ? args.scalefns.youtf : args.scalefns.yf;\n        width_scalefn  = width_type == 'categorical' ? args.scalefns.xoutf : args.scalefns.xf;\n        length_scale   = args.scales.Y;\n        width_scale     = args.scales.X;\n        length_accessor = args.y_accessor;\n        width_accessor = args.x_accessor;\n\n        length_coord_map = function(d){\n          return mg_get_plot_top(args);\n        }\n\n        length_map = function(d) {\n          return args.height -args.top-args.bottom-args.buffer*2\n        }\n      }\n\n      if (args.orientation == 'horizontal') {\n        length = 'width';\n        width = 'height';\n        length_type = args.x_axis_type;\n        width_type = args.y_axis_type;\n        length_coord = 'x';\n        width_coord = 'y';\n        length_scalefn = length_type == 'categorical' ? args.scalefns.xoutf : args.scalefns.xf;\n        width_scalefn = width_type == 'categorical' ? args.scalefns.youtf : args.scalefns.yf;\n        length_scale = args.scales.X;\n        width_scale = args.scales.Y;\n        length_accessor = args.x_accessor;\n        width_accessor = args.y_accessor;\n\n        length_coord_map = function(d){\n          var l;\n          l = length_scale(0);\n          return l;\n        }\n\n        length_map = function(d) {\n          return args.width -args.left-args.right-args.buffer*2\n        }\n      }\n\n      //rollover text\n      var rollover_x, rollover_anchor;\n      if (args.rollover_align === 'right') {\n        rollover_x = args.width - args.right;\n        rollover_anchor = 'end';\n      } else if (args.rollover_align === 'left') {\n        rollover_x = args.left;\n        rollover_anchor = 'start';\n      } else {\n        rollover_x = (args.width - args.left - args.right) / 2 + args.left;\n        rollover_anchor = 'middle';\n      }\n\n      svg.append('text')\n        .attr('class', 'mg-active-datapoint')\n        .attr('xml:space', 'preserve')\n        .attr('x', rollover_x)\n        .attr('y', args.top * 0.75)\n        .attr('dy', '.35em')\n        .attr('text-anchor', rollover_anchor);\n\n      g = svg.append('g')\n        .attr('class', 'mg-rollover-rect');\n\n      //draw rollover bars\n      var bars = g.selectAll(\".mg-bar-rollover\")\n        .data(args.data[0]).enter()\n        .append(\"rect\")\n        .attr('class', 'mg-bar-rollover');\n\n      bars.attr('opacity', 0)\n        .attr(length_coord, length_coord_map)\n        .attr(width_coord, function(d) {\n          var w;\n          if (width_type == 'categorical') {\n            w = width_scalefn(d);\n          } else {\n            w = width_scale(0);\n            if (d[width_accessor] < 0) {\n              w = width_scalefn(d);\n            }\n          }\n          w = w - args.bar_thickness/2;\n          return w;\n        });\n\n      bars.attr(length, length_map)\n      bars.attr(width, function(d) {\n        return args.bar_thickness;\n      });\n\n      bars\n        .on('mouseover', this.rolloverOn(args))\n        .on('mouseout', this.rolloverOff(args))\n        .on('mousemove', this.rolloverMove(args));\n\n      return this;\n    };\n\n    this.rolloverOn = function(args) {\n      var svg = mg_get_svg_child_of(args.target);\n      var label_accessor = this.is_vertical ? args.x_accessor : args.y_accessor;\n      var data_accessor = this.is_vertical ? args.y_accessor : args.x_accessor;\n      var label_units = this.is_vertical ? args.yax_units : args.xax_units;\n\n      return function(d, i) {\n\n        var fmt = MG.time_format(args.utc_time, '%b %e, %Y');\n        var num = format_rollover_number(args);\n\n        //highlight active bar\n        var bar = svg.selectAll('g.mg-barplot .mg-bar')\n          .filter(function(d, j) {\n            return j === i;\n          }).classed('active', true);\n\n        if (args.scales.hasOwnProperty('COLOR')) {\n          bar.attr('fill', d3.rgb(args.scalefns.colorf(d)).darker());\n        } else {\n          bar.classed('default-active', true);\n        }\n\n        //update rollover text\n        if (args.show_rollover_text) {\n          var mouseover = mg_mouseover_text(args, { svg: svg });\n          var row = mouseover.mouseover_row();\n\n          if (args.ygroup_accessor) row.text(d[args.ygroup_accessor] + '   ').bold();\n\n          row.text(mg_format_x_mouseover(args, d));\n          row.text(args.y_accessor + ': ' + d[args.y_accessor]);\n          if (args.predictor_accessor || args.baseline_accessor) {\n            row = mouseover.mouseover_row();\n\n            if (args.predictor_accessor) row.text(mg_format_data_for_mouseover(args, d, null, args.predictor_accessor, false))\n            if (args.baseline_accessor) row.text(mg_format_data_for_mouseover(args, d, null, args.baseline_accessor, false))\n          }\n        }\n        if (args.mouseover) {\n          args.mouseover(d, i);\n        }\n      };\n    };\n\n    this.rolloverOff = function(args) {\n      var svg = mg_get_svg_child_of(args.target);\n\n      return function(d, i) {\n        //reset active bar\n        var bar = svg.selectAll('g.mg-barplot .mg-bar.active').classed('active', false);\n\n        if (args.scales.hasOwnProperty('COLOR')) {\n          bar.attr('fill', args.scalefns.colorf(d));\n        } else {\n          bar.classed('default-active', false);\n        }\n\n        //reset active data point text\n        svg.select('.mg-active-datapoint')\n          .text('');\n\n        mg_clear_mouseover_container(svg);\n\n        if (args.mouseout) {\n          args.mouseout(d, i);\n        }\n      };\n    };\n\n    this.rolloverMove = function(args) {\n      return function(d, i) {\n        if (args.mousemove) {\n          args.mousemove(d, i);\n        }\n      };\n    };\n\n    this.windowListeners = function() {\n      mg_window_listeners(this.args);\n      return this;\n    };\n\n    this.init(args);\n  }\n\n  var defaults = {\n    y_padding_percentage: 0.05, // for categorical scales\n    y_outer_padding_percentage: .2, // for categorical scales\n    ygroup_padding_percentage: 0, // for categorical scales\n    ygroup_outer_padding_percentage: 0, // for categorical scales\n    x_padding_percentage: 0.05, // for categorical scales\n    x_outer_padding_percentage: .2, // for categorical scales\n    xgroup_padding_percentage: 0, // for categorical scales\n    xgroup_outer_padding_percentage: 0, // for categorical scales\n    buffer: 16,\n    y_accessor: 'factor',\n    x_accessor: 'value',\n    reference_accessor: null,\n    comparison_accessor: null,\n    secondary_label_accessor: null,\n    color_accessor: null,\n    color_type: 'category',\n    color_domain: null,\n    reference_thickness: 1,\n    comparison_width: 3,\n    comparison_thickness: null,\n    legend: false,\n    legend_target: null,\n    mouseover_align: 'right',\n    baseline_accessor: null,\n    predictor_accessor: null,\n    predictor_proportion: 5,\n    show_bar_zero: true,\n    binned: true,\n    truncate_x_labels: true,\n    truncate_y_labels: true\n  };\n\n  MG.register('bar', barChart, defaults);\n\n}).call(this);\n\n/*\nData Tables\n\nAlong with histograms, bars, lines, and scatters, a simple data table can take you far.\nWe often just want to look at numbers, organized as a table, where columns are variables,\nand rows are data points. Sometimes we want a cell to have a small graphic as the main\ncolumn element, in which case we want small multiples. sometimes we want to\n\nvar table = New data_table(data)\n        .target('div#data-table')\n        .title({accessor: 'point_name', align: 'left'})\n        .description({accessor: 'description'})\n        .number({accessor: ''})\n\n*/\n\nMG.data_table = function(args) {\n  'use strict';\n  this.args = args;\n  this.args.standard_col = { width: 150, font_size: 12, font_weight: 'normal' };\n  this.args.columns = [];\n  this.formatting_options = [\n    ['color', 'color'],\n    ['font-weight', 'font_weight'],\n    ['font-style', 'font_style'],\n    ['font-size', 'font_size']\n  ];\n\n  this._strip_punctuation = function(s) {\n    var punctuationless = s.replace(/[^a-zA-Z0-9 _]+/g, '');\n    var finalString = punctuationless.replace(/ +?/g, '');\n    return finalString;\n  };\n\n  this._format_element = function(element, value, args) {\n    this.formatting_options.forEach(function(fo) {\n      var attr = fo[0];\n      var key = fo[1];\n      if (args[key]) element.style(attr,\n        typeof args[key] === 'string' ||\n        typeof args[key] === 'number' ?\n        args[key] : args[key](value));\n    });\n  };\n\n  this._add_column = function(_args, arg_type) {\n    var standard_column = this.args.standard_col;\n    var args = merge_with_defaults(MG.clone(_args), MG.clone(standard_column));\n    args.type = arg_type;\n    this.args.columns.push(args);\n  };\n\n  this.target = function() {\n    var target = arguments[0];\n    this.args.target = target;\n    return this;\n  };\n\n  this.title = function() {\n    this._add_column(arguments[0], 'title');\n    return this;\n  };\n\n  this.text = function() {\n    this._add_column(arguments[0], 'text');\n    return this;\n  };\n\n  this.bullet = function() {\n    /*\n    text label\n    main value\n    comparative measure\n    any number of ranges\n\n    additional args:\n    no title\n    xmin, xmax\n    format: percentage\n    xax_formatter\n    */\n    return this;\n  };\n\n  this.sparkline = function() {\n    return this;\n  };\n\n  this.number = function() {\n    this._add_column(arguments[0], 'number');\n    return this;\n  };\n\n  this.display = function() {\n    var args = this.args;\n\n    chart_title(args);\n\n    var target = args.target;\n    var table = d3.select(target).append('table').classed('mg-data-table', true);\n    var colgroup = table.append('colgroup');\n    var thead = table.append('thead');\n    var tbody = table.append('tbody');\n    var this_column;\n    var this_title;\n\n    var tr, th, td_accessor, td_type, td_value, th_text, td_text, td;\n    var col;\n    var h;\n\n    tr = thead.append('tr');\n\n    for (h = 0; h < args.columns.length; h++) {\n      var this_col = args.columns[h];\n      td_type = this_col.type;\n      th_text = this_col.label;\n      th_text = th_text === undefined ? '' : th_text;\n      th = tr.append('th')\n        .style('width', this_col.width)\n        .style('text-align', td_type === 'title' ? 'left' : 'right')\n        .text(th_text);\n\n      if (args.show_tooltips && this_col.description && mg_jquery_exists()) {\n        th.append('i')\n          .classed('fa', true)\n          .classed('fa-question-circle', true)\n          .classed('fa-inverse', true);\n\n        $(th.node()).popover({\n          html: true,\n          animation: false,\n          content: this_col.description,\n          trigger: 'hover',\n          placement: 'top',\n          container: $(th.node())\n        });\n      }\n    }\n\n    for (h = 0; h < args.columns.length; h++) {\n      col = colgroup.append('col');\n      if (args.columns[h].type === 'number') {\n        col.attr('align', 'char').attr('char', '.');\n      }\n    }\n\n    for (var i = 0; i < args.data.length; i++) {\n      tr = tbody.append('tr');\n      for (var j = 0; j < args.columns.length; j++) {\n        this_column = args.columns[j];\n        td_accessor = this_column.accessor;\n        td_value = td_text = args.data[i][td_accessor];\n        td_type = this_column.type;\n\n        if (td_type === 'number') {\n          //td_text may need to be rounded\n          if (this_column.hasOwnProperty('round') && !this_column.hasOwnProperty('format')) {\n            // round according to the number value in this_column.round\n            td_text = d3.format('0,.' + this_column.round + 'f')(td_text);\n          }\n\n          if (this_column.hasOwnProperty('value_formatter')) {\n            // provide a function that formats the text according to the function this_column.format.\n            td_text = this_column.value_formatter(td_text);\n          }\n\n          if (this_column.hasOwnProperty('format')) {\n            // this is a shorthand for percentage formatting, and others if need be.\n            // supported: 'percentage', 'count', 'temperature'\n\n            if (this_column.round) {\n              td_text = Math.round(td_text, this_column.round);\n            }\n\n            var this_format = this_column.format;\n            var formatter;\n\n            if (this_format === 'percentage') formatter = d3.format('.0%');\n            if (this_format === 'count') formatter = d3.format(',.0f');\n            if (this_format === 'temperature') formatter = function(t) {\n              return t + '°'; };\n\n            td_text = formatter(td_text);\n          }\n\n          if (this_column.hasOwnProperty('currency')) {\n            // this is another shorthand for formatting according to a currency amount, which gets appended to front of number\n            td_text = this_column.currency + td_text;\n          }\n        }\n\n        td = tr.append('td')\n          .classed('table-' + td_type, true)\n          .classed('table-' + td_type + '-' + this._strip_punctuation(td_accessor), true)\n          .attr('data-value', td_value)\n          .style('width', this_column.width)\n          .style('text-align', td_type === 'title' || td_type === 'text' ? 'left' : 'right');\n\n        this._format_element(td, td_value, this_column);\n\n        if (td_type === 'title') {\n          this_title = td.append('div').text(td_text);\n          this._format_element(this_title, td_text, this_column);\n\n          if (args.columns[j].hasOwnProperty('secondary_accessor')) {\n            td.append('div')\n              .text(args.data[i][args.columns[j].secondary_accessor])\n              .classed(\"secondary-title\", true);\n          }\n        } else {\n          td.text(td_text);\n        }\n      }\n    }\n\n    return this;\n  };\n\n  return this;\n};\n\n(function() {\n  'use strict';\n\n  function mg_missing_add_text(svg, args) {\n    svg.selectAll('.mg-missing-text').data([args.missing_text])\n      .enter().append('text')\n      .attr('class', 'mg-missing-text')\n      .attr('x', args.width / 2)\n      .attr('y', args.height / 2)\n      .attr('dy', '.50em')\n      .attr('text-anchor', 'middle')\n      .text(args.missing_text);\n  }\n\n  function mg_missing_x_scale(args) {\n    args.scales.X = d3.scaleLinear()\n      .domain([0, args.data.length])\n      .range([mg_get_plot_left(args), mg_get_plot_right(args)]);\n    args.scalefns.yf = function(di) {\n      return args.scales.Y(di.y); };\n  }\n\n  function mg_missing_y_scale(args) {\n    args.scales.Y = d3.scaleLinear()\n      .domain([-2, 2])\n      .range([args.height - args.bottom - args.buffer * 2, args.top]);\n    args.scalefns.xf = function(di) {\n      return args.scales.X(di.x); };\n  }\n\n  function mg_make_fake_data(args) {\n    var data = [];\n    for (var x = 1; x <= 50; x++) {\n      data.push({ 'x': x, 'y': Math.random() - (x * 0.03) });\n    }\n    args.data = data;\n  }\n\n  function mg_add_missing_background_rect(g, args) {\n    g.append('svg:rect')\n      .classed('mg-missing-background', true)\n      .attr('x', args.buffer)\n      .attr('y', args.buffer + args.title_y_position * 2)\n      .attr('width', args.width - args.buffer * 2)\n      .attr('height', args.height - args.buffer * 2 - args.title_y_position * 2)\n      .attr('rx', 15)\n      .attr('ry', 15);\n  }\n\n  function mg_missing_add_line(g, args) {\n    var line = d3.line()\n      .x(args.scalefns.xf)\n      .y(args.scalefns.yf)\n      .curve(args.interpolate);\n\n    g.append('path')\n      .attr('class', 'mg-main-line mg-line1-color')\n      .attr('d', line(args.data));\n  }\n\n  function mg_missing_add_area(g, args) {\n    var area = d3.area()\n      .x(args.scalefns.xf)\n      .y0(args.scales.Y.range()[0])\n      .y1(args.scalefns.yf)\n      .curve(args.interpolate);\n\n    g.append('path')\n      .attr('class', 'mg-main-area mg-area1-color')\n      .attr('d', area(args.data));\n  }\n\n  function mg_remove_all_children(args) {\n    d3.select(args.target).selectAll('svg *').remove();\n  }\n\n  function mg_missing_remove_legend(args) {\n    if (args.legend_target) {\n      d3.select(args.legend_target).html('');\n    }\n  }\n\n  function missingData(args) {\n    this.init = function(args) {\n      this.args = args;\n\n      mg_init_compute_width(args);\n      mg_init_compute_height(args);\n\n      // create svg if one doesn't exist\n\n      var container = d3.select(args.target);\n      mg_raise_container_error(container, args);\n      var svg = container.selectAll('svg');\n      mg_remove_svg_if_chart_type_has_changed(svg, args);\n      svg = mg_add_svg_if_it_doesnt_exist(svg, args);\n      mg_adjust_width_and_height_if_changed(svg, args);\n      mg_set_viewbox_for_scaling(svg, args);\n      mg_remove_all_children(args);\n\n      svg.classed('mg-missing', true);\n      mg_missing_remove_legend(args);\n\n      chart_title(args);\n\n      // are we adding a background placeholder\n      if (args.show_missing_background) {\n        mg_make_fake_data(args);\n        mg_missing_x_scale(args);\n        mg_missing_y_scale(args);\n        var g = mg_add_g(svg, 'mg-missing-pane');\n\n        mg_add_missing_background_rect(g, args);\n        mg_missing_add_line(g, args);\n        mg_missing_add_area(g, args);\n      }\n\n      mg_missing_add_text(svg, args);\n\n      this.windowListeners();\n\n      return this;\n    };\n\n    this.windowListeners = function() {\n      mg_window_listeners(this.args);\n      return this;\n    };\n\n    this.init(args);\n  }\n\n  var defaults = {\n    top: 40, // the size of the top margin\n    bottom: 30, // the size of the bottom margin\n    right: 10, // size of the right margin\n    left: 0, // size of the left margin\n    buffer: 8, // the buffer between the actual chart area and the margins\n    legend_target: '',\n    width: 350,\n    height: 220,\n    missing_text: 'Data currently missing or unavailable',\n    scalefns: {},\n    scales: {},\n    show_tooltips: true,\n    show_missing_background: true\n  };\n\n  MG.register('missing-data', missingData, defaults);\n}).call(this);\n\nfunction mg_process_scale_ticks(args, axis) {\n  var accessor;\n  var scale_ticks;\n  var max;\n\n  if (axis === 'x') {\n    accessor = args.x_accessor;\n    scale_ticks = args.scales.X.ticks(args.xax_count);\n    max = args.processed.max_x;\n  } else if (axis === 'y') {\n    accessor = args.y_accessor;\n    scale_ticks = args.scales.Y.ticks(args.yax_count)\n    max = args.processed.max_y;\n  }\n\n  function log10(val) {\n    if (val === 1000) {\n      return 3;\n    }\n    if (val === 1000000) {\n      return 7;\n    }\n    return Math.log(val) / Math.LN10;\n  }\n\n  if ((axis === 'x' && args.x_scale_type === 'log') || (axis === 'y' && args.y_scale_type === 'log')) {\n    // get out only whole logs\n    scale_ticks = scale_ticks.filter(function(d) {\n      return Math.abs(log10(d)) % 1 < 1e-6 || Math.abs(log10(d)) % 1 > 1 - 1e-6;\n    });\n  }\n\n  // filter out fraction ticks if our data is ints and if xmax > number of generated ticks\n  var number_of_ticks = scale_ticks.length;\n\n  // is our data object all ints?\n  var data_is_int = true;\n  args.data.forEach(function(d, i) {\n    d.forEach(function(d, i) {\n      if (d[accessor] % 1 !== 0) {\n        data_is_int = false;\n        return false;\n      }\n    });\n  });\n\n  if (data_is_int && number_of_ticks > max && args.format === 'count') {\n    // remove non-integer ticks\n    scale_ticks = scale_ticks.filter(function(d) {\n      return d % 1 === 0;\n    });\n  }\n\n  if (axis === 'x') {\n    args.processed.x_ticks = scale_ticks;\n  } else if (axis === 'y') {\n    args.processed.y_ticks = scale_ticks;\n  }\n}\n\nfunction raw_data_transformation(args) {\n  'use strict';\n\n  // dupe our data so we can modify it without adverse effect\n  args.data = MG.clone(args.data);\n\n  // we need to account for a few data format cases:\n  // #0 {bar1:___, bar2:___}                                    // single object (for, say, bar charts)\n  // #1 [{key:__, value:__}, ...]                               // unnested obj-arrays\n  // #2 [[{key:__, value:__}, ...], [{key:__, value:__}, ...]]  // nested obj-arrays\n  // #3 [[4323, 2343],..]                                       // unnested 2d array\n  // #4 [[[4323, 2343],..] , [[4323, 2343],..]]                 // nested 2d array\n  args.single_object = false; // for bar charts.\n  args.array_of_objects = false;\n  args.array_of_arrays = false;\n  args.nested_array_of_arrays = false;\n  args.nested_array_of_objects = false;\n\n  // is the data object a nested array?\n\n  if (is_array_of_arrays(args.data)) {\n    args.nested_array_of_objects = args.data.map(function(d) {\n      return is_array_of_objects_or_empty(d);\n    }); // Case #2\n    args.nested_array_of_arrays = args.data.map(function(d) {\n      return is_array_of_arrays(d);\n    }); // Case #4\n  } else {\n    args.array_of_objects = is_array_of_objects(args.data); // Case #1\n    args.array_of_arrays = is_array_of_arrays(args.data); // Case #3\n  }\n\n  if (args.chart_type === 'line') {\n    if (args.array_of_objects || args.array_of_arrays) {\n      args.data = [args.data];\n    }\n  } else {\n    if (!(mg_is_array(args.data[0]))) {\n      args.data = [args.data];\n    }\n  }\n  // if the y_accessor is an array, break it up and store the result in args.data\n  mg_process_multiple_x_accessors(args);\n  mg_process_multiple_y_accessors(args);\n\n  // if user supplies keyword in args.color, change to arg.colors.\n  // this is so that the API remains fairly sensible and legible.\n  if (args.color !== undefined) {\n    args.colors = args.color;\n  }\n\n  // if user has supplied args.colors, and that value is a string, turn it into an array.\n  if (args.colors !== null && typeof args.colors === 'string') {\n    args.colors = [args.colors];\n  }\n\n  // sort x-axis data\n  if (args.chart_type === 'line' && args.x_sort === true) {\n    for (var i = 0; i < args.data.length; i++) {\n      args.data[i].sort(function(a, b) {\n        return a[args.x_accessor] - b[args.x_accessor];\n      });\n    }\n  }\n\n  return this;\n}\n\nfunction mg_process_multiple_accessors(args, which_accessor) {\n  // turns an array of accessors into ...\n  if (mg_is_array(args[which_accessor])) {\n    args.data = args.data.map(function(_d) {\n      return args[which_accessor].map(function(ya) {\n        return _d.map(function(di) {\n          di = MG.clone(di);\n\n          if (di[ya] === undefined) {\n            return undefined;\n          }\n\n          di['multiline_' + which_accessor] = di[ya];\n          return di;\n        }).filter(function(di) {\n          return di !== undefined;\n        });\n      });\n    })[0];\n    args[which_accessor] = 'multiline_' + which_accessor;\n  }\n}\n\nfunction mg_process_multiple_x_accessors(args) {\n  mg_process_multiple_accessors(args, 'x_accessor');\n}\n\nfunction mg_process_multiple_y_accessors(args) {\n  mg_process_multiple_accessors(args, 'y_accessor');\n}\n\nMG.raw_data_transformation = raw_data_transformation;\n\nfunction process_line(args) {\n  'use strict';\n\n  var time_frame;\n\n  // do we have a time-series?\n  var is_time_series = d3.sum(args.data.map(function(series) {\n    return series.length > 0 && mg_is_date(series[0][args.x_accessor]);\n  })) > 0;\n\n  // are we replacing missing y values with zeros?\n  if ((args.missing_is_zero || args.missing_is_hidden) && args.chart_type === 'line' && is_time_series) {\n    for (var i = 0; i < args.data.length; i++) {\n      // we need to have a dataset of length > 2, so if it's less than that, skip\n      if (args.data[i].length <= 1) {\n        continue;\n      }\n\n      var first = args.data[i][0];\n      var last = args.data[i][args.data[i].length - 1];\n\n      // initialize our new array for storing the processed data\n      var processed_data = [];\n\n      // we'll be starting from the day after our first date\n      var start_date = MG.clone(first[args.x_accessor]).setDate(first[args.x_accessor].getDate() + 1);\n\n      // if we've set a max_x, add data points up to there\n      var from = (args.min_x) ? args.min_x : start_date;\n      var upto = (args.max_x) ? args.max_x : last[args.x_accessor];\n\n      time_frame = mg_get_time_frame((upto - from) / 1000);\n\n      if (['four-days', 'many-days', 'many-months', 'years', 'default'].indexOf(time_frame) !== -1 && args.missing_is_hidden_accessor === null) {\n        for (var d = new Date(from); d <= upto; d.setDate(d.getDate() + 1)) {\n          var o = {};\n          d.setHours(0, 0, 0, 0);\n\n          // add the first date item, we'll be starting from the day after our first date\n          if (Date.parse(d) === Date.parse(new Date(start_date))) {\n            processed_data.push(MG.clone(args.data[i][0]));\n          }\n\n          // check to see if we already have this date in our data object\n          var existing_o = null;\n          args.data[i].forEach(function(val, i) {\n            if (Date.parse(val[args.x_accessor]) === Date.parse(new Date(d))) {\n              existing_o = val;\n\n              return false;\n            }\n          });\n\n          // if we don't have this date in our data object, add it and set it to zero\n          if (!existing_o) {\n            o[args.x_accessor] = new Date(d);\n            o[args.y_accessor] = 0;\n            o['_missing'] = true; //we want to distinguish between zero-value and missing observations\n            processed_data.push(o);\n          }\n\n          // if the data point has, say, a 'missing' attribute set or if its\n          // y-value is null identify it internally as missing\n          else if (existing_o[args.missing_is_hidden_accessor] || existing_o[args.y_accessor] === null) {\n            existing_o['_missing'] = true;\n            processed_data.push(existing_o);\n          }\n\n          //otherwise, use the existing object for that date\n          else {\n            processed_data.push(existing_o);\n          }\n        }\n      } else {\n        for (var j = 0; j < args.data[i].length; j += 1) {\n          var obj = MG.clone(args.data[i][j]);\n          obj['_missing'] = args.data[i][j][args.missing_is_hidden_accessor];\n          processed_data.push(obj);\n        }\n      }\n\n      // update our date object\n      args.data[i] = processed_data;\n    }\n  }\n\n  return this;\n}\n\nMG.process_line = process_line;\n\nfunction process_histogram(args) {\n  'use strict';\n\n  // if args.binned == false, then we need to bin the data appropriately.\n  // if args.binned == true, then we need to make sure to compute the relevant computed data.\n  // the outcome of either of these should be something in args.computed_data.\n  // the histogram plotting function will be looking there for the data to plot.\n\n  // we need to compute an array of objects.\n  // each object has an x, y, and dx.\n\n  // histogram data is always single dimension\n  var our_data = args.data[0];\n\n  var extracted_data;\n  if (args.binned === false) {\n    // use d3's built-in layout.histogram functionality to compute what you need.\n\n    if (typeof(our_data[0]) === 'object') {\n      // we are dealing with an array of objects. Extract the data value of interest.\n      extracted_data = our_data\n        .map(function(d) {\n          return d[args.x_accessor];\n        });\n    } else if (typeof(our_data[0]) === 'number') {\n      // we are dealing with a simple array of numbers. No extraction needed.\n      extracted_data = our_data;\n    } else {\n      console.log('TypeError: expected an array of numbers, found ' + typeof(our_data[0]));\n      return;\n    }\n\n    var hist = d3.histogram();\n    if (args.bins) {\n      hist.thresholds(args.bins);\n    }\n\n    var bins = hist(extracted_data);\n    args.processed_data = bins.map(function(d) {\n      return { 'x': d.x0, 'y': d.length };\n    });\n  } else {\n    // here, we just need to reconstruct the array of objects\n    // take the x accessor and y accessor.\n    // pull the data as x and y. y is count.\n\n    args.processed_data = our_data.map(function(d) {\n      return { 'x': d[args.x_accessor], 'y': d[args.y_accessor] };\n    });\n\n    var this_pt;\n    var next_pt;\n\n    // we still need to compute the dx component for each data point\n    for (var i = 0; i < args.processed_data.length; i++) {\n      this_pt = args.processed_data[i];\n      if (i === args.processed_data.length - 1) {\n        this_pt.dx = args.processed_data[i - 1].dx;\n      } else {\n        next_pt = args.processed_data[i + 1];\n        this_pt.dx = next_pt.x - this_pt.x;\n      }\n    }\n  }\n\n  // capture the original data and accessors before replacing args.data\n  if (!args.processed) {\n    args.processed = {};\n  }\n  args.processed.original_data = args.data;\n  args.processed.original_x_accessor = args.x_accessor;\n  args.processed.original_y_accessor = args.y_accessor;\n\n  args.data = [args.processed_data];\n  args.x_accessor = args.processed_x_accessor;\n  args.y_accessor = args.processed_y_accessor;\n\n  return this;\n}\n\nMG.process_histogram = process_histogram;\n\n// for use with bar charts, etc.\nfunction process_categorical_variables(args) {\n  'use strict';\n\n  var extracted_data, processed_data = {},\n    pd = [];\n  //var our_data = args.data[0];\n  var label_accessor = args.bar_orientation === 'vertical' ? args.x_accessor : args.y_accessor;\n  var data_accessor = args.bar_orientation === 'vertical' ? args.y_accessor : args.x_accessor;\n\n  return this;\n}\n\nMG.process_categorical_variables = process_categorical_variables;\n\nfunction process_point(args) {\n  'use strict';\n\n  var data = args.data[0];\n  var x = data.map(function(d) {\n    return d[args.x_accessor];\n  });\n  var y = data.map(function(d) {\n    return d[args.y_accessor];\n  });\n\n  if (args.least_squares) {\n    args.ls_line = least_squares(x, y);\n  }\n\n  return this;\n}\n\nMG.process_point = process_point;\n\nfunction add_ls(args) {\n  var svg = mg_get_svg_child_of(args.target);\n  var data = args.data[0];\n  var min_x = d3.min(data, function(d) {\n    return d[args.x_accessor]; });\n  var max_x = d3.max(data, function(d) {\n    return d[args.x_accessor]; });\n\n  d3.select(args.target).selectAll('.mg-least-squares-line').remove();\n\n  svg.append('svg:line')\n    .attr('x1', args.scales.X(min_x))\n    .attr('x2', args.scales.X(max_x))\n    .attr('y1', args.scales.Y(args.ls_line.fit(min_x)))\n    .attr('y2', args.scales.Y(args.ls_line.fit(max_x)))\n    .attr('class', 'mg-least-squares-line');\n}\n\nMG.add_ls = add_ls;\n\nfunction add_lowess(args) {\n  var svg = mg_get_svg_child_of(args.target);\n  var lowess = args.lowess_line;\n\n  var line = d3.svg.line()\n    .x(function(d) {\n      return args.scales.X(d.x); })\n    .y(function(d) {\n      return args.scales.Y(d.y); })\n    .interpolate(args.interpolate);\n\n  svg.append('path')\n    .attr('d', line(lowess))\n    .attr('class', 'mg-lowess-line');\n}\n\nMG.add_lowess = add_lowess;\n\nfunction lowess_robust(x, y, alpha, inc) {\n  // Used http://www.unc.edu/courses/2007spring/biol/145/001/docs/lectures/Oct27.html\n  // for the clear explanation of robust lowess.\n\n  // calculate the the first pass.\n  var _l;\n  var r = [];\n  var yhat = d3.mean(y);\n  var i;\n  for (i = 0; i < x.length; i += 1) { r.push(1); }\n  _l = _calculate_lowess_fit(x, y, alpha, inc, r);\n  var x_proto = _l.x;\n  var y_proto = _l.y;\n\n  // Now, take the fit, recalculate the weights, and re-run LOWESS using r*w instead of w.\n\n  for (i = 0; i < 100; i += 1) {\n    r = d3.zip(y_proto, y).map(function(yi) {\n      return Math.abs(yi[1] - yi[0]);\n    });\n\n    var q = d3.quantile(r.sort(), 0.5);\n\n    r = r.map(function(ri) {\n      return _bisquare_weight(ri / (6 * q));\n    });\n\n    _l = _calculate_lowess_fit(x, y, alpha, inc, r);\n    x_proto = _l.x;\n    y_proto = _l.y;\n  }\n\n  return d3.zip(x_proto, y_proto).map(function(d) {\n    var p = {};\n    p.x = d[0];\n    p.y = d[1];\n    return p;\n  });\n}\n\nMG.lowess_robust = lowess_robust;\n\nfunction lowess(x, y, alpha, inc) {\n  var r = [];\n  for (var i = 0; i < x.length; i += 1) { r.push(1); }\n  var _l = _calculate_lowess_fit(x, y, alpha, inc, r);\n}\n\nMG.lowess = lowess;\n\nfunction least_squares(x_, y_) {\n  var x, y, xi, yi,\n    _x = 0,\n    _y = 0,\n    _xy = 0,\n    _xx = 0;\n\n  var n = x_.length;\n  if (mg_is_date(x_[0])) {\n    x = x_.map(function(d) {\n      return d.getTime();\n    });\n  } else {\n    x = x_;\n  }\n\n  if (mg_is_date(y_[0])) {\n    y = y_.map(function(d) {\n      return d.getTime();\n    });\n  } else {\n    y = y_;\n  }\n\n  var xhat = d3.mean(x);\n  var yhat = d3.mean(y);\n  var numerator = 0,\n    denominator = 0;\n\n  for (var i = 0; i < x.length; i++) {\n    xi = x[i];\n    yi = y[i];\n    numerator += (xi - xhat) * (yi - yhat);\n    denominator += (xi - xhat) * (xi - xhat);\n  }\n\n  var beta = numerator / denominator;\n  var x0 = yhat - beta * xhat;\n\n  return {\n    x0: x0,\n    beta: beta,\n    fit: function(x) {\n      return x0 + x * beta;\n    }\n  };\n}\n\nMG.least_squares = least_squares;\n\nfunction _pow_weight(u, w) {\n  if (u >= 0 && u <= 1) {\n    return Math.pow(1 - Math.pow(u, w), w);\n  } else {\n    return 0;\n  }\n}\n\nfunction _bisquare_weight(u) {\n  return _pow_weight(u, 2);\n}\n\nfunction _tricube_weight(u) {\n  return _pow_weight(u, 3);\n}\n\nfunction _neighborhood_width(x0, xis) {\n  return Array.max(xis.map(function(xi) {\n    return Math.abs(x0 - xi);\n  }));\n}\n\nfunction _manhattan(x1, x2) {\n  return Math.abs(x1 - x2);\n}\n\nfunction _weighted_means(wxy) {\n  var wsum = d3.sum(wxy.map(function(wxyi) {\n    return wxyi.w; }));\n\n  return {\n    xbar: d3.sum(wxy.map(function(wxyi) {\n      return wxyi.w * wxyi.x;\n    })) / wsum,\n    ybar: d3.sum(wxy.map(function(wxyi) {\n      return wxyi.w * wxyi.y;\n    })) / wsum\n  };\n}\n\nfunction _weighted_beta(wxy, xbar, ybar) {\n  var num = d3.sum(wxy.map(function(wxyi) {\n    return Math.pow(wxyi.w, 2) * (wxyi.x - xbar) * (wxyi.y - ybar);\n  }));\n\n  var denom = d3.sum(wxy.map(function(wxyi) {\n    return Math.pow(wxyi.w, 2) * Math.pow(wxyi.x - xbar, 2);\n  }));\n\n  return num / denom;\n}\n\nfunction _weighted_least_squares(wxy) {\n  var ybar, xbar, beta_i, x0;\n\n  var _wm = _weighted_means(wxy);\n\n  xbar = _wm.xbar;\n  ybar = _wm.ybar;\n\n  var beta = _weighted_beta(wxy, xbar, ybar);\n\n  return {\n    beta: beta,\n    xbar: xbar,\n    ybar: ybar,\n    x0: ybar - beta * xbar\n\n  };\n}\n\nfunction _calculate_lowess_fit(x, y, alpha, inc, residuals) {\n  // alpha - smoothing factor. 0 < alpha < 1/\n  //\n  //\n  var k = Math.floor(x.length * alpha);\n\n  var sorted_x = x.slice();\n\n  sorted_x.sort(function(a, b) {\n    if (a < b) {\n      return -1; } else if (a > b) {\n      return 1; }\n\n    return 0;\n  });\n\n  var x_max = d3.quantile(sorted_x, 0.98);\n  var x_min = d3.quantile(sorted_x, 0.02);\n\n  var xy = d3.zip(x, y, residuals).sort();\n\n  var size = Math.abs(x_max - x_min) / inc;\n\n  var smallest = x_min;\n  var largest = x_max;\n  var x_proto = d3.range(smallest, largest, size);\n\n  var xi_neighbors;\n  var x_i, beta_i, x0_i, delta_i, xbar, ybar;\n\n  // for each prototype, find its fit.\n  var y_proto = [];\n\n  for (var i = 0; i < x_proto.length; i += 1) {\n    x_i = x_proto[i];\n\n    // get k closest neighbors.\n    xi_neighbors = xy.map(function(xyi) {\n      return [\n        Math.abs(xyi[0] - x_i),\n        xyi[0],\n        xyi[1],\n        xyi[2]\n      ];\n    }).sort().slice(0, k);\n\n    // Get the largest distance in the neighbor set.\n    delta_i = d3.max(xi_neighbors)[0];\n\n    // Prepare the weights for mean calculation and WLS.\n\n    xi_neighbors = xi_neighbors.map(function(wxy) {\n      return {\n        w: _tricube_weight(wxy[0] / delta_i) * wxy[3],\n        x: wxy[1],\n        y: wxy[2]\n      };\n    });\n\n    // Find the weighted least squares, obviously.\n    var _output = _weighted_least_squares(xi_neighbors);\n\n    x0_i = _output.x0;\n    beta_i = _output.beta;\n\n    //\n    y_proto.push(x0_i + beta_i * x_i);\n  }\n\n  return { x: x_proto, y: y_proto };\n}\n\nfunction format_rollover_number(args) {\n  var num;\n  if (args.format === 'count') {\n    num = function(d) {\n      var is_float = d % 1 !== 0;\n      var pf;\n\n      if (is_float) {\n        pf = d3.format(',.' + args.decimals + 'f');\n      } else {\n        pf = d3.format(',.0f');\n      }\n\n      // are we adding units after the value or before?\n      if (args.yax_units_append) {\n        return pf(d) + args.yax_units;\n      } else {\n        return args.yax_units + pf(d);\n      }\n    };\n  } else {\n    num = function(d_) {\n      var fmt_string = (args.decimals ? '.' + args.decimals : '') + '%';\n      var pf = d3.format(fmt_string);\n      return pf(d_);\n    };\n  }\n  return num;\n}\n\nvar time_rollover_format = function(f, d, accessor, utc) {\n  var fd;\n  if (typeof f === 'string') {\n    fd = MG.time_format(utc, f)(d[accessor]);\n  } else if (typeof f === 'function') {\n    fd = f(d);\n  } else {\n    fd = d[accessor];\n  }\n  return fd;\n}\n\n// define our rollover format for numbers\nvar number_rollover_format = function(f, d, accessor) {\n  var fd;\n  if (typeof f === 'string') {\n    fd = d3.format('s')(d[accessor]);\n  } else if (typeof f === 'function') {\n    fd = f(d);\n  } else {\n    fd = d[accessor];\n  }\n  return fd;\n}\n\nfunction mg_format_y_rollover(args, num, d) {\n  var formatted_y;\n  if (args.y_mouseover !== null) {\n    if (args.aggregate_rollover) {\n      formatted_y = number_rollover_format(args.y_mouseover, d, args.y_accessor);\n    } else {\n      formatted_y = number_rollover_format(args.y_mouseover, d, args.y_accessor);\n    }\n  } else {\n    if (args.time_series) {\n      if (args.aggregate_rollover) {\n        formatted_y = num(d[args.y_accessor]);\n      } else {\n        formatted_y = args.yax_units + num(d[args.y_accessor]);\n      }\n    } else {\n      formatted_y = args.y_accessor + ': ' + args.yax_units + num(d[args.y_accessor]);\n    }\n  }\n  return formatted_y;\n}\n\nfunction mg_format_x_rollover(args, fmt, d) {\n  var formatted_x;\n  if (args.x_mouseover !== null) {\n    if (args.time_series) {\n      if (args.aggregate_rollover) {\n        formatted_x = time_rollover_format(args.x_mouseover, d, 'key', args.utc);\n      } else {\n        formatted_x = time_rollover_format(args.x_mouseover, d, args.x_accessor, args.utc);\n      }\n    } else {\n      formatted_x = number_rollover_format(args.x_mouseover, d, args.x_accessor);\n    }\n  } else {\n    if (args.time_series) {\n      var date;\n\n      if (args.aggregate_rollover && args.data.length > 1) {\n        date = new Date(d.key);\n      } else {\n        date = new Date(+d[args.x_accessor]);\n        date.setDate(date.getDate());\n      }\n\n      formatted_x = fmt(date) + '  ';\n    } else {\n      formatted_x = args.x_accessor + ': ' + d[args.x_accessor] + '   ';\n    }\n  }\n  return formatted_x;\n}\n\nfunction mg_format_data_for_mouseover(args, d, mouseover_fcn, accessor, check_time) {\n  var formatted_data, formatter;\n  var time_fmt = mg_get_rollover_time_format(args);\n  if (typeof d[accessor] === 'string') {\n    formatter = function(d) {\n      return d;\n    }\n  } else {\n    formatter = format_rollover_number(args);\n  }\n\n  if (mouseover_fcn !== null) {\n    if (check_time) formatted_data = time_rollover_format(mouseover_fcn, d, accessor, args.utc);\n    else formatted_data = number_rollover_format(mouseover_fcn, d, accessor);\n\n  } else {\n    if (check_time) formatted_data = time_fmt(new Date(+d[accessor])) + '  ';\n    else formatted_data = (args.time_series ? '' : accessor + ': ') + formatter(d[accessor]) + '   ';\n  }\n  return formatted_data;\n}\n\nfunction mg_format_number_mouseover(args, d) {\n  return mg_format_data_for_mouseover(args, d, args.x_mouseover, args.x_accessor, false);\n}\n\nfunction mg_format_x_mouseover(args, d) {\n  return mg_format_data_for_mouseover(args, d, args.x_mouseover, args.x_accessor, args.time_series);\n}\n\nfunction mg_format_y_mouseover(args, d) {\n  return mg_format_data_for_mouseover(args, d, args.y_mouseover, args.y_accessor, false);\n}\n\nfunction mg_format_x_aggregate_mouseover(args, d) {\n  return mg_format_data_for_mouseover(args, d, args.x_mouseover, 'key', args.time_series)\n}\n\nMG.format_rollover_number = format_rollover_number;\n\n// http://bl.ocks.org/mbostock/3916621\nfunction path_tween(d1, precision) {\n  return function() {\n    var path0 = this,\n      path1 = path0.cloneNode(),\n      n0 = path0.getTotalLength() || 0,\n      n1 = (path1.setAttribute(\"d\", d1), path1).getTotalLength() || 0;\n\n    // Uniform sampling of distance based on specified precision.\n    var distances = [0],\n      i = 0,\n      dt = precision / Math.max(n0, n1);\n    while ((i += dt) < 1) distances.push(i);\n    distances.push(1);\n\n    // Compute point-interpolators at each distance.\n    var points = distances.map(function(t) {\n      var p0 = path0.getPointAtLength(t * n0),\n        p1 = path1.getPointAtLength(t * n1);\n      return d3.interpolate([p0.x, p0.y], [p1.x, p1.y]);\n    });\n\n    return function(t) {\n      return t < 1 ? \"M\" + points.map(function(p) {\n        return p(t);\n      }).join(\"L\") : d1;\n    };\n  };\n}\n\nMG.path_tween = path_tween;\n\n// influenced by https://bl.ocks.org/tomgp/c99a699587b5c5465228\n\nfunction render_markup_for_server(callback) {\n  var virtual_window = MG.virtual_window;\n  var virtual_d3 = d3.select(virtual_window.document);\n  var target = virtual_window.document.createElement('div');\n\n  var original_d3 = global.d3;\n  var original_window = global.window;\n  var original_document = global.document;\n  global.d3 = virtual_d3;\n  global.window = virtual_window;\n  global.document = virtual_window.document;\n\n  var error;\n  try {\n    callback(target);\n  } catch(e) {\n    error = e;\n  }\n\n  global.d3 = original_d3;\n  global.window = original_window;\n  global.document = original_document;\n\n  if (error) {\n    throw error;\n  }\n\n  /* for some reason d3.select parses jsdom elements incorrectly\n   * but it works if we wrap the element in a function.\n   */\n  return virtual_d3.select(function targetFn() {\n    return target;\n  }).html();\n}\n\nfunction render_markup_for_client(callback) {\n  var target = document.createElement('div');\n  callback(target);\n  return d3.select(target).html();\n}\n\nfunction render_markup(callback) {\n  switch(typeof window) {\n    case 'undefined':\n      return render_markup_for_server(callback);\n    default:\n      return render_markup_for_client(callback);\n  }\n}\n\nfunction init_virtual_window(jsdom, force) {\n  if (MG.virtual_window && !force) {\n    return;\n  }\n\n  var doc = jsdom.jsdom({\n    html: '',\n    features: { QuerySelector: true }\n  });\n  MG.virtual_window = doc.defaultView;\n}\n\nMG.render_markup = render_markup;\nMG.init_virtual_window = init_virtual_window;\n\n// call this to add a warning icon to a graph and log an error to the console\nfunction error(args) {\n  console.error('ERROR : ', args.target, ' : ', args.error);\n\n  d3.select(args.target).select('.mg-chart-title')\n    .append('tspan')\n      .attr('class', 'fa fa-x fa-exclamation-circle mg-warning')\n      .attr('dx', '0.3em')\n      .text('\\uf06a');\n}\n\nfunction internal_error(args) {\n  console.error('INTERNAL ERROR : ', args.target, ' : ', args.internal_error);\n}\n\nMG.error = error;\n\nreturn MG;\n}));\n","'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _computedStyles = require('computed-styles');\n\nvar _computedStyles2 = _interopRequireDefault(_computedStyles);\n\nvar _fileSaver = require('file-saver');\n\nvar _fileSaver2 = _interopRequireDefault(_fileSaver);\n\nvar svgStyles = { // Whitelist of CSS styles and default values\n  'alignment-baseline': 'auto',\n  'baseline-shift': 'baseline',\n  'clip': 'auto',\n  'clip-path': 'none',\n  'clip-rule': 'nonzero',\n  'color': 'rgb(51, 51, 51)',\n  'color-interpolation': 'srgb',\n  'color-interpolation-filters': 'linearrgb',\n  'color-profile': 'auto',\n  'color-rendering': 'auto',\n  'cursor': 'auto',\n  'direction': 'ltr',\n  'display': 'inline',\n  'dominant-baseline': 'auto',\n  'enable-background': '',\n  'fill': 'rgb(0, 0, 0)',\n  'fill-opacity': '1',\n  'fill-rule': 'nonzero',\n  'filter': 'none',\n  'flood-color': 'rgb(0, 0, 0)',\n  'flood-opacity': '1',\n  'font': '',\n  'font-family': 'normal',\n  'font-size': 'medium',\n  'font-size-adjust': 'auto',\n  'font-stretch': 'normal',\n  'font-style': 'normal',\n  'font-variant': 'normal',\n  'font-weight': '400',\n  'glyph-orientation-horizontal': '0deg',\n  'glyph-orientation-vertical': 'auto',\n  'image-rendering': 'auto',\n  'kerning': 'auto',\n  'letter-spacing': '0',\n  'lighting-color': 'rgb(255, 255, 255)',\n  'marker': '',\n  'marker-end': 'none',\n  'marker-mid': 'none',\n  'marker-start': 'none',\n  'mask': 'none',\n  'opacity': '1',\n  'overflow': 'visible',\n  'paint-order': 'fill',\n  'pointer-events': 'auto',\n  'shape-rendering': 'auto',\n  'stop-color': 'rgb(0, 0, 0)',\n  'stop-opacity': '1',\n  'stroke': 'none',\n  'stroke-dasharray': 'none',\n  'stroke-dashoffset': '0',\n  'stroke-linecap': 'butt',\n  'stroke-linejoin': 'miter',\n  'stroke-miterlimit': '4',\n  'stroke-opacity': '1',\n  'stroke-width': '1',\n  'text-anchor': 'start',\n  'text-decoration': 'none',\n  'text-rendering': 'auto',\n  'unicode-bidi': 'normal',\n  'visibility': 'visible',\n  'word-spacing': '0px',\n  'writing-mode': 'lr-tb'\n};\n\nvar svgAttrs = [// white list of attributes\n'id', 'xml: base', 'xml: lang', 'xml: space', // Core\n'height', 'result', 'width', 'x', 'y', // Primitive\n'xlink: href', // Xlink attribute\n'href', 'style', 'class', 'd', 'pathLength', // Path\n'x', 'y', 'dx', 'dy', 'glyphRef', 'format', 'x1', 'y1', 'x2', 'y2', 'rotate', 'textLength', 'cx', 'cy', 'r', 'rx', 'ry', 'fx', 'fy', 'width', 'height', 'refX', 'refY', 'orient', 'markerUnits', 'markerWidth', 'markerHeight', 'maskUnits', 'transform', 'viewBox', 'version', // Container\n'preserveAspectRatio', 'xmlns', 'points', // Polygons\n'offset', 'xlink:href'];\n\n// http://www.w3.org/TR/SVG/propidx.html\n// via https://github.com/svg/svgo/blob/master/plugins/_collections.js\nvar inheritableAttrs = ['clip-rule', 'color', 'color-interpolation', 'color-interpolation-filters', 'color-profile', 'color-rendering', 'cursor', 'direction', 'fill', 'fill-opacity', 'fill-rule', 'font', 'font-family', 'font-size', 'font-size-adjust', 'font-stretch', 'font-style', 'font-variant', 'font-weight', 'glyph-orientation-horizontal', 'glyph-orientation-vertical', 'image-rendering', 'kerning', 'letter-spacing', 'marker', 'marker-end', 'marker-mid', 'marker-start', 'pointer-events', 'shape-rendering', 'stroke', 'stroke-dasharray', 'stroke-dashoffset', 'stroke-linecap', 'stroke-linejoin', 'stroke-miterlimit', 'stroke-opacity', 'stroke-width', 'text-anchor', 'text-rendering', 'transform', 'visibility', 'white-space', 'word-spacing', 'writing-mode'];\n\n/* Some simple utilities */\n\nvar isFunction = function isFunction(a) {\n  return typeof a === 'function';\n};\nvar isDefined = function isDefined(a) {\n  return typeof a !== 'undefined';\n};\nvar isUndefined = function isUndefined(a) {\n  return typeof a === 'undefined';\n};\nvar isObject = function isObject(a) {\n  return a !== null && typeof a === 'object';\n};\n\n// from https://github.com/npm-dom/is-dom/blob/master/index.js\nfunction isNode(val) {\n  if (!isObject(val)) {\n    return false;\n  }\n  if (isDefined(window) && isObject(window.Node)) {\n    return val instanceof window.Node;\n  }\n  return typeof val.nodeType === 'number' && typeof val.nodeName === 'string';\n}\n\n/* Some utilities for cloning SVGs with inline styles */\n// Removes attributes that are not valid for SVGs\nfunction cleanAttrs(el, attrs, styles) {\n  // attrs === false - remove all, attrs === true - allow all\n  if (attrs === true) {\n    return;\n  }\n\n  Array.prototype.slice.call(el.attributes).forEach(function (attr) {\n    // remove if it is not style nor on attrs  whitelist\n    // keeping attributes that are also styles because attributes override\n    if (attr.specified) {\n      if (attrs === '' || attrs === false || isUndefined(styles[attr.name]) && attrs.indexOf(attr.name) < 0) {\n        el.removeAttribute(attr.name);\n      }\n    }\n  });\n}\n\nfunction cleanStyle(tgt, parentStyles) {\n  parentStyles = parentStyles || tgt.parentNode.style;\n  inheritableAttrs.forEach(function (key) {\n    if (tgt.style[key] === parentStyles[key]) {\n      tgt.style.removeProperty(key);\n    }\n  });\n}\n\nfunction domWalk(src, tgt, down, up) {\n  down(src, tgt);\n  var children = src.childNodes;\n  for (var i = 0; i < children.length; i++) {\n    domWalk(children[i], tgt.childNodes[i], down, up);\n  }\n  up(src, tgt);\n}\n\n// Clones an SVGElement, copies approprate atttributes and styles.\nfunction cloneSvg(src, attrs, styles) {\n  var clonedSvg = src.cloneNode(true);\n\n  domWalk(src, clonedSvg, function (src, tgt) {\n    if (tgt.style) {\n      (0, _computedStyles2['default'])(src, tgt.style, styles);\n    }\n  }, function (src, tgt) {\n    if (tgt.style && tgt.parentNode) {\n      cleanStyle(tgt);\n    }\n    if (tgt.attributes) {\n      cleanAttrs(tgt, attrs, styles);\n    }\n  });\n\n  return clonedSvg;\n}\n\n/* global Image, MouseEvent */\n\n/* Some simple utilities for saving SVGs, including an alternative to saveAs */\n\n// detection\nvar DownloadAttributeSupport = typeof document !== 'undefined' && 'download' in document.createElement('a') && typeof MouseEvent === 'function';\n\nfunction saveUri(uri, name) {\n  if (DownloadAttributeSupport) {\n    var dl = document.createElement('a');\n    dl.setAttribute('href', uri);\n    dl.setAttribute('download', name);\n    // firefox doesn't support `.click()`...\n    // from https://github.com/sindresorhus/multi-download/blob/gh-pages/index.js\n    dl.dispatchEvent(new MouseEvent('click'));\n    return true;\n  } else if (typeof window !== 'undefined') {\n    window.open(uri, '_blank', '');\n    return true;\n  }\n\n  return false;\n}\n\nfunction createCanvas(uri, name, cb) {\n  var canvas = document.createElement('canvas');\n  var context = canvas.getContext('2d');\n\n  var image = new Image();\n  image.onload = function () {\n    canvas.width = image.width;\n    canvas.height = image.height;\n    context.drawImage(image, 0, 0);\n\n    cb(canvas);\n  };\n  image.src = uri;\n  return true;\n}\n\nfunction savePng(uri, name) {\n  return createCanvas(uri, name, function (canvas) {\n    if (isDefined(canvas.toBlob)) {\n      canvas.toBlob(function (blob) {\n        _fileSaver2['default'].saveAs(blob, name);\n      });\n    } else {\n      saveUri(canvas.toDataURL('image/png'), name);\n    }\n  });\n}\n\n/* global Blob */\n\nvar isIE11 = !!window.MSInputMethodContext && !!document.documentMode;\n\n// inheritable styles may be overridden by parent, always copy for now\ninheritableAttrs.forEach(function (k) {\n  if (k in svgStyles) {\n    svgStyles[k] = true;\n  }\n});\n\nvar SvgSaver = (function () {\n  _createClass(SvgSaver, null, [{\n    key: 'getSvg',\n    value: function getSvg(el) {\n      if (isUndefined(el) || el === '') {\n        el = document.body.querySelector('svg');\n      } else if (typeof el === 'string') {\n        el = document.body.querySelector(el);\n      }\n      if (el && el.tagName !== 'svg') {\n        el = el.querySelector('svg');\n      }\n      if (!isNode(el)) {\n        throw new Error('svgsaver: Can\\'t find an svg element');\n      }\n      return el;\n    }\n  }, {\n    key: 'getFilename',\n    value: function getFilename(el, filename, ext) {\n      if (!filename || filename === '') {\n        filename = (el.getAttribute('title') || 'untitled') + '.' + ext;\n      }\n      return encodeURI(filename);\n    }\n\n    /**\n    * SvgSaver constructor.\n    * @constructs SvgSaver\n    * @api public\n    *\n    * @example\n    * var svgsaver = new SvgSaver();                      // creates a new instance\n    * var svg = document.querySelector('#mysvg');         // find the SVG element\n    * svgsaver.asSvg(svg);                                // save as SVG\n    */\n  }]);\n\n  function SvgSaver() {\n    var _ref = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n    var attrs = _ref.attrs;\n    var styles = _ref.styles;\n\n    _classCallCheck(this, SvgSaver);\n\n    this.attrs = attrs === undefined ? svgAttrs : attrs;\n    this.styles = styles === undefined ? svgStyles : styles;\n  }\n\n  /**\n  * Return the cloned SVG after cleaning\n  *\n  * @param {SVGElement} el The element to copy.\n  * @returns {SVGElement} SVG text after cleaning\n  * @api public\n  */\n\n  _createClass(SvgSaver, [{\n    key: 'cloneSVG',\n    value: function cloneSVG(el) {\n      el = SvgSaver.getSvg(el);\n      var svg = cloneSvg(el, this.attrs, this.styles);\n\n      svg.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n      svg.setAttribute('xmlns:xlink', 'http://www.w3.org/1999/xlink');\n      svg.setAttribute('version', 1.1);\n\n      // height and width needed to download in FireFox\n      svg.setAttribute('width', svg.getAttribute('width') || '500');\n      svg.setAttribute('height', svg.getAttribute('height') || '900');\n\n      return svg;\n    }\n\n    /**\n    * Return the SVG HTML text after cleaning\n    *\n    * @param {SVGElement} el The element to copy.\n    * @returns {String} SVG text after cleaning\n    * @api public\n    */\n  }, {\n    key: 'getHTML',\n    value: function getHTML(el) {\n      var svg = this.cloneSVG(el);\n\n      var html = svg.outerHTML;\n      if (html) {\n        return html;\n      }\n\n      // see http://stackoverflow.com/questions/19610089/unwanted-namespaces-on-svg-markup-when-using-xmlserializer-in-javascript-with-ie\n      svg.removeAttribute('xmlns');\n      svg.removeAttribute('xmlns:xlink');\n\n      svg.setAttributeNS('http://www.w3.org/2000/xmlns/', 'xmlns', 'http://www.w3.org/2000/svg');\n      svg.setAttributeNS('http://www.w3.org/2000/xmlns/', 'xmlns:xlink', 'http://www.w3.org/1999/xlink');\n\n      return new window.XMLSerializer().serializeToString(svg);\n    }\n\n    /**\n    * Return the SVG, after cleaning, as a text/xml Blob\n    *\n    * @param {SVGElement} el The element to copy.\n    * @returns {Blog} SVG as a text/xml Blob\n    * @api public\n    */\n  }, {\n    key: 'getBlob',\n    value: function getBlob(el) {\n      var html = this.getHTML(el);\n      return new Blob([html], { type: 'text/xml' });\n    }\n\n    /**\n    * Return the SVG, after cleaning, as a image/svg+xml;base64 URI encoded string\n    *\n    * @param {SVGElement} el The element to copy.\n    * @returns {String} SVG as image/svg+xml;base64 URI encoded string\n    * @api public\n    */\n  }, {\n    key: 'getUri',\n    value: function getUri(el) {\n      var html = encodeURIComponent(this.getHTML(el));\n      if (isDefined(window.btoa)) {\n        // see http://stackoverflow.com/questions/23223718/failed-to-execute-btoa-on-window-the-string-to-be-encoded-contains-characte\n        return 'data:image/svg+xml;base64,' + window.btoa(unescape(html));\n      }\n      return 'data:image/svg+xml,' + html;\n    }\n\n    /**\n    * Saves the SVG as a SVG file using method compatible with the browser\n    *\n    * @param {SVGElement} el The element to copy.\n    * @param {string} [filename] The filename to save, defaults to the SVG title or 'untitled.svg'\n    * @returns {SvgSaver} The SvgSaver instance\n    * @api public\n    */\n  }, {\n    key: 'asSvg',\n    value: function asSvg(el, filename) {\n      el = SvgSaver.getSvg(el);\n      filename = SvgSaver.getFilename(el, filename, 'svg');\n      if (isFunction(Blob)) {\n        return _fileSaver2['default'].saveAs(this.getBlob(el), filename);\n      }\n      return saveUri(this.getUri(el), filename);\n    }\n\n    /**\n    * Gets the SVG as a PNG data URI.\n    *\n    * @param {SVGElement} el The element to copy.\n    * @param {Function} cb Call back called with the PNG data uri.\n    * @api public\n    */\n  }, {\n    key: 'getPngUri',\n    value: function getPngUri(el, cb) {\n      if (isIE11) {\n        console.error('svgsaver: getPngUri not supported on IE11');\n      }\n      el = SvgSaver.getSvg(el);\n      var filename = SvgSaver.getFilename(el, null, 'png');\n      return createCanvas(this.getUri(el), filename, function (canvas) {\n        cb(canvas.toDataURL('image/png'));\n      });\n    }\n\n    /**\n    * Saves the SVG as a PNG file using method compatible with the browser\n    *\n    * @param {SVGElement} el The element to copy.\n    * @param {string} [filename] The filename to save, defaults to the SVG title or 'untitled.png'\n    * @returns {SvgSaver} The SvgSaver instance\n    * @api public\n    */\n  }, {\n    key: 'asPng',\n    value: function asPng(el, filename) {\n      if (isIE11) {\n        console.error('svgsaver: asPng not supported on IE11');\n      }\n      el = SvgSaver.getSvg(el);\n      filename = SvgSaver.getFilename(el, filename, 'png');\n      return savePng(this.getUri(el), filename);\n    }\n  }]);\n\n  return SvgSaver;\n})();\n\nexports['default'] = SvgSaver;\nmodule.exports = exports['default'];\n"]}