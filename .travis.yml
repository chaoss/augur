os: linux
dist: xenial
language: python
services:
  - docker

jobs:
  include:
    - name: Py3.6 Application Unit Tests
      python: 3.6
      env: TOXENV=py36-application

    - name: Py3.6 Metrics Routes Tests
      python: 3.6
      env: TOXENV=py36-metric-routes

    - name: Py3.7 Application Unit Tests
      python: 3.7
      env: TOXENV=py37-application

    - name: Py3.7 Metrics Routes Tests
      python: 3.7
      env: TOXENV=py37-metric-routes

    - name: Py3.8 Application Unit Tests
      python: 3.8
      env: TOXENV=py38-application

    - name: Py3.8 Metrics Routes Tests
      python: 3.8
      env: TOXENV=py38-metric-routes

env:
  global:
    AUGUR_DB_HOST=localhost
    AUGUR_DB_NAME=test_data
    AUGUR_DB_PORT=5432
    AUGUR_DB_USER=augur
    AUGUR_DB_PASSWORD=augur

before_install:
  - docker run -d -p 5432:5432 --name augur_test_database augurlabs/augur:test_data@sha256:3c496445d7219b824315a37369fcddbe83b10773259560df5645162ce81dfb33

install:
  - pip install .[dev]
  - augur configure generate

script:
  - tox
